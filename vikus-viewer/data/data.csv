keywords,year,id,_title,_authors,_abstract,_origin_path,_display_path_to_pdf,_path_to_pdf,_fulltext
None,2021,0000,Distance Polymatrix Coordination Games,"Alessandro Aloisio, Michele Flammini, Bojana Kodric, Cosimo Vinci",abstract comes here,https://www.ijcai.org/proceedings/2021/0001.pdf,data/fulltext/pdf/2021/0000.pdf,../vikus-viewer/data/fulltext/pdf/2021/0000.pdf,"distance polymatrix coordination games
alessandro aloisio1 2   michele flammini1   bojana kodric1 and cosimo vinci1
1gran sasso science institute  l aquila  italy
2university of l aquila  italy
 alessandro aloisio  michele flammini  bojana kodric  cosimo vinci @gssi it
abstract
in polymatrix coordination games  each player x is
a node of a graph and must select an action in her
strategy set  nodes are playing separate bimatrix
games with their neighbors in the graph  namely 
the utility of x is given by the preference she has for
her action plus  for each neighbor y  a payoff which
strictly depends on the mutual actions played by x
and y 
we propose the new class of distance polymatrix
coordination games  properly generalizing polyma-
trix coordination games  in which the overall utility
of player x further depends on the payoffs arising
from mutual actions of players v  z that are the end-
points of edges at any distance h < d from x  for a
fixed threshold value d ≤ n  in particular  the over-
all utility of player x is the sum of all the above
payoffs  where each payoff is proportionally dis-
counted by a factor depending on the distance h of
the corresponding edge 
under the above framework  which is a natural gen-
eralization that is well-suited for capturing positive
community interactions  we study the social ineffi-
ciency of equilibria resorting to standard measures
of price of anarchy and price of stability  namely 
we provide suitable upper and lower bounds for
the aforementioned quantities  both for bounded-
degree and general graphs 
1
introduction
polymatrix games  yanovskaya  1968  are a well-known uni-
versal framework for modeling multi-agent games  which
takes into account only pairwise interactions and thus allows
a succinct representation  despite the constraint of consid-
ering only pairwise interactions  its formulation is general
enough to capture a number of settings  both of theoretical
and practical interest  in polymatrix games each player plays
a separate bimatrix game with every other player  in the re-
stricted version named polymatrix coordination games  rahn
and sch¨afer  2015   an outcome of a bimatrix game gives the
same payoff w x y  σx  σy  to the two players x and y in-
volved in it  moreover  every player gets also an additional
payoff px σx  that only depends on the strategy she chooses 
in this paper  we generalize polymatrix coordination
games  by allowing players to receive further payoff from the
interactions they are not personally involved in  the idea
here is that each player benefits not only from good rela-
tions with her immediate neighbors  but also from the pos-
itive environment stemming from good relations between her
immediate neighbors and their respective immediate neigh-
bors  a further generalization of this thought brings us to
a model in which the utility is computed as the sum of the
payoffs from the whole connected component of the inter-
action graph  up to a certain maximal distance d  where d
is a parameter of the model  furthermore  it seems reason-
able to discount the amount of payoff received from non-
neighboring edges by a factor between zero and one  and to
make such factors decrease with the distance of the corre-
sponding edge/interaction  in other words  an agent x gets
also the payoff αh 1 · w v z  σv  σz  for every edge  v  z 
at distance h < d from x  where αh 1 is the relative dis-
count factor  we call the arising model  that generalizes poly-
matrix coordination games  distance polymatrix coordination
games 
distance polymatrix coordination games are able to cap-
ture many types of interactions in the real world  in fact 
several kinds of positive community effects easily fall within
their scope  for instance  members of a scientific community
obviously benefit from successful collaborations with their
colleagues  while at the same time having personal prefer-
ences of what they would like to work on   however  any
individual also benefits  albeit to a smaller degree  when his
close colleagues have successful collaborations that he is not
personally a part of  this is quite obvious when thinking
about the student–advisor relationship  but also noticeable for
researchers working at the same university or institution  a
further example comes from politics  where a person who be-
longs to a party profits not only from her direct contacts  but
also from the contacts of her contacts  etc  at the same time  it
is also common that the benefit obtained by relations at sec-
ond or higher distance level generate less payoff  which is
taken into account by our discount factors 
in the setting described above  we will be focusing on the
efficiency of the system  our reference point for stability will
be k-strong nash equilibria  which are action profiles from
which no group of up to k agents can simultaneously deviate
such that all of them profit from the deviation  such a defini-
proceedings of the thirtieth    ijcai-21 
3
 tion also includes the standard notion of nash equilibria for
k = 1  however  we will see that only for k ≥ 2 the ineffi-
ciency can be suitably bounded  this fact is not a real draw-
back  as some degree of communication between the agents
is to be expected in real-world scenarios  and especially in
the ones modeled by means of these games  which assume a
positive coordination effect among close agents  our analysis
provides bounds which depend on k and on the discounting
factors for the part of the utility of the agents coming from
non-first-hand interactions 
1 1
related work
polymatrix games were introduced several decades ago
 yanovskaya  1968  and have been thoroughly studied since 
both in some classical works  howson  1972  eaves  1973 
howson and rosenthal  1974  miller and zucker  1991  and
also more recently with a special focus on equilibria  rahn
and sch¨afer  2015  cai et al   2016  deligkas et al   2017 
deligkas et al   2020  
polymatrix coordination games  rahn and sch¨afer  2015  
in which the bimatrix games have symmetrical payoffs and
players have individual preferences  are the basis of our
model  indeed  they are encompassed by our model by setting
d = 1  polymatrix coordination games are in turn an exten-
sion of a previously introduced model that did not include
individual preferences  cai and daskalakis  2011  
our model is also related to the so-called social context
games  ashlagi et al   2008   where the players  utilities are
computed from the payoffs based on the underlying neighbor-
hood graph and an aggregation function  we consider more
than just the neighborhood of an agent  and we account the
player s preference only for her own utility 
related to our work are also  symmetric  additively separa-
ble hedonic games  dr eze and greenberg  1980  and hyper-
graph hedonic games  aloisio et al   2020   where the players
are embedded in a weighted graph and the utility is computed
as the sum of the edges or hyperedges towards members of the
same coalition  the difference from our model  however  is
that in hedonic games in general every coalition is a feasible
choice for every player  there are no individual preferences 
and the weights in each bimatrix are all equal to either 0 or to
a fixed value w 
another model related to our work is the group activity se-
lection problem  darmann et al   2012  darmann and lang 
2017  bil o et al   2019   standing between polymatrix coordi-
nation games and hedonic games  also here  in each bimatrix
all the weights are either 0 or a fixed value w  but there are
also individual preferences that depend on the chosen activity 
a generalization of polymatrix coordination games to hy-
pergraphs is called synchronization games  simon and wo-
jtczak  2017   for which the existence and computability of
pure and strong nash equilibria have been studied  without
investigating the degradation of social welfare 
some negative results for our problem can be inherited
from additively separable hedonic games  for instance  com-
puting a nash stable outcome is pls-complete  gairing and
savani  2010   while computing an optimal outcome and de-
termining the existence of a core stable  strict core stable 
nash stable  or individually stable outcome are all np-hard
problems  aziz et al   2011   it has also been proven that
finding a pure nash equilibrium in a polymatrix coordination
game is pls-complete  cai and daskalakis  2011  
the idea of obtaining utility from non-neighboring players
has been explored recently for a variant of hedonic games 
called distance hedonic games  that are not additively sepa-
rable  since the coalition size also plays a role in determining
the payoffs  flammini et al   2020   they generalize frac-
tional hedonic games  aziz et al   2019  elkind et al   2020 
monaco et al   2020  carosi et al   2019  bil o et al   2018 
similarly as our model does with polymatrix games 
1 2
our contribution
we study the inefficiency of k-stable nash equilibria of d-
distance polymatrix coordination games and provide suitable
bounds on both the price of anarchy and the price of sta-
bility  to the best of our knowledge  there are no previous
results of this kind in the literature that would apply to our
model  in section 3  we give upper and lower bounds for
bounded-degree graphs  with the gap being reasonably small 
and in section 4  a tight bound on the price of anarchy for
general graphs  finally  in section 5  we show that in general
graphs the price of stability is asymptotically equal to the
price of anarchy  meaning that the ineffieciency of k-strong
equilibria is fully characterized  the related proof technique
is in our opinion of independent interest and a valuable con-
tribution in itself  as it provides a general approach that can
potentially be used in other contexts 
we remark that our results apply also to the subclass of the
classical polymatrix coordination games  for which in turn we
get the first upper and lower bounds on the price of anarchy
for bounded-degree graphs  and the first asymptotically tight
lower bound on the price of stability for general graphs 
our results are summarized in table 1  due to space con-
straints  some of the proofs are only sketched  while all the
details are deferred to the full version 
bounded-degree
general
poak lb 
poak ub 
�
h∈ d  αh∆ ∆−1 h−1
�
h∈ d  αh ∆−1 ⌊h/2⌋
2 �
h∈ d  αh∆ ∆ − 1 h−1
 2 α2· n−2  · n−1 
k−1
posk ub 
posk lb 
↓
←
↓
2n−3   α2 n−2  n−3/2 
 1 α2 k
table 1  summary of our results  where ub and lb stands for upper
and lower bound  respectively  furthermore  ∆ denotes the maximal
vertex degree in the bounded-degree case and αh  h ∈  d   is the
discounting factor for edges at distance h − 1  the arrows denote
that a result follows from an adjacent result in the table 
2
model and definitions
distance polymatrix coordination games 
given an in-
teger d ≥ 1  a d-distance polymatrix coordination game
g =  g   σx x∈v    we e∈e   px x∈v    αh h∈ d  
proceedings of the thirtieth    ijcai-21 
4
 is a tuple defined as follows 
• g =  v  e  is an undirected graph  where v is the set
of players and e the set of edges between players 
• for any x ∈ v   σx is a finite set of strategies of player x 
a strategy profile σ =  σ1          σn  is a configuration in
which each player x ∈ v plays strategy σx ∈ σx 
• for any edge  v  z  ∈ e  let w v z    σv × σz →
r≥0 be the weight function that assigns  to each pair of
strategies σv  σz played respectively by v and z  a weight
w v z  σv  σz  ≥ 0 
• for any x ∈ v   let px   σx → r≥0 be the player-
preference function that assigns  to each strategy profile
σx played by player x  a non-negative real value px σx  
called player-preference 
• let  αh h∈ d  be the distance-factors sequence of the
game  that is a non-negative sequence of real parame-
ters  called distance-factors  such that 1 = α1 ≥ α2 ≥
      ≥ αd ≥ 0 
in what follows  for the sake of brevity  given any strategy
profile σ  we will often denote w v z  σv  σz  and px σx 
simply as w v z  σ  and px σ   respectively 
for any h ∈  d   let eh x  be the set of edges  v  z  such
that the minimum distance between x and one of the players
v and z is exactly h − 1  then  for any x ∈ v   the utility
function ux   ×x∈v σx → r of player x  for any strategy
profile σ is defined as
ux σ   = px σ   
�
h∈ d 
αh
�
e∈eh x 
we σ  
remark 1  we observe that  if d = 1  we obtain the classical
polymatrix coordination games  where the overall utility of
player x only depends on payoffs we σ  for e for which x is
an endpoint  instead  if d > 1  the overall utility of player x
further depends on the discounted payoffs αh 1 · w v z  σ 
arising by mutual actions of players v  z that are the endpoints
of edges at any distance h < d from x 
given a strategy profile σ  the social welfare of σ is de-
fined as sw σ  = �
x∈v ux σ   a social optimum of game
g is a strategy profile σ∗ that maximizes the social welfare 
we denote by opt g  = sw σ∗  the corresponding value 
k-strong nash equilibrium 
given two strategy profiles
σ =  σ1          σn  and σ∗ =  σ∗
1          σ∗
n   and a subset
z ⊆ v   let σ
z→ σ∗ be the strategy profile σ′ =  σ′
1          σ′
n 
such that σ′
x = σ∗
x if x ∈ z  and σ′
x = σx otherwise  given
k ≥ 1  a strategy profile σ is a k-strong nash equilibrium of
g if  for any strategy profile σ∗ and any z ⊆ v such that
|z| ≤ k  there exists x ∈ z such that ux σ  ≥ ux σ
z→ σ∗  
informally  σ is a k-strong nash equilibrium if  for any coali-
tion of at most k players deviating  there exists at least one
player in the coalition that has no benefit  we denote the  pos-
sibly empty  set of k-strong nash equilibria of g by nek g  
k-strong price of anarchy  poa  and price of stability
 pos  
the k-strong price of anarchy of a game g is de-
fined as poak g   = maxσ∈nek g 
opt g 
sw σ    i e   it is the
1
2
3
4
5
6
7
8
0
0
1
0
1
1
1
figure 1  the underlying graph of the d-distance polymatrix coordi-
nation game from example 1 for n = 8  where the weight function
has already been evaluated  in particular  the nodes playing strategy
s are depicted as squares  and the ones playing s∗ as hexagons 
worst-case ratio between the optimal social welfare and the
social welfare of a k-strong nash equilibrium  the k-strong
price of stability of game g is defined as posk g   =
minσ∈nek g 
opt g 
sw σ    i e   it is the best-case ratio between the
optimal social welfare and the social welfare of a k-strong
nash equilibrium  clearly  posk g  ≤ poak g   whereas
both quantities are not defined if nek g  = ∅ 
example 1  consider a d-distance polymatrix coordination
game with n = 8 players whose underlying graph is a star
 shown in figure 1 for n = 8   let σx =  s  s∗  for every
x ∈  n   w x y  σ  = 1 iff σx = σy = s∗ and 0 otherwise 
furthermore  let p1 σ  = 1 iff σ1 = s and 0 otherwise  while
all other player-preference functions are constant and equal
to zero  then  the strategy profile in which all players play s∗
is a k-strong nash equilibrium for any k  the utility of player
1 for this strategy profile is n − 1  while for all other players
it is 1 for d = 1 and 1    n − 2 α2 for d ≥ 2 
3
k-strong poa of bounded-degree graphs
in this section we compute upper and lower bounds on the
k-strong price of anarchy of bounded-degree graphs  more
formally  a game g is ∆-bounded-degree if the degree of each
node/player x ∈ v in graph g is at most ∆ 
remark 2  for k = 1  d ≥ 1  and ∆ = 1  there exists
a simple ∆-bounded-degree d-distance polymatrix coordina-
tion game g such that poak g  = ∞  rahn and sch¨afer 
2015   for sake of completeness  we present this example in
the full version  thus  as it is not possible to bound the k-
strong poa for k = 1  not even for bounded-degree graphs
and not even when ∆ = 1  in the rest of the paper we will
only focus on the estimation of the k-strong poa for k ≥ 2 
furthermore  if ∆ = 1  w l o g  we can assume that the graph
consists of 2 agents and an edge between them  this special
case is encompassed by section 4  so here we will assume
that ∆ ≥ 2 
theorem 1  for any integer k ≥ 2 and any ∆-bounded-
degree d-distance polymatrix coordination game g having a
distance-factors sequence  αh h∈ d   it holds that
poak g  ≤ 2
�
h∈ d 
αh · ∆ ·  ∆ − 1 h−1 
 1 
remark 3  from eq   1   notice that the k-strong price of an-
archy of ∆-bounded-degree d-distance polymatrix coordina-
tion games  as a function of d  grows at most as o  ∆−1 d  
proceedings of the thirtieth    ijcai-21 
5
 before proving the theorem  we provide a lemma that gives
an upper bound on the social welfare of any strategy profile 
lemma 1  for any strategy profile σ  it holds that sw σ  ≤
�
x∈v px σ    2 �
h∈ d  αh ·  ∆ − 1 h−1 · �
e∈e we σ  
proof  for any e ∈ e and h ∈  d   let nh e   = | x ∈ v
 
e ∈ eh x  |  i e   nh e  denotes how many players x ∈ v
have distance equal to h − 1 from e  we can see that
�
x∈v
�
e∈eh i 
we σ  =
�
e∈e
nh e  · we σ  
 2 
furthermore  the number of players having distance h − 1 to
an edge e =  v  z  is at most equal to the number of simple
paths starting from either v or z and having length h−1  this
number is upper bounded by 2 ·  ∆ − 1 h−1  therefore 
nh e  ≤ 2 ·  ∆ − 1 h−1 
 3 
by using  2  and  3   we get
sw σ  =
�
x∈v
px σ   
�
h∈ d 
αh
�
x∈v
�
e∈eh x 
we σ 
=
�
x∈v
px σ   
�
h∈ d 
αh
�
e∈e
nh e  · we σ 
=
�
x∈v
px σ   
�
e∈e
�
h∈ d 
αh · nh e  · we σ 
≤
�
x∈v
px σ   
�
e∈e
�
h∈ d 
αh · 2 ·  ∆ − 1 h−1we σ 
=
�
x∈v
px σ    2
�
h∈ d 
αh ·  ∆ − 1 h−1 �
e∈e
we σ  
thus showing the claim 
proof of theorem 1  fix k ≥ 2  let σ and σ∗ be a worst-
case k-strong nash equilibrium and a social optimum of g 
respectively  as k ≥ 2  σ is in particular also a 2-strong
nash equilibrium  thus  for any edge e ∈ e  we know that
there exists a player ve ∈ e  such that
uve σ  ≥ uve σ
e→ σ∗  ≥ pve σ∗    we σ∗  
 4 
for any e ∈ e  let ze denote the player in e \  ve   as σ is
also a 1-strong nash equilibrium  we have that
uze σ  ≥ uze σ
 ze 
→ σ∗  ≥ pze σ∗  
 5 
by using  4  and  5   we get
�
e∈e
 uve σ    uze σ  
≥
�
e∈e
 pve σ∗    pze σ∗    we σ∗  
≥
�
e∈e
we σ∗   
�
x∈v
px σ∗ 
≥
�
�2
�
h∈ d 
αh ·  ∆ − 1 h−1
�
�
−1
· sw σ∗ 
 6 
where  6  comes from lemma 1  furthermore  we get
�
e∈e
 uve σ    uze σ   ≤
�
x∈v
∆·ux σ  = ∆·sw σ    7 
since  in the left-hand part of  7   the utility of each player
is counted at most ∆ times 
by putting together  6  and
 7   we get sw σ  ≥ ∆−1 · �
e∈e  uve σ    uze σ   ≥
∆−1 ·
�
2 �
h∈ d  αh ·  ∆ − 1 h−1�−1
· sw σ∗   this shows
the claim  since we get poak g  = sw σ∗ 
sw σ  ≤ 2 �
h∈ d  αh ·
∆ ·  ∆ − 1 h−1 
in the following theorem we provide a lower bound on
the k-strong price of anarchy  relying on a nice construction
from graph theory 
theorem 2  for any k ≥ 2  ∆ ≥ 2  d ≥ 1  and any distance-
factors sequence  αh h∈ d   there exists a ∆-bounded-degree
d-distance polymatrix coordination game g such that
poak g  ≥
�
h∈ d  αh · ∆ ·  ∆ − 1 h−1
�
h∈ d  αh ∆ − 1 ⌊h/2⌋
 
 8 
remark 4  notice that  if all the distance-factors are not
lower than a constant c > 0  from eq   8  we can conclude
that the k-strong price of anarchy of ∆-bounded-degree d-
distance polymatrix coordination games  as a function of d 
can grow as ω  ∆ − 1 d/2   the formal proof of this remark
is deferred to the full version  
proof of theorem 2  fix k ≥ 2  ∆ ≥ 2  d ≥ 1  and a
distance-factors sequence  αh h∈ d   by  sachs  1963   there
exists an undirected graph g =  v  e  such that g is ∆-
regular  i e   every node in v has degree ∆   and the girth1
of g is at least max 2d   1  k   1   let g be a ∆-bounded-
degree d-distance polymatrix coordination game such that 
 i  g is its underlying graph   ii   αh h∈ d  is its distance-
factors sequence   iii  each player x has two strategies  s and
s∗   iv  for every edge e =  v  z  ∈ e and strategy profile
σ  we σ  = 1 if both v and z play s∗ in σ  and 0 otherwise 
 v  for every x ∈ v   px σ  = �
h∈ d  αh ∆ − 1 ⌊h/2⌋ if x
plays s in σ  otherwise px σ  = 0  let σ and σ∗ be the
strategy profiles in which all players play strategy s and s∗ 
respectively  we present two technical lemmas  which use the
above defined properties of graph g 
lemma 2  σ is a k-strong nash equilibrium 
proof sketch  we prove the claim by assuming that σ is not
a k-strong nash equilibrium  i e   there exists a coalition z
with |z| ≤ k such that all the players of z get a benefit when
deviating simultaneously to their strategy in σ∗  as there
exists no simple cycle with ≤ k edges in g  we have that
the subgraph g′ induced by z is a forest  we consider an
arbitrary tree t of g′ and we fix a root r of t  then  we
consider a player y corresponding to one of the deepest leaves
of rooted tree t  and we assume w l o g  that t is a complete
tree of height d whose root has ∆ children and each other
non-leaf node has ∆−1 children  see figure 2 for a clarifying
proceedings of the thirtieth    ijcai-21 
6
 y
r
t ′
figure 2  the utility of a leaf node y in t  with root r  for ∆ = 4
and d = 4  here  t ′ denotes a perfect 3-ary tree of height 4 
example   finally  we show that player y does not get any
benefit from the deviation  thus reaching a contradiction 
lemma 3  ux σ∗  = �
h∈ d  αh · ∆ ·  ∆ − 1 h−1 for any
x ∈ v  
proof sketch  as graph g is ∆-regular and the girth of g is at
least 2d 1  we necessarily have that |eh x | = ∆ ∆−1 h−1
for every h ∈  d   to show the above equality  we observe that
the subgraph of g made of all the edges at distance at most
d − 1 from x  i e   all the edges in ∪h∈ d eh x   is a perfect
tree of depth d rooted in x such that each non-leaf node has
degree ∆ 
by using the above equality  for every x ∈ v it holds that
ux σ∗  = �
h∈ d  αh|eh x | = �
h∈ d  αh∆ ∆ − 1 h−1 
from lemma 2 and 3  we get poak g  ≥
�
x∈v ux σ∗ 
�
x∈v ux σ  ≥
�
h∈ d  αh·∆· ∆−1 h−1
�
h∈ d  αh ∆−1 ⌊h/2⌋  
4
k-strong poa of general graphs
in this section  we provide tight bounds on the k-strong price
of anarchy when there is no particular assumption on the un-
derlying graph of the considered game  such bounds depend
on k  on the number of players n  and on the value α2 of the
distance-factors sequence 
theorem 3  for any integer k ≥ 2 and any d-distance poly-
matrix coordination game g having a distance-factors se-
quence  αh h∈ d   we have poak g  ≤  2 α2· n−2  · n−1 
k−1
 
before proving the theorem  we provide a lemma that  sim-
ilarly to lemma 1  gives an upper bound on the social welfare
of any strategy profile 
lemma 4  for any strategy profile σ  it holds that sw σ  ≤
�
x∈v px σ     2   α2 ·  n − 2   · �
e∈e we σ  
proof sketch  we define nh e  as in the proof of lemma 1 
and know that eq   2  holds 
furthermore  one can eas-
ily show that  for any e ∈ e  |n1 e | = 2  and therefore
�d
h=2 nh e  = �d
h=1 nh e  − n1 e  ≤ n − n1 e  = n − 2 
from here  by using eq   2   and the fact that α1 = 1 and
α2 ≥ αh for any h ∈  d  \  1   we get the claim 
proof of theorem 3  fix k ≥ 2  let σ and σ∗ be a worst-
case k-strong nash equilibrium and a social optimum of g 
respectively  as σ is a k-strong nash equilibrium  we have
that  for any z ⊆ v with |z| = k  there exists a player
1the length of a shortest cycle contained in the graph
z1 z  ∈ z such that uz1 z  σ  ≥ uz1 z  σ
z→ σ∗   fur-
thermore  there also exists a player z2 z  ∈ z 2   = z\ z1 
such that uz2 z  σ  ≥ uz2 z  σ
z 2 
→ σ∗   if we proceed it-
eratively  we have that  for any i ∈  k   there exists a player
zi z  ∈ z i   = z \  z1 z           zi−1 z   such that
uzi z  σ  ≥ uzi z  σ
z i 
→ σ∗  
 9 
before continuing the proof  we present two technical lem-
mas below 
lemma 5 
�n−1
k−1
�
· sw σ  = �
z⊆v
|z|=k
�
i∈ k  uzi z  σ  
lemma 6  it holds that
�
z⊆v
|z|=k
�
i∈ k 
uzx z  σ
z x 
→ σ∗ 
≥
�n − 1
k − 1
� �
x∈v
px σ∗   
�n − 2
k − 2
� �
e∈e
we σ∗  
proof of theorem 3  cont    by putting together the auxiliary
lemmas  we get
�n − 1
k − 1
�
· sw σ  =
�
z⊆v  |z|=k
�
i∈ k 
uzi z  σ 
 10 
≥
�
z⊆v  |z|=k
�
i∈ k 
uzi z  σ
z i 
→ σ∗ 
 11 
≥
�n − 1
k − 1
� �
x∈v
px σ∗   
�n − 2
k − 2
� �
e∈e
we σ∗ 
 12 
≥
�n − 2
k − 2
� ��
x∈v
px σ∗   
�
e∈e
we σ∗ 
�
≥
�n − 2
k − 2
�
·  2   α2 ·  n − 2  −1 · sw σ∗  
 13 
where  10    11    12   and  13   follow by lemma 5  eq   9  
lemma 6  and lemma 4  respectively  by exploiting  13   we
get poak g  ≤  
n−1
k−1 · 2 α2· n−2  
 
n−2
k−2 
=
 2 α2· n−2  · n−1 
k−1
 
thus showing the claim 
in the following theorem  we provide a tight lower bound 
theorem 4  for any k ≥ 2  d ≥ 1  n ≥ 2  and any distance-
factors sequence  αh h∈ d   there is a d-distance polymatrix
coordination game g with poak g  ≥  2 α2· n−2  · n−1 
k−1
 
proof sketch  fix d ≥ 1  k ≥ 2  n ≥ 2  and a distance-factors
sequence  αh h∈ d   let g be the d-distance polymatrix co-
ordination game of example 1  having n players   αh h∈ d 
as distance-factors sequence  and defined as follows   i  the
underlying graph g is a star in which all the players x ≥ 2
are only connected to player 1   ii  each player can play two
strategies s  s∗ only   iii  we σ  = 1 if all the players in e
play strategy s∗ under strategy profile σ  and we σ  = 0 oth-
erwise   iv  p1 σ  = k − 1 if player 1 plays strategy s under
proceedings of the thirtieth    ijcai-21 
7
 strategy profile σ  and p1 σ  = 0 otherwise   v  px σ  = 0
for any strategy profile σ and x ≥ 2  let σ and σ∗ be the
strategy profiles in which all players play strategy s and s∗ 
respectively  we can show that σ is a k-strong nash equilib-
rium and that poak g  ≥ sw σ∗ 
sw σ  =  2 α2· n−2  · n−1 
k−1
 
5
the k-strong pos of general graphs
in this section we show that there exists a d-distance poly-
matrix coordination game g such that posk g  is asymptoti-
cally equal to the upper bound on poak shown in theorem 3 
thus we completely characterize the inefficiency of d-distance
polymatrix coordination games for general graphs 
the modus operandi that we use to create the lower bound
for posk is to start from the lower bound instance on poak
provided in the proof of theorem 4  in which the optimal
outcome is a k-strong nash equilibrium  and to suitably trans-
form it in such a way that all the outcomes with social welfare
close to the optimum  which we call set of almost optimal out-
comes  cannot be stable  this is accomplished by inserting a
cycle of improvement steps involving these solutions  that ba-
sically do not influence the social welfare 
this technique is of independent interest  as it provides a
general approach that can be potentially used in other con-
texts  thus  we believe it is a valuable contribution in itself 
theorem 5  for any n ≥ 6  there exists a d-distance
polymatrix coordination game g such that posk g 
=
2n−3   α2 n−2  n−3/2 
 1 α2 k
 
proof  let g be defined as follows  the underlying graph g
has n nodes and 2n − 3 edges  where
e =   1  h    2  ℓ    h ∈  2          n   ℓ ∈  3          n  
 see figure 3   and σx =  1  2  3  for any x ∈  n   i e  
each player can play the same three strategies  we call bot-
tom layer  medium layer  and top layer the strategy profile in
which every player plays strategy 3  2  and 1  respectively 
we also shortly refer to strategies 3  2  and 1 by bottom 
medium  and top  respectively 
we now define for each layer the player-preference and
weight functions  where each entry that is not mentioned  we
assume to be null  at the bottom layer p1 3  = p2 3  =
 1   α2  1   ϵ  
at the medium layer  w 1 2  2  2  =
w 1 h  2  2  = w 2 h  2  2  =
1 ϵ
k   where 3 ≤ h ≤ n 
at the top layer p1 1  = p2 1  =
1
k  w 1 h  1  1  =
w 2 h  1  1  =
1 ϵ
k   where 3 ≤ h ≤ n  non-null edges
between the layers are w 1 2  1  2  =
2ϵ
k   w 1 h  1  2  =
w 1 h  2  1  = w 2 h  1  2  = w 2 h  2  1  =
1 ϵ
k   where
3 ≤ h ≤ n 
1
2
3
4
5
6
7
figure 3  graph g from the proof of theorem 5 for n = 7 
player 1
player 2
top
medium
top
1
k 
1
k
1 2ϵ
k  
2ϵ
k
medium
0 
1
k
1 ϵ
k  
1 ϵ
k
table 2  the part of the utility of player 1 and 2 coming from the
player-preference and the weight w 1 2  σ  for σ1  σ2 ∈  1  2   no
strategy profile is stable  as always at least one player can improve
her utility by deviating 
lemma 7  the bottom layer is a k-strong equilibrium with
social welfare 2 1   α2  1   ϵ  
lemma 8  all the k-strong equilibria have the same social
welfare 2 1   α2  1   ϵ  
proof sketch  if there exists an equilibrium where both play-
ers 1 and 2 are at the bottom  then the social welfare is
2 1   α2  1   ϵ   and we do not investigate further  if one of
the players 1 and 2 is not at the bottom  then all the players
will move to medium or top  starting from the ones different
from 1 and 2  finally  if both are not at the bottom  then at
least one of the players 1 and 2 will always move  this is
so  because each of them gets a constant utility from the re-
maining players  so they move just according to their bimatrix
game  whose values are reported in table 2 
the following lemma concludes the theorem 
lemma 9  the ratio between the optimum social wel-
fare and the social welfare given by one of the k-strong
nash stable strategy profiles  e g   the bottom layer  is
2n−3   α2 n−2  n−3/2 
 1 α2 k
  giving the posk g  
6
conclusion
in this work  we have introduced the class of d-distance poly-
matrix coordination games  and studied their performance
 by means of the k-strong price of anarchy and stability  
some open problems left by our work are that of closing
the gap between the upper and lower bound on the strong
price of anarchy for bounded-degree graphs  and provid-
ing better bounds on the strong price of stability specifically
for the case of bounded-degree graphs  another interesting
research direction is extending the idea of obtaining utili-
ties from non-neighboring players  as in  flammini et al  
2020  and our work  to other graphical games  kearns  2007 
bil o et al   2010   and then studying the social performance
of their equilibria in general graphs or specific topologies 
acknowledgements
this work has been partially supported by the italian miur
prin 2017 project algadimar  algorithms  games  and
digital markets  
proceedings of the thirtieth    ijcai-21 
8
 references
 aloisio et al   2020  alessandro aloisio  michele flam-
mini  and cosimo vinci  the impact of selfishness in hy-
pergraph hedonic games 
in proc  34th conf  artificial
intelligence  aaai   pages 1766–1773  2020 
 ashlagi et al   2008  itai ashlagi  piotr krysta  and moshe
tennenholtz 
social context games 
in proc  4th intl 
workshop internet   network economics  wine   pages
675–683  2008 
 aziz et al   2011  haris aziz  felix brandt  and hans georg
seedig  optimal partitions in additively separable hedonic
games  in proc  22nd intl  joint conf  artif  intell   ijcai  
pages 43–48  2011 
 aziz et al   2019  haris aziz  florian brandl  felix brandt 
paul harrenstein  martin olsen  and dominik peters  frac-
tional hedonic games  acm trans  economics and com-
put   7 2  6 1–6 29  2019 
 bil o et al   2010  vittorio bil o  angelo fanelli  michele
flammini  and luca moscardelli  when ignorance helps 
graphical multicast cost sharing games  theoret  comput 
sci   411 3  660–671  2010 
 bil o et al   2018  vittorio bil o  angelo fanelli  michele
flammini  gianpiero monaco  and luca moscardelli 
nash stable outcomes in fractional hedonic games  ex-
istence  efficiency and computation  j  artif  intell  res  
62 315–371  2018 
 bil o et al   2019  vittorio bil o  angelo fanelli  michele
flammini  gianpiero monaco  and luca moscardelli  op-
timality and nash stability in additive separable general-
ized group activity selection problems  in proc  28th intl 
joint conf  artif  intell   ijcai   pages 102–108  2019 
 cai and daskalakis  2011  yang
cai
and
constantinos
daskalakis  on minmax theorems for multiplayer games 
in proc  22nd symp  discr  algorithms  soda   pages
217–234  2011 
 cai et al   2016  yang cai  ozan candogan  constantinos
daskalakis  and christos h  papadimitriou 
zero-sum
polymatrix games  a generalization of minmax  math 
oper  res   41 2  648–655  2016 
 carosi et al   2019  raffaello carosi  gianpiero monaco 
and luca moscardelli  local core stability in simple sym-
metric fractional hedonic games 
in proc  18th conf 
autonomous agents and multi-agent systems  aamas  
pages 574–582  2019 
 darmann and lang  2017  andreas darmann and j erˆome
lang 
group activity selection problems 
in trends in
computational social choice  pages 385–410  2017 
 darmann et al   2012  andreas darmann 
edith elkind 
sascha kurz  j erˆome lang  joachim schauer  and ger-
hard j  woeginger  group activity selection problem  in
proc  8th intl  workshop internet   network economics
 wine   volume 7695  pages 156–169  2012 
 deligkas et al   2017  argyrios deligkas  john fearnley 
rahul savani  and paul g  spirakis  computing approx-
imate nash equilibria in polymatrix games  algorithmica 
77 2  487–514  2017 
 deligkas et al   2020  argyrios deligkas  john fearnley 
and rahul savani  tree polymatrix games are ppad-hard 
in proc  47th intl  coll  autom  lang  program   icalp  
pages 38 1–38 14  2020 
 dr eze and greenberg  1980  jacquese h  dr eze and joseph
greenberg  hedonic coalitions  optimality and stability 
econometrica  48 4  987–1003  1980 
 eaves  1973  b  curtis eaves 
polymatrix games with
joint constraints  siam journal on applied mathematics 
24 3  418–423  1973 
 elkind et al   2020  edith elkind 
angelo fanelli 
and
michele flammini  price of pareto optimality in hedonic
games  artif  intell   288 103357  2020 
 flammini et al   2020  michele flammini  bojana kodric 
martin olsen  and giovanna varricchio  distance hedo-
nic games  in proc  19th conf  autonomous agents and
multi-agent systems  aamas   pages 1846–1848  2020 
 gairing and savani  2010  martin gairing and rahul sa-
vani  computing stable outcomes in hedonic games  in
proc  3rd intl  symp  algorithmic game theory  sagt  
pages 174–185  2010 
 howson and rosenthal  1974  joseph howson and robert
rosenthal 
bayesian equilibria of finite two-person
games with incomplete information 
management sci  
21 3  313–315  1974 
 howson  1972  joseph howson  equilibria of polymatrix
games  management sci   18 5-part-1  312–318  1972 
 kearns  2007  michael kearns 
graphical games  page
159–180  cambridge university press  2007 
 miller and zucker  1991  douglas
miller
and
steven
zucker  copositive-plus lemke algorithm solves polyma-
trix games  oper  res  lett   10 5  285–290  1991 
 monaco et al   2020  gianpiero monaco  luca moscardelli 
and yllka velaj  stable outcomes in modified fractional
hedonic games  auton  agents multi agent syst   34 1  4 
2020 
 rahn and sch¨afer  2015  mona rahn and guido sch¨afer 
efficient equilibria in polymatrix coordination games  in
proc  40th intl  symp  math  foundations of computer sci-
ence  mfcs   pages 529–541  2015 
 sachs  1963  horst sachs  regular graphs with given girth
and restricted circuits  journal of the london mathemati-
cal society  1 1  423–429  1963 
 simon and wojtczak  2017  sunil simon and dominik wo-
jtczak  synchronisation games on hypergraphs  in proc 
26th intl  joint conf  artif  intell   ijcai   pages 402–408 
2017 
 yanovskaya  1968  elena b  yanovskaya 
equilibrium
points in polymatrix games 
lithuanian mathematical
journal  8 2  381–384  1968 
proceedings of the thirtieth    ijcai-21 
9
 "
None,2021,0001,Diversity in Kemeny Rank Aggregation: A Parameterized Approach,"Emmanuel Arrighi, Henning Fernau, Daniel Lokshtanov, Mateus de Oliveira Oliveira, Petra Wolf",abstract comes here,https://www.ijcai.org/proceedings/2021/0002.pdf,data/fulltext/pdf/2021/0001.pdf,../vikus-viewer/data/fulltext/pdf/2021/0001.pdf,"diversity in kemeny rank aggregation 
a parameterized approach
emmanuel arrighi1   henning fernau2   daniel lokshtanov3
mateus de oliveira oliveira1   petra wolf 2
1university of bergen  norway
2university of trier  germany
3university of california santa barbara  ca  usa
 emmanuel arrighi  mateus oliveira @uib no   fernau  wolfp @informatik uni-trier de 
 daniello @ucsb edu
abstract
in its most traditional setting  the main concern of
optimization theory is the search for optimal solu-
tions for instances of a given computational prob-
lem  a recent trend of research in artificial intelli-
gence  called solution diversity  has focused on the
development of notions of optimality that may be
more appropriate in settings where subjectivity is
essential  the idea is instead of aiming at the devel-
opment of algorithms that output a single optimal
solution  the goal is to investigate algorithms out-
putting a small set of sufficiently good solutions that
are sufficiently diverse from one another  this way 
the user has the opportunity to choose the solution
being most appropriate to the context at hand  it
also displays the richness of the solution space 
when combined with techniques from parameter-
ized complexity theory  the paradigm of diversity
of solutions offers a powerful algorithmic frame-
work to address problems of practical relevance  in
this work  we investigate the impact of this com-
bination in the field of kemeny rank aggregation 
a well-studied class of problems lying in the inter-
section of order theory and social choice theory and
also in the field of order theory itself  in particular 
we show that the kemeny rank aggregation prob-
lem is fixed-parameter tractable with respect to nat-
ural parameters providing natural formalizations of
the notions of diversity and of the notion of a suffi-
ciently good solution  our main results work both
when considering the traditional setting of aggre-
gation over linearly ordered votes  and in the more
general setting where votes are partially ordered 
1
introduction
traditionally  in optimization theory  when given an instance
of a computational problem  one is interested in computing
some optimal solution for the instance in question  for cer-
tain problems of practical relevance  this framework may not
be satisfactory because it precludes the user from the pos-
sibility of choosing among optimal solutions in case more
than one exists  or from choosing a slightly less optimal solu-
tion that may be a better fit for the intended application  due
to subjective factors  a recent upcoming trend of research
in artificial intelligence  called diversity of solutions  petit
and trapp  2019  baste et al   2020  ingmar et al   2020 
baste et al   2019  fomin et al   2020   has focused on the
development of notions of optimality that may be more ap-
propriate in settings where subjectivity is essential  the idea
is that instead of aiming at the development of algorithms that
output a single optimal solution  the goal is to investigate al-
gorithms that output a small set of sufficiently good solutions
that are sufficiently diverse from one another  in this way  the
user has the opportunity to choose the solution that is most
appropriate to the context at hand  the intuition is that the
criteria employed by the user to decide what an appropriate
solution is may be subjective  and therefore  impractical or
even impossible to be formalized at the level of the problem
specification  examples of such criteria are aesthetic  eco-
nomic  political  or environmental criteria  another motiva-
tion comes from the problem of finding several good commit-
tees such that each committee member is not overloaded with
commitments  as described in  bredereck et al   2020   again 
some diversity could be helpful 
one source of difficulty when trying to develop efficient
algorithms for diverse variants of computational problems is
the fact that these problems may be computationally hard 
in particular  many interesting computational problems that
are suitable for being studied from the perspective of diver-
sity of solutions are already np-hard in the usual variant in
which one asks for a single solution  additionally  it may be
the case that even problems that are polynomial-time solvable
in the single-solution version become np-hard when consid-
ering diverse sets of solutions  one way to circumvent this
difficulty is to combine the framework of diversity of solu-
tions with the framework of fixed-parameter tractability the-
ory  downey and fellows  1999   a central notion in this
framework is the one of fixed-parameter tractability  an al-
gorithm for a given computational problem is said to be fixed-
parameter tractable with respect to parameters k1          kr if it
runs in time f k1          kr  · no 1   where n is the size of the
input and f is a computable function that depends only on the
parameters  the intuition is that if the range of the parameters
proceedings of the thirtieth    ijcai-21 
10
 is small on instances of practical relevance  then even if the
function f grows relatively fast  the algorithm can be consid-
ered to be fast enough for practical purposes 
when studying a given computational problem from the
point of view of solution diversity  it is crucial to have in
hands a notion of distance between solutions for that prob-
lem  the diversity of a set of solutions s is then defined as the
sum of distances between pairs of solutions in s  we denote
this measure by d  intuitively  diversity is a global measure
for how representative a set of solutions is among the space
of solutions  three natural parameters can be used to quan-
tify how good a diverse set of solutions is  the number r of
solutions in the set  the maximum distance δ between the cost
of a solution in the set and the cost of an optimal solution  we
call this parameter the solution imperfection of the set   and
the minimum required distance s between any two solutions
in the set  this last parameter is also known in the literature
as the scatteredness of s  galle  1989  
in this work  we investigate the impact of the notions of di-
versity of solutions and of fixed parameter tractability theory
in the context of social choice theory  in particular  we focus
on the framework of preference list aggregation introduced by
kemeny in the late fifties  kemeny  1959   intuitively  prefer-
ence lists are a formalism used in social choice theory to cap-
ture information about choice in applications involving the
selection of candidates  products  etc  by a group of voters 
the task is then to find a ranking of the candidates that maxi-
mizes the overall satisfaction among the voters  this problem
is commonly referred to in modern terminology as the ke-
meny rank aggregation  kra  problem  in its most general
setting  the ranking cast by each voter is a partial order on the
set of candidates  the distance measure we use to define our
diverse version for kra is the kendall-tau distance which is
widely used in the context of preference aggregation  its pop-
ularity is underlined by articles describing these issues for the
interested public audience  see  farkas and timotity  2019  
our main result is a multi-parametric algorithm for di-
verse kra over partially ordered votes that runs in time
f w  r  δ  s  · d · n · log n2 · m   where n is the number of
candidates  m is the number of votes  r  δ  s and d are the pa-
rameters discussed above  and w is the unanimity width of
the votes  that is to say  the pathwidth of the cocomparabil-
ity graph of the unanimity order of the input votes  corol-
lary 11   intuitively  this width measure is a quantification of
the amount of disagreement between votes  note that path-
width and treewidth coincide for the class of cocomparability
graphs  habib and m¨ohring  1994  
on the path towards obtaining our results for kemeny
rank aggregation  we also make contributions to problems
of independent interest arising in the theory of cocompara-
bility graphs 
first  by leveraging on classic results from
 habib and m¨ohring  1994   we show that the problem of
constructing a ρ-consistent path decomposition of approxi-
mately minimum width for the cocomparability graph gρ of
a given partial-order ρ is fixed-parameter tractable with re-
spect to the pathwidth of gρ  while it was known that the
pathwidth and the ρ-consistent pathwidth of gρ are always
the same  arrighi et al   2020   and fixed-parameter tractable
algorithms for computing path decompositions of approxi-
mately minimum width exists due to structural properties of
cocomparability graphs  bouchitt e et al   2004   the problem
of computing such a decomposition satisfying the additional
ρ-consistent requirement was open  arrighi et al   2020  
second  we note that the notion of kendall-tau distance
between partial orders  formally defined in section 3   which
is used to define our notion of diversity  can be applied
equally well in the more general context of the comple-
tion of an ordering problem  co   a problem of funda-
mental importance in order theory that unifies several prob-
lems of relevance for artificial intelligence  such as kra 
one-sided crossing minimization  an important sub-
routine used in the search for good hierarchical representa-
tions of graphs   and grouping by swapping  a relevant
problem in the field of memory management   wong and
reingold  1991   for a matter of generality  we first develop a
f w  r  δ  s ·d·n·log n2·m  time algorithm for diverse co
 theorem 10  and then obtain our main result for diverse
kra as a corollary  in the more general context of co  the
parameter w is the width of the cocomparability graph of the
partial order given at the input 
finally  building on recent advances in the theory of ck-
free graphs  chudnovsky et al   2020  we establish an up-
per bound for the pathwidth of a cocomparability graph in
terms of the number of edges of the graph  as a by-product
of this result  we obtain the first algorithm running in time
o∗ 2o 
√
k    theorem 12  for the positive completion of an
ordering problem  pco   a special case of co which still
generalizes kra and other important combinatorial prob-
lems  previous to our work  the best algorithm for this prob-
lem parameterized by cost had asymptotic time complexity
o∗ ko 
√
k   = o∗ 2
√
k log k   we remove the log-factor in
the exponent  according to thm  18 in  arrighi et al   2020 
this is optimal under eth  exponential time hypothesis  
2
preliminaries
if n is a positive integer   n  =  1          n  denotes the dis-
crete interval of the first n positive integers  and  n 0 =
 n  ∪  0   n denotes the non-negative integers 
let c be a set  a partial order over c is a reflexive  anti-
symmetric and transitive binary relation ρ ⊆ c × c  we say
that ρ is a linear order if additionally  for each  x  y  ∈ c×c 
either  x  y  ∈ ρ or  y  x  ∈ ρ  the comparability relation
sc ρ  of ρ is the symmetric closure of ρ  i e    x  y  ∈ sc ρ 
iff  x  y  ∈ ρ or  y  x  ∈ ρ  for instance  sc ρ  = c × c iff
ρ is a linear order  if ρ ⊆ c ×c is a partial order  then <ρ de-
notes the corresponding strict order  which is irreflexive and
transitive  linear orders over c can be given by bijections
π    |c|  → c  hence  <π  or ≤π  is used to denote the
corresponding strict  or partial  linear order  given a binary
relation α  we denote by tc α  the transitive closure of α 
definition 1  cocomparability graph  f1    given a partial
order ρ ⊆ c × c  we let gρ ˙=  c  c × c \ sc ρ   be the
cocomparability graph of ρ 
given an undirected graph g =  v  e  and a vertex v ∈ v  
we let n v  ˙=  u | u ∈ v   v  u  ∈ e  be the neighborhood
of v  a path decomposition of a graph g =  v  e  is a se-
proceedings of the thirtieth    ijcai-21 
11
 quence p =  b1  b2          bl  of subsets of v   such that the
following conditions are satisfied 
• �
1≤i≤l bi = v  
• for each edge  u  v  ∈ e  there is an i ∈  l  such that
u  v ∈ bi 
• for each i  j  k ∈  l  with i < j < k  bi
� bk ⊆ bj 
for each position p ∈  2          l   for each vertex v ∈ bp \
bp−1  we say that bp introduces v  v is introduced by bp 
and for each vertex v ∈ bp−1 \ bp  we say that bp forgets v
 v is forgotten by bp   for a position p ∈  1          l   we write
intro p   resp  forg p   for the set of all vertices introduced
 resp  forgotten  by bp  and we let lp = �
1≤i≤p forg p  be
the set of vertices that have been forgotten up to position p 
the width of p is defined as w p  = maxi∈ l  |bi| − 1  the
pathwidth  pw g   of g is the minimum width of a path de-
composition of g 
the pathwidth of the cocomparability graph of a partial or-
der may be regarded as a measure of how close the order is
from being a linear order  the cocomparability graph of a
linear order τ on n elements is the graph with n vertices and
no edges  this graph has pathwidth 0  on the other hand  if τ
is a partial order where all n elements are unrelated  then the
cocomparability graph of τ is the n-clique  which has path-
width n − 1  the highest possible pathwidth in an n-vertex
graph  
3
the kemeny rank aggregation problem
let c be a finite set  which in this paper will denote a set of
candidates  or alternatives  a partial vote over c is a partial
order over c  the kt-distance between two partial votes π1
and π2  denoted by kt-dist π1  π2   is the number of pairs of
candidates that are ordered differently in the two partial votes 
kt-dist π1  π2  = |  c  c′  ∈ c×c | c <π1 c′∧c′ <π2 c |  
observe that when the votes are totally ordered  the
kendall-tau distance can be seen as the  bubble sort  dis-
tance  i e   the number of pairwise adjacent transpositions
needed to transform one linear order into the other  given a
linear order π over a set of candidates c and a set π of votes
over c  the kemeny score of π with respect to π is defined
as the sum of the kendall-tau distances between π and each
vote in π  in this work  we consider the following problem 
problem name  kemeny rank aggregation  kra 
given  a list of partial votes π over a set of candidates c 
a non-negative integer k 
output  is there a linear order π on c such that the sum of
the kt-distances of π from all the partial votes is ≤ k 
hence  given partial votes π1          πm of c and a non-
negative integer k  the question is if there exists a linear order
π ⊆ c × c such that �m
i=1 kt-dist π  πi  ≤ k  
definition 2  given a set π of partial votes  the unanimity
order of π is simply the partial order ρ obtained as the inter-
section of all partial orders in π  in other words  a candidate
c1 has higher precedence than a candidate c2 in ρ if and only
if c1 precedes c2 in each vote in π 
as a consequence  the more disagreements there are among
the voters with respect to the relative orders of pairs of can-
didates  the denser the cocomparability graph of ρ will be
and therefore the greater its pathwidth will be  therefore  the
pathwidth of the cocomparability graph of the unanimity or-
der of π may be seen as a quantification of the amount of
disagreement among the votes in π 
the notion of diversity of solutions for computationally
hard problems has been considered under a variety of frame-
works  in this work  we define a notion of diversity for the
kemeny rank aggregation problem which is analo-
gous to the notion of diversity of vertex sets used in  baste
et al   2020  
more precisely  if r is a set of partial or-
ders  then we define the kendall-tau diversity of r as the
sum of kendall-tau distances between votes in the set r 
kt-div r  = �
π1 π2∈r kt-dist π1  π2  
we note that the restricted version of the kra problem
where all votes are linear orders  the requirements that a set of
solutions is at the same time diverse and only contains rank-
ings with small kemeny score are clashing  the problem is
that the very existence of two distinct rankings with small ke-
meny score is an impossible task  if two candidates c1 and c2
occur with the order  c1  c2  in one of the solutions and in the
order  c2  c1  in the other solution  then at least one of these
solutions will have a kemeny score of at least half the num-
ber of votes  however this opposition between diversity and
small kemeny score is not present in the setting where votes
are allowed to be partial  the generalization to partial votes
is one possible way to circumvent this conflict of desiderata 
another way we will be looking at is not to consider the cost
of the solutions directly but the difference between the cost
of solutions and the cost of an optimal solution  in this case 
we can have diversity and a small difference between the cost
and the cost of an optimal solution 
problem name  diverse kemeny rank aggrega-
tion  diverse-kra 
given  a list of partial votes π over a set of candidates c 
and k  r  d ∈ n 
output  is there a set r =  π1          πr  of linear orders on
c such that the kemeny score for each order πi is at most
k and kt-div r  ≥ d 
the problem kemeny rank aggregation is known
to be np-complete  bartholdi et al   1989   even if only four
votes are given at the input  dwork et al   2001   for this rea-
son  kra has been studied from the perspective of param-
eterized complexity theory under a variety of parameteriza-
tions  below  we consider two prominent parameterizations
for this problem 
the first parameter we consider is the cost of a solu-
tion 
simjour  2009  obtained an algorithm for the prob-
lem that runs in time o∗ 1 403k  
there are also sub-
exponential algorithms for kemeny rank aggregation
under this parameterization  karpinski and schudy  karpin-
ski and schudy  2010  obtained an algorithm for kemeny
rank aggregation that runs in o∗ 2o 
√
k   time  while
the algorithm of fernau et al   fernau et al   2011  fer-
nau et al   2014   based on a different methodology  runs in
o∗ ko 
√
k   time  recently  in  arrighi et al   2020   it was
proceedings of the thirtieth    ijcai-21 
12
 shown that kra on instances with only m = 4 votes on
some candidate set c and some integer k bounding the sum
of the kendall-tau distances to a solution cannot be solved
neither in time o∗ �
2o |c| �
nor in time o∗ �
2o 
√
k �
  un-
less eth fails  the mentioned np-hardness of kra im-
mediately translates to np-hardness results of kra and of
diverse-kra  in the latter case by setting r = 1 and d = 0 
the second parameter we consider is the unanimity width
of the set of votes  which is based on the notion of unanim-
ity order of a set of votes  charon and hudry  2007   the
unanimity width of π is defined as the pathwidth of the co-
comparability graph of ρ 
4
completion of an ordering
in this section  we will introduce the completion of an
ordering problem  a generalization of the positive com-
pletion of an ordering  pco  problem originally con-
sidered in  dujmovic et al   2003  sec  8  and  fernau  2005 
sec  6 4  
problem name  completion of an ordering  co 
given  a partial order ρ ⊆ c × c over a set c  a cost
function c   c × c → n  and some k ∈ n 
output  is there a linear order τ ⊇ ρ with c τ \ ρ  =
�
 x y ∈τ\ρ c x  y  ≤ k 
intuitively  given a partial order ρ and a cost function c 
the goal is to find a linear extension of ρ incurring a cost of
at most k  the only difference between co and the original
pco problem introduced in  dujmovic et al   2003  fernau 
2005  is that  in the latter  for every pair  x  y  ∈ c × c
such that x and y are incomparable in ρ  the cost of  x  y  is
strictly positive  c x  y  > 0  whereas in co  the cost can be
zero  c x  y  = 0  
we note that the notion of kendall-tau diversity introduced
in section 3 can also be used as a notion of diversity for co 
i e   given a set r of  not necessarily optimal  solutions for a
given instance  ρ  c  of co  we let kt-div r  be the diver-
sity of this set 
problem name  diverse completion of an order-
ing  diverse-co 
given  a partial order ρ ⊆ c ×c over a set c  a cost func-
tion c   c × c → n  and non-negative integers k  r  d ∈ n 
output  is there a set r =  τ1          τr  of linear exten-
sions of ρ such that c τi \ ρ  ≤ k for each i ∈  r   and
kt-div r  ≥ d  
next  we give a rather straightforward reduction from
kra to co  given an instance  π  c  of kra with partial
votes π =  π1          πm  and candidates c =  c1          cn  
we construct an instance  ρ  c  of co by letting ρ be the
unanimity order of π  and by defining the cost function
c   c × c → n as follows  for every pair of candidates
 c  c′   we define its cost  c c  c′   as the number of votes that
order c′ before c  more formally  c c  c′  = | i ∈  m  |
c′ <πi c |  with this reduction  it is straightforward to check
that a given linear order π of the candidates has kemeny score
�m
i=1 kt-dist π  πi  = �n
j=1
�n
k=1 c ck  cj  ck <π cj  
here  for a logical proposition p  we use the bracket nota-
tion  p  to denote the integer 1 if p is true the integer 0 if p is
false  in other words  �m
i=1 kt-dist π  πi  is the cost of π
as a linear extension of the ordering ρ 
it is important to note that if all votes in π are linear orders
then  ρ  c  is actually an instance of pco  in other words  if
two candidates c and c′ are incomparable in the unanimity or-
der  then the cost assigned by c to both pairs  c  c′  and  c′  c 
are strictly positive  this property will be used crucially in
the development of our sub-exponential time algorithm for
kra parameterized by cost 
we also note that since our reduction is solution preserving 
it is also immediate that it is diversity preserving  in other
words  r is a set of solutions of diversity d for an instance of
kra if and only if it is also a set of solutions of diversity d
for the corresponding instance of co 
5
diverse co parameterized by pathwidth
in this section  we devise a fixed parameter tractable algo-
rithm for diverse co parameterized by solution imperfec-
tion  number of solutions  scatteredness  and pathwidth of the
cocomparability graph of the input instance  given our re-
duction that preserves solution and parameters from kra to
co introduced in section 4  this algorithm immediately im-
plies that diverse kra is fixed parameter tractable when
parameterized by solution imperfection  number of solutions 
scatteredness  and unanimity width 
we start by defining a suitable notion of consistency be-
tween a path decomposition and a given partial order  let
g =  c  e  be a graph and ρ ⊆ c × c be a partial or-
der on the vertices of g  we say that a path decomposition
d =  b1          bl  is ρ-consistent if there is no pair of ver-
tices  x  y  ∈ ρ such that
max  i ∈  l  | y ∈ bi   < min  i ∈  l  | x ∈ bi   
in other words  if x is smaller than y in ρ  then y cannot be
forgotten in d before x is introduced in d  the ρ-consistent
pathwidth of g  denoted by cpw g  ρ   is the minimum width
of a ρ-consistent path decomposition of g 
it has been shown recently that for any partial order ρ ⊆
c × c  the pathwidth of the cocomparability graph gρ is
equal to the consistent pathwidth of gρ  arrighi et al   2020  
the proof of this result was based on the fact that the consis-
tent pathwidth of a cocomparability graph of a partial order is
equal to the interval width of the order  habib and m¨ohring 
1994   nevertheless  the problem of constructing  or even
approximating  a minimum-width consistent path decompo-
sition in fpt time was left open in  arrighi et al   2020  
by taking a closer look at the theory of cocomparability
graphs  we solve this open problem in a constructive way 
more precisely  in lemma 3 we show that for any partial or-
der ρ  one can construct a ρ-consistent path decomposition
of the cocomparability graph gρ in fixed-parameter tractable
time parameterized by the pathwidth of the graph gρ 
lemma 3  let ρ ⊆ c × c be a partial order and gρ be the
cocomparability graph of ρ  then one can construct a nice ρ-
consistent path decomposition p of gρ of width o pw gρ  
in time 2o pw gρ   · |c| 
let ρ be a partial order and p =  b1  b2          bl  be a
ρ-consistent path decomposition of gρ of width w  for each
proceedings of the thirtieth    ijcai-21 
13
 p ∈  l   let pp be the set of pairs of the form  s  τ  where
s is a subset of bp that contains vertices introduced by bp
 intro p  ⊆ s ⊆ bp   τ ⊇ ρ|s is a linear extension of the
restriction ρ|s ˙= s × s ∩ ρ of ρ to s 
definition 4  let p ∈  l   δ ∈ n  and f   pp → n  then 
we let tp f  δ  be the set of all triples of the form  s  τ  γ  
where  s  τ  ∈ pp and f s  τ  ≤ γ ≤ f s  τ    δ 
intuitively  the function f will be used by our dynamic pro-
gramming algorithm to record the optimal values of partial
solutions at each bag bp when processing the path decompo-
sition from left to right  see theorem 8 and theorem 10  and
δ will be the allowed solution imperfection  in the case of a
unique solution  this value will be 0 but this parameter will
be useful in the diverse case as we allow sub-optimal linear
extensions  a partial solution up to the p-th bag is a linear
order σ of �
j≤p bj  vertices that will be introduced in fu-
ture bags can be inserted in σ  to extend it  only after vertices
already forgotten in the p-th bag  if u will be introduced in
a future bag and v is in some bj but not in bp  then by con-
sistency of the path decomposition with respect to ρ  we have
v <ρ u  therefore  in bp  we only need to remember the
 last  part of σ  which are the vertices that are in bp and after
all forgotten vertices in σ 
remark 5  for each p ∈  l   f   pp → n and δ ∈ n  the size
of tp f  δ  is bounded by e ·  δ   1  ·  w  1   
for each p ∈  l − 1   f   pp → n and δ ∈ n  we say
that a triple  s  τ  γ  ∈ tp f  δ  is compatible with a triple
 s′  τ ′  γ′  ∈ tp 1 f  δ  if the following conditions hold 
c1 let v = maxτ s ∩ forg p   1   be the maximum vertex
of s forgotten by bp 1 according to the linear order τ 
then  we have the following equality s′ = intro p 1 ∪
 u ∈ s | v <τ u   this means that one can build s′
from s by removing all vertices that are either forgotten
by bp 1 or smaller than some vertex forgotten by bp 1 
and subsequently  by adding all vertices that have been
introduced by bp 1 
c2 τ|s∩s′ = τ ′|s∩s′  i e   τ and τ ′ agree on s ∩ s′ 
c3 γ′
=
γ   �
v∈intro p 1  �
u∈s′ u<τ′v c u  v   
�
u∈s∩s′ v<τ′u c v  u    �
u∈bp 1\s′ c u  v   
to
compute γ′  we add to γ the cost of adding the intro-
duced vertices in the order  the first two terms com-
pute the cost of each new vertex in τ ′ and the last one
computes the cost of placing the new vertices after all
vertices in bp 1 \ s′ 
a compatible sequence for p is a sequence of triples
γ =  s1  τ1  γ1         sl  τl  γl  such that for each p ∈  l  
 sp  τp  γp  is compatible with  sp−1  τp−1  γp−1  
our interest in compatible sequences stems from the two
following lemmas 
lemma 6  let ρ ⊆ c × c be a partial order over c 
c   c × c → n be a cost function  and p be a ρ-consistent
path decomposition of the graph gρ  let γ = t1       tl =
 s1  τ1  γ1         sl  τl  γl  be a compatible sequence for p 
then  the linear order π = tc ρ ∪ τ1 ∪ · · · ∪ τl  is a lin-
ear extension of ρ of cost γl 
lemma 7  let ρ ⊆ c × c be a partial order over c 
c   c × c → n be a cost function  and p be a ρ-consistent
path decomposition of the graph gρ  let π be a linear exten-
sion of ρ  and γ =  s1  τ1  γ1         sl  τl  γl  be a sequence
such that for each position p ∈  l   sp =  v ∈ bp | v >π
maxπ lp    τp = π|sp  and γp = c π|lp∪bp   then  γ is a
compatible sequence for p 
lemma 6 and lemma 7 immediately yield an fpt dy-
namic programming algorithm for computing a linear exten-
sion of ρ  to define the algorithm more precisely  we first
need to define the set of functions fp that we will use to de-
fine a set of triples with tp  for each p ∈  l   we define
fp   pp → n as follows  for each  s  τ  ∈ pp  we let γ be
the minimum cost of a partial solution π up to bag p such that
s =  v ∈ bp | v >π maxπ lp   and τ = π|sp  then we let
fp s  τ  = γ  intuitively  fp associates to each linear order τ
the cost of an optimal partial solution  ending  by τ  now 
we will describe the algorithm  we process the path decom-
position from left to right in l time steps  where at each time
step p  we construct the value of fp that we need and a subset
qp ⊆ tp fp  0  of promising triples  which are  intuitively 
triples that have a potential to lead to an optimal solution  at
time step 1  set q1 =   b1  τ  c τ   τ is a linear extension of ρ|b1  
at each time step p ≥ 2  qp is the set of all triples in tp fp  0 
that are compatible with some triple in qp−1  at the end of
the process  assuming that qp is non-empty for each p ∈  l  
we can reconstruct a compatible sequence by backtracking 
first  by selecting an arbitrary triple tl in ql  then by se-
lecting an arbitrary triple tl−1 in ql−1 compatible with tl 
and so on  once we have constructed a compatible sequence
t1       tl  we can extract a linear extension π of cost γl by set-
ting π = tc ρ ∪ τ1 ∪       τl   this description gives rise to the
following theorem 
theorem 8  let ρ ⊆ c × c  let n = |c|  let w be the
pathwidth of the cocomparability graph of ρ  and c   c×c →
 m 0 be a cost function  then  one can compute an optimal
solution in time o
�
w o 1  · n · log n · m 
�
 
now  leveraging on lemma 6 and lemma 7  we will
devise a fixed-parameter tractable algorithm for diverse-
co parameterized by solution imperfection  number of so-
lutions  scatteredness  and pathwidth of the cocomparability
graph of the input partial order  let ρ be a partial order and
p =  b1  b2          bl  be a ρ-consistent path decomposition
of gρ of width w 
definition 9  let p ∈  l   and f   pp → n  then  we let
ip f  δ  be the set of all tuples of the form
  s1  τ 1  γ1            sr  τ r  γr   ∂   ξ i j  1≤i<j≤r 
where ∂ ∈  d   1 0  for each 1 ≤ i < j ≤ r  ξ i j  ∈  s 0 
and for each i ∈  r    si  τ i  γi  is a triple in tp f  δ  
intuitively    si  τ i  γi  i∈ r  are r partial linear exten-
sions  ∂ will be the diversity of the r partial linear extensions
and ξ will be the distance between all pairs of the r partial
linear extensions  a diversity-compatible sequence is a se-
quence of the form
   s1
p  τ 1
p   γ1
p            sr
p  τ r
p  γr
p   ∂p   ξp
 i j  
1≤i<j≤r  
p∈ l  
proceedings of the thirtieth    ijcai-21 
14
 where for each i ∈  r    si
1  τ i
1  γi
1         si
l  τ i
l   γi
l  is a com-
patible sequence and for each p ∈  l − 1   ∂p keeps track of
the amount of diversity observed up to position p  ξp
 i j  keeps
track of the distance between partial solutions i and j 
a diversity-compatible sequence is a representation of r
solutions for an instance  ρ  c  r  δ  d  s  of diverse-co  in-
tuitively  computing such a sequence corresponds to com-
puting r compatible sequences in parallel  by processing the
given path decomposition from left to right  while using an
additional register to keep track of the overall diversity at each
time step and all the pairwise distances 
theorem 10  let ρ ⊆ c × c  let n = |c| and w be the
pathwidth of the cocomparability graph of ρ  and c   c×c →
 m 0 be a cost function  then  one can determine whether ρ
admits r linear extensions π1          πr at distance at most δ
from the optimum  diversity at least d  and scatteredness at
least s in time o
�
 w  · δ o r  · sr2 · d · n · log n2 · m 
�
 
by combining theorem 8 with our reduction from kra
to co  we have an fpt algorithm for kra  parameterized
by solution imperfection  number of solutions  scatteredness 
and unanimity width  corollary 11  
corollary 11  let π be a list of m partial votes over a set
of n candidates c 
let w be the unanimity width of π 
given π and non-negative integers δ  r  s and d  one can
determine in time o
�
 w  · δ o r  · sr2 · d · n · log n2 · m 
�
whether there is a set r =  π1          πr  of r linear or-
ders on c such that the kemeny score for each order πi
is at distance at most δ of the optimum  and we find that
kt-div r  ≥ d and that scatteredness is at least s 
6
sub-exponential time algorithm for pco
for special cases of pco  such as those arising from kra or
the graph-drawing problem oscm  single-exponential sub-
exponential time algorithms have been known  i e   algo-
rithms with running times of the form o∗ 2o 
√
k    in con-
trast  for the more general problem of pco  only algorithms
with running time o∗ k
√
k  were known before  where k is
the cost parameter  fernau et al   2014  
here  we prove
that pco also admits algorithms of the form o∗ 2o 
√
k    by
making use of several structural insights for cocomparability
graphs  more precisely  we prove the following theorem 
theorem 12  given a partial order ρ ⊆ c × c and a cost
function c   c × c → n  one can solve a pco instance
 ρ  c  k  in time |c| · 2o 
√
k    o |c|2 · log k   
our main technical result of this section is the following 
lemma 13  let g be a c≥5-free graph  let m be the number
of edges of g  then  we have m = ω tw g 2  
by combining lemma 13 with the fact that treewidth
equals pathwidth for cocomparability graphs and with the fact
that cocomparability graphs are c≥5-free  we get the follow-
ing lemma 
lemma 14  let g be a cocomparability graph and let m be
the number of edges of g  then  m = ω pw g 2  
now  in a pco instance  each edge contributes at least 1
to the cost of any solution  therefore  if a solution has cost
at most k  then the cocomparability graph of the input partial
order can have at most k edges  therefore  this observation 
together with lemma 14 yields the following lemma 
lemma 15  let  ρ  c  k  be an yes-instance of pco  then 
pw gρ  = o 
√
k  
to get the running time of theorem 12  we need to either
compute a ρ-consistent path decomposition of width at most
o 
√
k   or to trigger an early rejection  for this  we will use
the following lemma which is based on lemma 3 
lemma 16  there is a polynomial-time algorithm that takes
an instance of  ρ  c  k  of pco as input  and either constructs
a ρ-consistent path decomposition of the graph gρ of width
o 
√
k   or answers that this instance is a no-instance 
in section 5  in order to define our algorithm for diverse-
co  we first devised a simpler algorithm for the single-
solution version of co  that could be used as a building block
for the diverse algorithm  it turns out that if our only goal is to
solve the single-solution version of co  then the basic algo-
rithm developed in section 5 can be optimized  to become a
single-exponential time algorithm parameterized by the path-
width of the cocomparability graph of the input order  more
precisely  we have the following lemma 
lemma 17   arrighi et al   2020   theorem 1    given an
instance  ρ  c  k  of co and a ρ-consistent path decomposi-
tion p of the graph gρ  one can solve this instance in time
|c| · 2o pw gρ   · log k    o |c|2 · log k   
now we are ready to prove the statement of theorem 12 
given an instance  ρ  c  k  of pco  we apply the algorithm
stated in lemma 16  this algorithm either determines that
the instance is a no-instance  or constructs a ρ-consistent
path decomposition p of gρ of width o 
√
k   in the first
case  we are done and simply answer no  otherwise  we
give both the instance  ρ  c  k  and the decomposition p
to the algorithm stated in lemma 17 to determine in time
|c| · 2o 
√
k    o |c|2 · log k   whether  ρ  c  k  is a yes-
or a no-instance of pco  in case this is a yes-instance  the
algorithm also constructs a linear extension of ρ of cost at
most k  this concludes the proof of theorem 12 
acknowledgements
emmanuel arrighi acknowledges support from the research
council of norway  grant no  274526  and from is-daad
 grant no  309319    henning fernau acknowledges sup-
port from daad ppp  grant no  57525246    the research
of daniel lokshtanov is supported by bsf award 2018302
and nsf award ccf-2008838  mateus de oliveira oliveira
acknowledges support from the research council of nor-
way  grant no  288761   is-daad  grant no  309319  and
sigma2 network  nn9535k   petra wolf acknowledges sup-
port from dfg project fe 560/9-1 and daad ppp  grant
no  57525246  
proceedings of the thirtieth    ijcai-21 
15
 references
 arrighi et al   2020  e 
arrighi 
h 
fernau 
m  de oliveira oliveira  and p  wolf 
width notions
for ordering-related problems  in fsttcs  volume 182 of
lipics  pages 9 1–9 18  schloss dagstuhl  2020 
 bartholdi et al   1989  j  bartholdi  iii  c  a  tovey  and
m  a  trick  voting schemes for which it can be difficult
to tell who won the election  social choice and welfare 
6 157–165  1989 
 baste et al   2019  j  baste  l  jaffke  t  masaˇr ık  g  philip 
and g  rote  fpt algorithms for diverse collections of
hitting sets  algorithms  12 254  2019 
 baste et al   2020  j 
baste 
m 
fellows 
l 
jaffke 
t  masar ık  m  de oliveira oliveira  g  philip  and
f  rosamond 
diversity of solutions  an exploration
through the lens of fixed-parameter tractability theory  in
ijcai  pages 1119–1125  2020 
 bouchitt e et al   2004  v  bouchitt e  d  kratsch  h  m¨uller 
and i  todinca  on treewidth approximations  discret 
appl  math   136 2-3  183–196  2004 
 bredereck et al   2020  r  bredereck  a  kaczmarczyk  and
r  niedermeier  electing successive committees  com-
plexity and algorithms  in aaai  pages 1846–1853  aaai
press  2020 
 charon and hudry  2007  i  charon and o  hudry  a survey
on the linear ordering problem for weighted or unweighted
tournaments  4or  5 1  5–60  2007 
 chudnovsky et al   2020  m  chudnovsky  m  pilipczuk 
m  pilipczuk  and s  thomass e  quasi-polynomial time
approximation schemes for the maximum weight indepen-
dent set problem in h-free graphs  in soda  pages 2260–
2278  siam  2020 
 downey and fellows  1999  r  downey and m  fellows 
parameterized complexity  springer  1999 
 dujmovic et al   2003  v 
dujmovic 
h 
fernau 
and
m  kaufmann  fixed parameter algorithms for one-sided
crossing minimization revisited 
in gd  volume 2912 
pages 332–344  springer  2003 
 dwork et al   2001  c  dwork  r  kumar  m  naor  and
d  sivakumar  rank aggregation methods for the web  in
www  pages 613–622  acm  2001 
 farkas and timotity  2019  m  farkas and d  timotity  vot-
ing issues 
a brief history of preference aggregation 
worldquant  pages 26 1–7  november 2019 
 fernau et al   2011  h  fernau  f  fomin  d  lokshtanov 
m  mnich  g  philip  and s  saurabh  ranking and draw-
ing in subexponential time 
in iwoca  volume 6460 
pages 337–348  springer  2011 
 fernau et al   2014  h  fernau  f  fomin  d  lokshtanov 
m  mnich  g  philip  and s  saurabh  social choice meets
graph drawing  how to get subexponential time algo-
rithms for ranking and drawing problems  tsinghua sci-
ence and technology  19 4  374–386  2014 
 fernau  2005  h  fernau  parameterized algorithmics  a
graph-theoretic approach  habilitationsschrift  univer-
sit¨at t¨ubingen  germany  2005 
 fomin et al   2020  f  fomin 
p  golovach 
l  jaffke 
g  philip  and d  sagunov  diverse pairs of matchings 
in isaac  schloss dagstuhl  2020 
 galle  1989  p  galle  branch   sample  a simple strategy
for constraint satisfaction  bit  29 3  395–408  1989 
 habib and m¨ohring  1994  m  habib and r  m¨ohring 
treewidth of cocomparability graphs and a new order-
theoretic parameter  order  11 1  47–60  1994 
 ingmar et al   2020  l  ingmar  m  de la banda  p  stuckey 
and g  tack  modelling diversity of solutions  in aaai 
volume 34  pages 1528–1535  aaai press  2020 
 karpinski and schudy  2010  m  karpinski and w  schudy 
faster algorithms for feedback arc set tournament  ke-
meny rank aggregation and betweenness tournament  in
isaac  volume 6506  pages 3–14  springer  2010 
 kemeny  1959  j  kemeny  mathematics without numbers 
daedalus  88 571–591  1959 
 petit and trapp  2019  t  petit and a  trapp  enriching so-
lutions to combinatorial problems via solution engineer-
ing 
informs journal on computing  31 3  429–444 
2019 
 simjour  2009  n  simjour  improved parameterized algo-
rithms for the kemeny aggregation problem  in iwpec 
volume 5917  pages 312–323  springer  2009 
 wong and reingold  1991  d  wong and e  reingold 
probabilistic analysis of a grouping algorithm  algorith-
mica  6 2  192–206  1991 
proceedings of the thirtieth    ijcai-21 
16
 "
None,2021,0002,School Choice with Flexible Diversity Goals and Specialized Seats,"Haris Aziz, Zhaohong Sun",abstract comes here,https://www.ijcai.org/proceedings/2021/0003.pdf,data/fulltext/pdf/2021/0002.pdf,../vikus-viewer/data/fulltext/pdf/2021/0002.pdf,"school choice with flexible diversity goals and specialized seats
haris aziz   zhaohong sun
unsw sydney
 haris aziz  zhaohong sun @unsw edu au
abstract
we present a new and rich model of school choice
with flexible diversity goals and specialized seats 
the model also applies to other settings such as
public housing allocation with diversity objectives 
our method of expressing flexible diversity goals
is also applicable to other settings in moral multi-
agent decision making where competing policies
need to be balanced when allocating scarce re-
sources 
for our matching model  we present a
polynomial-time algorithm that satisfies desirable
properties  including strategyproofness and stabil-
ity under several natural subdomains of our prob-
lem  we complement the results by providing a
clear understanding about what results do not ex-
tend when considering the general model 
1
introduction
diversity goals are prevalent in many scenarios including the
hiring of employees  student-intake  and public housing  ben-
abbou et al   2018   these may be affirmative action legal re-
quirements  institutional policies  or guidelines for ensuring
a healthier and better balance of various groups  as impor-
tant decisions are made concerning who gets the next job or
who gets their preferred school seat  it is critical that the al-
gorithms are transparent and fair  this is especially so when
they make complex decisions that simultaneously take into
account merit  priority  and diversity 
in the past few years  diversity issues have been heav-
ily studied in school choice  abdulkadiro˘glu and s¨onmez 
2003   the prototypical model of two-sided matching  in the
basic school choice problem  students have preferences over
schools and schools have priorities over students  the typical
goal is to match the students to schools in a way that is stable
 no student wants to take an vacant slot or wants to replace a
lower priority student   another property that is important in
this context is strategyproofness  no student has an incentive
to misreport her preferences  
in school choice with diversity goals  schools accept stu-
dents while not just taking into account the priority order-
ing over students  that could be based on test scores  but
also considering diversity requirements  such as keeping in
mind a target number of students with special talents or dis-
advantaged backgrounds   student placement under diver-
sity concerns has been considered in many countries includ-
ing israel  gonczarowski et al   2019  and india  baswana
et al   2019  
a prominent and successful approach for
these problems is to specify diversity requirements via up-
per and lower bounds on the types of students at the school
 ehlers et al   2014  aziz et al   2019   based on these quo-
tas  diversity is achieved by first admitting students whose
types have not reached the minimum quotas and then ad-
mitting students whose types have not reached the maxi-
mum quotas  see e g    kurata et al   2017  aziz et al   2020 
sun  2020   
there are limitations of specifying diversity goals just by
imposing upper and lower bounds on types  the first concern
is whether one should indeed treat the status of being under-
subscribed equally  for instance  suppose one school imposes
minimum quota 10 on two types  type t1 admits just 1 stu-
dent while type t2 admits 8 students  it is reasonable to give
higher precedence to students of type t1  who will help to
achieve a diversity balance  the second concern is whether
we should treat all types equally  it is common that some
types are more important than others  thirdly  lower and up-
per quotas are not sufficient to target proportionality ratios of
types  that captures desirable distributions of different types
of students   in particular  having targets on absolute numbers
does not achieve proportionality goals effectively 
we explain the third issue through the following example 
suppose there is a market where students are associated with
one of the three types t1  t2  and t3  consider one school c
with capacity 100 that has the target proportions of students
are as follows  t1   30   t2   30   t3   40   if we wish to
capture these targets via setting of lower bounds  one can im-
pose minimum quotas 30  30 and 40 on type t1  t2  t3 respec-
tively  suppose 15  60  and 60 students of type t1  t2  t3 apply
for the school c  then notable algorithms for the problem that
use minimum quotas would return an outcome with type dis-
tribution  t1   15  t2   45  t3   40   however  there exists an
outcome with type distribution  t1   15  t2   37  t3   48  that
is closer to the target proportions  such an outcome will be
computed by the algorithm we propose 
in this paper  we aim to address the following questions 
what is a powerful yet computationally tractable framework
of specifying diversity goals  that encompasses most of the
proceedings of the thirtieth    ijcai-21 
17
 particular diversity approaches in theory and practice  can
it also capture meaningful and well-motivated diversity goals
not yet addressed in the literature  can we use such a frame-
work and achieve desirable objectives in two-sided matching
market design such as stability and strategyproofness in a ro-
bust manner  what are the limits of such an approach when
students are allowed to express preferences over individual
school seats 
1 1
contributions
we present a new model of matching markets that general-
izes school choice with diversity goals in two important ways 
 1  firstly  we allow schools to have specialized seats that
are motivated by additional features such as accompanying
scholarships  tuition-fee waiver etc   2  secondly  we greatly
expand the type of diversity goals that can be specified  our
model introduces a flexible and general ordinal approach to
specifying diversity goals that capture lower and upper quotas
as well as proportionality concerns  we discuss how existing
approaches that only minimum and maximum quotas in the
intended ratios may not achieve outcomes that are closest to
the intended ratios  the approach applies to many other set-
tings including social choice and multi-agent decision mak-
ing in which diversity is a concern 
for the new model  we present an algorithm called gen-
eralized deferred acceptance with flexible diversity  gda-
fd   it is a novel algorithm that we design for schools to
choose students while taking into account flexible diversity
goals  gda-fd satisfies a natural notion of stability  strate-
gyproofness  and non-wastefulness when each agent has one
type and there are no specialized seats 
we then show that allowing for specialized seats but en-
forcing diversity over students leads to several challenges in
achieving stability and strategyproofness  in view of these
challenges  we then turn to an important domain in which we
allow for specialized seats but there is exactly one school 1
in this domain  we show that even if students have overlap-
ping types  gda-fd algorithm satisfies weak pareto optimal-
ity and two notions of strategyproofness  en route to proving
these results  we provide an alternative view of gda-fd by
showing its equivalence with an algorithm called sequential
allocation under dynamic diversity goals 
finally  we turn to a class of preferences called school-
based that generalizes the case of homogenous school seats
as well as the case of exactly one school  for school-based
preferences  we show that gda-fd is not strategyproof even
if each agent has a single type  however  strategyproofness
is regained by using another algorithm called modified gda-
fd that calls gda-fd on a modification of the problem in-
stance  since modified gda-fd is equivalent to gda-fd
when there are no special seats  our key message is that the
modified gda-fd works well on several important domains 
some of our results are summarized in table 1 
1the domain captures various committee selecting or hiring sce-
narios that take into account diversity goals 
preference
strategyproofness
stability
non-wastefulness
domain
no specialized seats



one school



school-based



table 1  properties satisfied by modified gda-fd  algorithm 4 
under different preference domains when each agent has a single
type  the positive results for the case of one school also hold for
multiple types 
2
related work
abdulkadiro˘glu and s¨onmez  2003  presented one of the
seminal works on the use of matching market design for
school choice  the problem of school choice with diversity
constraints or goals is an active area of research in market
design  in some of the earlier works  echenique and yen-
mez  2015  abdulkadiro˘glu and s¨onmez  2003  ehlers et al  
2014   it is assumed that each agent has at most one type 
recent papers have started exploring the case of  overlap-
ping types   e g    kurata et al   2017  aziz et al   2019 
ayg¨un and turhan  2020  gonczarowski et al   2019   
typically  each school imposes a maximum quota and
a minimum quota on each type
 ehlers et al   2014 
gonczarowski et al   2019  hafalir et al   2013  kojima  2012 
kominers and s¨onmez  2013  s¨onmez and yenmez  2019 
baswana et al   2019  aziz et al   2019   since stable match-
ings are not guaranteed to exist for hard lower quotas  and
the corresponding problems are np-hard  kurata et al   2017 
cheng et al   2008   most of the successful approaches treat
the quotas as soft  see  e g  ehlers et al   2014  and followup
works   we also adopt the approach of treating the quotas as
soft 
most work on school choice with diversity goals focuses
on minimum and maximum quotas  although there is some
recent work on ratio constraints  nguyen and vohra  2019  
our diversity goals are more general and flexible  and our
algorithmic solutions are different as well 
kominers and
s¨onmez  2016  considered a matching model in which each
school seat may have a different priority ordering over stu-
dents and students have rankings over schools 
we assume that when students are matched  they contribute
to the counts of all the types they satisfy  in a companion
paper  aziz and sun  2021   we take an alternative assump-
tion that students contribute to the count of exactly one of the
types they satisfy 
3
a model for school choice with flexible
diversity goals and specialized seats
in this section  we formalize the model of school choice with
flexible diversity goals and specialized seats  an instance
i of the setting consists of a tuple  s  t  h  c  x   ≿s  ≿c
  rc   there is a set of students denoted by s =  1          n  
each of whom belongs to some of the types from the type
space t =  t1          tk   let t i  denote the set of types
of student i  we will denote by c the set of schools with a
generic school denoted by bj or b  we will denote by h the
proceedings of the thirtieth    ijcai-21 
18
 set of school seats with a genertic seat denoted by h  school
seats h are partitioned into |c| schools  where bj ⊆ h is
the set of school seats controlled by school bj ∈ c  for
any two different schools bi  bj ∈ c  we have bi ∩ bj = ∅ 
the symbol rc denotes the precedence profile of schools that
captures flexible diversity goals  section 4 is devoted to the
precedence profile rc 
we follow the model of matching with contracts  hatfield
and milgrom  2005  where each contract x =  i  h  b  is a
student–seat–school tuple indicating that student i is matched
to seat h at school b  the set of all contracts is denoted by
x ⊆ s × h × c and we assume that for any  i  h  b  ∈ x  
we have h ∈ b  given any x ⊆ x   for each student i 
we denote by xi as the set of contracts pertaining to student
i  for each seat h  we denote by xh as the set of contracts
pertaining to seat h  for each school b  we denote by xb as the
set of contracts pertaining to school b  we denote by xt
b =
  i  h  b  ∈ xb | t ∈ t i   as the set of contracts involving
students of type t and school b  we extend the notation of
each individual to a set of agents by taking the union  i e   for
any s′ ⊆ s  xs′ = �
i∈s′ xi 
the preference profile of students s is denoted by ≿s=
 ≿1          ≿n  where for student i ∈ s  each ≿i specifies
the preference of student i over contracts xi  for instance 
 i  h1  b1  ≿i  i  h2  b2  means that student i weakly prefers
the contract  i  h1  b1  to the contract  i  h2  b2   let ≻i and
∼i denote the strict and indifferent relation  respectively  in
section 5 2  we will assume that a student is indifferent be-
tween all contracts involving seats of the same school  in
general  if some algorithm of ours requires strict preferences 
we will assume that the ties are broken according to a fixed
tie-breaking rule 
the priority profile of schools c is denoted by ≿c=  ≿b1
          ≿b|c|  where each ≿b specifies the priority ordering of
school b over contracts xb  we will assume that a school s
priority over contracts is based on an underlying priority re-
lation over students  which could be based on first-come first-
served basis  entrance exam scores or randomization 
next  we introduce several important properties for a de-
sirable outcome  a contract  i  h  b  is acceptable to student
i and school b if both  i  h  b  ≿i ∅ and  i  h  b  ≿b ∅ hold
where ∅ represents the option of being unmatched  with-
out loss of generality  we consider acceptable contracts only 
since we can remove any unacceptable contract from x   an
outcome or a matching x is a set of contracts  i e  x ⊆ x  
an outcome is feasible if each student is matched to at most
one contract  i e  ∀i ∈ s  |xi| ≤ 1  and each seat is matched
to at most one student  i e  ∀ h ∈ h  |xh| ≤ 1  a feasible
outcome y is non-wasteful if there exists no  i  h′  b′  ∈ y
such that there exists another contract  i  h  b  with  i  h  b 
≻i  i  h′  b′  and y ∪   i  h  b   \   i  h′  b′   is feasible 
given an instance i  an algorithm is strategyproof for stu-
dents if no student can be matched to a strictly better contract
when the student misreports his preferences 
4
framework for flexible diversity goals
in this section  we present a novel way for schools to select
students  a key component of the method is to design a novel
method to specify dynamic priorities of a school over stu-
dents  the dynamic priorities of a school b are based on the
static priority relation ≿b over students  and a dynamic prece-
dence relation rb over the types in t that we specify below 
given a feasible outcome x  each school b has a dynamic
precedence ordering rb x  over types t 
if t1rb x t2
holds  then for the outcome x  type t1 is weakly preferred to
type t2 in terms of achieving diversity goals of school b  let
pb and ib denote the strict and indifferent relation  respec-
tively  we denote by rc =  rb1         rb|c|  the precedence
profile of all schools 
4 1
dynamic precedence representation
next  we explain how we represent the dynamic precedence
rb over types  first  each school b specifies different levels
over each type t  denoted by lb t where each level ℓj
b t ∈ lb t
specifies the range of number of students of type t that are
matched to school b  for instance  in figure 1  ℓ1
b t =  0  10 
means that when the number of students of type t matched to
school b is weakly larger than 0 and smaller than 10  then it
falls into the level ℓ1
b t  we refer to lj
b =  ℓj
b t t∈t as level j
of school b for convenience  note that for each type t  it is not
necessary to define levels for every integer from  1       |s|  
0
10
25
· · ·
80
100
ℓ1
b t
ℓ2
b t
ℓ10
b t
figure 1  an instance of levels of type t at school b 
then the dynamic precedence ordering rb x  is deter-
mined as follows with indifference classes in decreasing order
of precedence from left to right  rb x     t ∈ t   |xt
b| ∈
ℓ1
b t    t ∈ t   |xt
b| ∈ ℓ2
b t            t ∈ t   |xt
b| ∈ ℓk
b t  
where |xt
b| denotes the number of students of type t matched
to school b in the outcome x  intuitively  for a given out-
come x  school b gives the highest precedence to types that
fall into level 1 of school b  the second highest precedence to
types that fall into level 2 of school b and so on 
next  we explain how to capture different diversity goals
through the dynamic precedence relation rb x  
lexicographic 
let there be a fixed precedence ordering
over types  say t1          t|t |  the lexicographic diversity goal
of school b is that whenever possible  it prefers to be matched
to students of type t with smaller index  in that case  for each
type ti  create one level ℓi
b ti =  0  |s|  
min and maximum quotas 
for each school b  let ηt
b and
ηt
b denote the minimum quota and the maximum quota of type
t  respectively  the diversity goal of school b under minimum
and maximum quotas is that  school b gives the highest prece-
dence to the student whose type has not reached the minimum
quota  medium precedence to the student whose type has
reached the minimum quota but not the maximum quota  and
the lowest precedence to the student whose type has reached
the maximum quota  ehlers et al   2014   in that case  for
proceedings of the thirtieth    ijcai-21 
19
 each type t  school b has three levels ℓ1
b t =  0  ηt
b − 1  
ℓ2
b t =  ηt
b  ηt
b − 1  and ℓ3
b t =  ηt
b  |s|  
proportional 
let there be |t| positive integers  say r1 
· · ·   r|t | corresponding to each type t  the proportional di-
versity goal of school b is that the number of students of each
type matched to school b is proportional to r1   · · ·   r|t | 
in that case  each school b has multiple levels over each type
t and leve number j  ℓj
b t =   j − 1  ∗ rt  j ∗ rt − 1   for
example  ℓ1
b t =  0  rt − 1  and ℓ2
b t =  rt  2rt − 1  
egalitarian 
egalitarian is a special case of proportionality
where the ratio among all types is 1  in that case  each school
b has multiple levels over each type t where each level ℓj
b t =
 j − 1  j − 1  
our diversity framework can also capture combinations of
the above objectives  next  we give an example of how our
approach can capture proportionality goals 
example 1  proportional diversity goals   consider a
school b and a set of types t =  t1  t2  t3  t4  with desired ra-
tios 1  2  3  2  then rb is depicted graphically in figure 2 
based on a current allocation of a school  each type has its
own count of how many admitted students satisfy that type 
which types have the highest precedence for the school de-
pends on current level of the types based on their counts  sup-
pose that the current allocation leads to the following counts
t1   0  t2   1  t3   4  and t4   7  then  then precedence level
of the types are as follows  t1   1  t2   1  t3   2  and t4   4 
hence  t1 and t2 are the highest precedence types 
t1
t2
t3
t4
0
5
10
4
8
12
8
3
6
9
6
2
4
6
4
1
2
3
2
# of students of type t matched to school b
level1
level2
level3
level4
figure 2  proportional goals in example 1 
4 2
choice function for flexible diversity goals
for a given school b  its priority relation ≿b over the students
along with its precedence relation rb over types can guide
the school to select students from applicants  we specify a
particular choice function for the schools 
we define a natural choice function of school b that chooses
a set of contracts in algorithm 1  the high level idea is that
it identifies the types whose precedence is most important
 based on which students are already selected  and then se-
lects the highest priority contract that involves a student who
algorithm 1 choice function chb of school b
input  a set of contracts yb  rb  and ≿b
output  a set of contracts z ⊆ yb
1  remove unacceptable contracts from yb 
2  z ← ∅
  z stores the set of contracts chosen by school b 
3  while yb ̸= ∅ and |z| is no more than school capacity do
4 
identify the set of types t ′ such that i  each type t ∈ t ′ has
the highest precedence based on rb z  and ii  there exists
some contract y =  i  h  b  ∈ yb with t i  ∩ t ′ ̸= ∅ 
5 
scan over yb based on priority ordering ≻b and select the
first contract y =  i  h  b  such that t i  ∩ t ′ ̸= ∅ 
6 
z ← z ∪  y   yb ← yb \  y  
7 
remove all contracts from yb that involve i or h 
8  return z
satisfies one of the types  the process is repeated until the
school capacity is reached or all students are selected 
next  we explain algorithm 1 in more detail  given a set
of contracts yb that pertain to school b  a priority ordering ≿b
over contracts and a precedence ordering rb over types  the
choice function chb works as follows  in the beginning  we
remove all unacceptable contracts from yb and initialize the
set z to be empty which is used to store the set of contracts
selected by school b  next  we repeat the following procedure
until the set of contracts yb becomes empty or the school ca-
pacity is reached  first  we identify the set of types t ′ such
that i  each type t ∈ t ′ has the highest precedence based on
rb z   and ii  there exists some contract x =  i  h  b  from
yb in which student i has some type from t ′  then  we scan
over the set of contracts yb based on the priority ordering
≻b of school b and select the first contract  i  h  b  such that
student i has one of the highest precedence types  finally  we
update z and y accordingly and remove any contract y′ from
yb that is associated with either student i or seat h 
note that our new choice function  algorithm 1  is a gen-
eralization of the one by ehlers et al   2014   and it is de-
signed for more general diversity goals instead of minimum
and maximum quotas only  it is also well-defined for students
having overlapping types  algorithm 1 can also easily incor-
porate hard upper bounds for each type  all of our results go
through with these hard upper bounds 
5
stable matching under flexible diversity
goals
in this section  we propose a two-sided matching algorithm
that deals with general diversity goals 
5 1
generalized deferred acceptance with
flexible diversity
the algorithm is well-defined whether students have strict
preferences over all the school seats or whether they are in-
different between all the school seats of the same school  it is
also well-defined even if students have multiple types 
given a set of contracts x  let chi x  denote the choice
function of student i that selects her favorite contract among
xi  let chb x  denote the choice function of school b that
selects a set of contracts among xb  which is not necessar-
ily unique  let chs x  = �
i∈s chi x  and chc x  =
proceedings of the thirtieth    ijcai-21 
20
 algorithm 2 generalized deferred acceptance  gda 
input  instance i  chs  chc  a set of contracts y
output  an outcome z ⊆ y
1  re ← ∅  x ← y  z ← ∅
2  while x ̸= z do
3 
x ← chs y \ re 
  students select contracts 
4 
z ← chc x 
  schools select contracts 
5 
re ← re ∪  x \ z 
  update rejected contracts 
6  return z
�
b∈c chb x  denote the choice functions of students s and
schools c  respectively 
armed with our specified choice function for schools  al-
gorithm 1    we consider the framework of the generalized
deferred acceptance  gda  by hatfield and milgrom  2005 
that works as follows  student first choose their favorite con-
tract from the set y   among all contracts proposed by stu-
dents  each school then chooses a set of contracts  all con-
tracts that are not selected by any school are removed from
the set y   the algorithm repeats these steps until no contract
is removed 
we will refer to the gda algorithm with the choice func-
tion defined in algorithm 1 as generalized deferred accep-
tance with flexible diversity  gda-fd  
here is an example illustrating how gda-fd works 
example 2  there are 4 students s =  1          4  where stu-
dents  1  2  3  belong to type t1 and student 4 belongs to type
t2  suppose there is one school b that has 3 school seats
h =  h1  h2  h3   a priority list 1  2  3  4 and precedence
relation that requires proportionality ratio of 2  1 between t1
and t2  the preference profile of students are as follows  h1
≻1 h2 ≻1 h3  h2 ≻2 h3 ≻2 h1  h3 ≻3 h2 ≻3 h1  h3 ≻4 h1
≻4 h2  we abuse the notation of preferences and contracts 
since there is only one school b  in the first round  students
propose  1  h1    2  h2    3  h3    4  h3  and school b chooses
 1  h1    2  h2    4  h3   in the second round  students pro-
pose  1  h1    2  h2    3  h2    4  h3  and school b chooses
 1  h1    2  h2    4  h3   in the final round  students propose
 1  h1    2  h2    3  h1    4  h3  and school b chooses  1  h1  
 2  h2   and  4  h3  
theorem 1  the gda-fd algorithm runs in polynomial-
time and returns a feasible outcome that is non-wasteful  even
if each student has multiple types 
next  we propose a stability concept for the setting of
school choice with flexible diversity goals and specialized
seats by taking the dynamic precedence of schools into ac-
count 
the following definition 1 captures a natural idea
called dynamic priority proposed in a influential work on
school choice with diversity goals  ehlers et al   2014   while
our new definition is applicable to any market with flexible di-
versity goals  when diversity goals are not considered  it is
equivalent to the standard stability concept 
definition 1  stability   given a feasible outcome y with
 i  h′  b′  ∈ y   a student i and a school b will form a block-
ing pair if  i  h  b  ≻i  i  h′  b′  and either i  the outcome
y ∪   i  h  b   \   i  h′  b′   is feasible  or ii  there exists
a contract  j  h  b  ∈ y such that for all t ∈ t i  and
all t′ ∈ t j  and for the outcome y ′ = y \   j  h  b   
one of the following conditions holds  a  t pb y ′  t′  or b 
 i  h  b  ≻b  j  h  b  and either t i  = t j  or t ib y ′  t′
holds  a feasible outcome is stable if there is no blocking pair 
we will try to understand how far stability can be achieved
under various conditions 
5 2
no specialized seats
we first focus on the case in which each school has identi-
cal/homogenous school seats or students are indifferent be-
tween school seats of the same school  this model is still
a significant generalization of the controlled school choice
problem  ehlers et al   2014  in which all the school seats are
identical and schools impose soft minimum and maximum
quotas on each type  in contrast  our model allows for much
more general diversity goals including type-specific quotas 
our first result is the following theorem 2 
theorem 2  when there are no specialized seats and each
student has one type  gda-fd is strategy-proof for the stu-
dents and yields a stable outcome 
note that to run gda-fd  students need to break ties lex-
icographically to derive a strict preference relation over con-
tracts  the proof idea for theorem 2 is as follows  we show
that in our framework  even though the choice functions of
schools capture complex diversity goals  they still satisfy two
key properties called substitutability  sub  and law of ag-
gregate demand  lad  as defined in  hatfield and milgrom 
2005   once these properties are established  we invoke a
general result in  hatfield and milgrom  2005  that the gener-
alized deferred acceptance is strategy-proof for the students
and always yields a stable outcome 
note that theorem 2 does not hold when each student may
have multiple types  as mentioned in theorem 3 
theorem 3  when there are no specialized seats and each
student has multiple types  gda-fd is no longer strategy-
proof for the students and does not always yield a stable out-
come 
6
specialized seats
in this section  we delve deeper into the case where students
may distinguish between certain seats of a school  we study
which positive properties of gda-fd such as strategyproof-
ness continue to hold under more general preferences  and
present negative results that stable outcomes are not guaran-
teed to exist even under very restrictive conditions 
6 1
case of a global school
we first warm up by getting an in-depth understanding of
gda-fd for the case of a global school  the case of a global
school is still an important setting that captures scenarios such
as hiring of candidates by a company under diversity goals 
we provide an alternative view of gda-fd by showing that
it is equivalent to a sequential allocation algorithm  algo-
rithm 3  under the assumption that there is a policy maker
who treats the set of school seats as one global school b that
has a global priority and a precedence ordering  algorithm 3
can be viewed as a generalized version of serial dictatorship
proceedings of the thirtieth    ijcai-21 
21
 or sequential allocation in which dynamic diversity priorities
are taken into account 
algorithm 3 sequential allocation under dynamic diversity
goals
input  an instance i with global priorities and precedence relation
for school b
output  an outcome z ⊆ x
1  while some student is unmatched and can get an unallocated
school seat do
2 
identify the set of types t ′ with the highest precedence based
on rb z  for which there exists some student who satisfies
some type in t ′
3 
among the students who satisfy some type in t ′  find the
student i ∈ s who has the highest school priority based on
≻b  which is achieved from ≿b by any fixed tie-breaking
rule 
4 
assign student i her favorite contract x =  i  h  b  among
x   z ← z ∪  x 
5 
remove the student i from the market  s ← s \  i 
6 
remove the set of contracts involving student i and seat h 
x \  xi ∪ xh 
7  return z
an outcome x is weakly pareto optimal if there is no other
outcome x′ such that all the students get a more preferred
outcome  an algorithm is type-strategyproof if no student
has an incentive to report a subset of her true types  next  we
summarize the properties of the algorithm 3 in theorem 4 
theorem 4  if there is one global school  even if students
have multiple types  algorithm 3 is strategyproof and type-
strategyproof and the outcome returned by algorithm 3 is
weakly pareto optimal 
next  we show algorithm 3 has a strong connection with
gda-fd for the setting in which students have strict prefer-
ences over the school seats and there is exactly one school 
theorem 5  when there is exactly one school  the gda-fd
algorithm returns the same outcome as algorithm 3 even if
each student may have multiple types
proof   sketch  assume algorithm 2 terminates in m itera-
tions  for each iteration k ∈  1  m   let y 1          y m denote
the set of contracts proposed by students  we prove that al-
gorithm 3 also returns the same outcome y m given the same
input in the appendix 
although the gda-fd remains strategyproof when there
is one global school and each student has a strict preference
over school seats  it does not return a stable outcome even if
each student has one type  as mentioned in theorem 6 
theorem 6  when each student has a strict preference over
school seats  then the gda-fd algorithm and algorithm 3 do
not return a stable outcome even if there is only one school
and each student has one type 
6 2
school-based preferences
in this section  we consider the case that students have school-
based preferences  a student has school-based preferences if
all the school seats of one school are preferred over all the
algorithm 4 modified gda-fd  algorithm for school-
based preferences
input  i  chs  chc  a set of contracts y
output  an outcome z ⊆ y
1  let i′ be the instance in which students are indifferent between
school seats of the same school 
2  let y denote the outcome after applying gda-fd to i′ 
3  let sj denote the set of students who get matched to school bj
in the outcome y  
4  for each j ∈  1  · · ·   m  where m = |c| do
5 
apply gda-fd to the set of students sj and school bj to al-
locate the school seats of bj to sj  with respect to the original
preferences ≻s in i  let the outcome be y ′
j  
6  return z = �m
j=1 y ′
j  
school seats of another school or vice versa  note that stu-
dents may have different preferences over school seats within
the same school  for school-based preferences  we assume
that all the school seats of a school are acceptable or none 
the model of school choice with identical school seats is a
special class of school-based preferences  the case of a sin-
gle school is also a special case of school-based preferences 
theorem 7  for school-based preferences  gda-fd is not
strategy-proof for students even if each student has one type 
next  we design a new algorithm  algorithm 4  for the case
of school-based preferences which invokes gda-fd twice 
in the first stage of algorithm 4  we first run gda-fd on a
modified instance i′ in which school seats within a school
are identical  this gives us information about which students
are matched to which schools  in the second stage  we ap-
ply gda-fd to each school and the set of students who are
matched to that school based on students  true preferences
over school seats  the second step determines which student
receives which school seat  algorithm 4 is strategyproof if
each student has a single type as shown in theorem 8 
theorem 8  for school-based preferences  when each stu-
dent has one type  algorithm 4 is strategy-proof for students 
next  we point out an impossibility result that the set of
stable outcomes may be empty for school-based preferences
even if under very restrictive conditions as shown in theo-
rem 9 
theorem 9  when each student has a strict preference over
school seats  the set of stable outcomes may be empty even
if each student has one type and all schools have the same
priority ordering over students 
7
conclusions
we proposed a matching market model for residential mar-
kets with flexible diversity goals  we provided a clear under-
standing of under which conditions a stable matching is guar-
anteed to exist  our diversity goal framework can be applied
to many other settings in which priorities for different types
dynamically change based on the current allocation  an in-
teresting research direction is to identify other sufficient con-
ditions for the guaranteed existence of stable outcomes under
diversity goals 
proceedings of the thirtieth    ijcai-21 
22
 references
 abdulkadiro˘glu and s¨onmez  2003  a  abdulkadiro˘glu and
t  s¨onmez  school choice  a mechanism design approach 
american economic review  93 3  729–747  2003 
 ayg¨un and turhan  2020  o  ayg¨un and b  turhan 
dy-
namic reserves in matching markets  theory and appli-
cations  journal of economic theory  188  2020 
 aziz and sun  2021  h  aziz and z  sun  multi-rank smart
reserves  in proceedings of the 22th acm conference on
electronic commerce  ec   2021 
 aziz et al   2019  h  aziz  s  gaspers  z  sun  and t  walsh 
from matching with diversity constraints to matching with
regional quotas  in proceedings of the 18th international
conference on autonomous agents and multiagent sys-
tems  aamas   pages 377–385  2019 
 aziz et al   2020  h  aziz  s  gaspers  and z  sun  mech-
anism design for school choice with soft diversity con-
straints 
in proceedings of the 28th international joint
conference on artificial intelligence  ijcai   pages 153–
159  2020 
 baswana et al   2019  s 
baswana 
p 
p 
chakrabarti 
s  chandran  y  kanoria  and u  patange 
centralized
admissions for engineering colleges in india 
in pro-
ceedings of the 20th acm conference on economics and
computation  pages 323–324  2019 
 benabbou et al   2018  n 
benabbou 
m 
chakraborty 
x  ho  j  sliwinski  and y  zick  diversity constraints in
public housing allocation  in proceedings of the 17th in-
ternational conference on autonomous agents and mul-
tiagent systems  aamas 2018  stockholm  sweden  july
10-15  2018  pages 973–981  2018 
 cheng et al   2008  c 
t 
cheng 
e 
mcdermid 
and
i  suzuki 
a unified approach to finding good stable
matchings in the hospitals/residents setting  theoretical
computer science  400 1-3  84–99  2008 
 echenique and yenmez  2015  f  echenique and m  b  yen-
mez  how to control controlled school choice  american
economic review  105 8  2679–2694  2015 
 ehlers et al   2014  l  ehlers  i  e  hafalir  m  b  yenmez 
and m  a  yildirim  school choice with controlled choice
constraints  hard bounds versus soft bounds  journal of
economic theory  153 648–683  2014 
 gonczarowski et al   2019  y  a  gonczarowski  n  nisan 
l  kovalio  and a  romm 
matching for the israeli
 mechinot  gap year  handling rich diversity require-
ments  in proceedings of the 20th acm conference on
economics and computation  ec   pages 321–321  2019 
 hafalir et al   2013  i  e  hafalir  m  b  yenmez  and m  a 
yildirim 
effective affirmative action in school choice 
theoretical economics  8 2  325–363  2013 
 hatfield and milgrom  2005  j  w  hatfield and p  r  mil-
grom  matching with contracts  american economic re-
view  95 4  913–935  2005 
 kojima  2012  f  kojima 
school choice  impossibilities
for affirmative action 
games and economic behavior 
75 2  685–693  2012 
 kominers and s¨onmez  2013  s 
d 
kominers
and
t  s¨onmez 
designing for diversity in matching 
in
proceedings of the 14th acm conference on electronic
commerce  ec   pages 603–604  2013 
 kominers and s¨onmez  2016  s 
d 
kominers
and
t  s¨onmez 
matching with slot-specific priorities 
theory  theoretical economics  11 2  683–710  2016 
 kurata et al   2017  r  kurata  n  hamada  a  iwasaki  and
m  yokoo  controlled school choice with soft bounds and
overlapping types  journal of artificial intelligence re-
search  58 153–184  2017 
 nguyen and vohra  2019  t  nguyen and r  vohra  stable
matching with proportionality constraints  operations re-
search  67 6  1503–1519  2019 
 s¨onmez and yenmez  2019  t  s¨onmez and m  b  yenmez 
constitutional implementation of reservation policies in
india  manuscript  2019 
 sun  2020  z  sun  mechanism design for matching with
constraints  phd thesis  university of new south wales 
sydney  australia  2020 
proceedings of the thirtieth    ijcai-21 
23
 "
None,2021,0003,PROPm Allocations of Indivisible Goods to Multiple Agents,"Artem Baklanov, Pranav Garimidi, Vasilis Gkatzelis, Daniel Schoepflin",abstract comes here,https://www.ijcai.org/proceedings/2021/0004.pdf,data/fulltext/pdf/2021/0003.pdf,../vikus-viewer/data/fulltext/pdf/2021/0003.pdf,"propm allocations of indivisible goods to multiple agents
artem baklanov1   pranav garimidi2   vasilis gkatzelis3 and daniel schoepflin3
1hse university  russian federation
2columbia university
3drexel university
apbaklanov@hse ru  pg2682@columbia edu   gkatz schoep @drexel edu
abstract
we study the classic problem of fairly allocating a
set of indivisible goods among a group of agents 
and focus on the notion of approximate proportion-
ality known as propm  prior work showed that
there exists an allocation that satisfies this notion
of fairness for instances involving up to five agents 
but fell short of proving that this is true in general 
we extend this result to show that a propm alloca-
tion is guaranteed to exist for all instances  indepen-
dent of the number of agents or goods  our proof is
constructive  providing an algorithm that computes
such an allocation and  unlike prior work  the run-
ning time of this algorithm is polynomial in both
the number of agents and the number of goods 
1
introduction
the fair allocation of scarce resources to a group of compet-
ing agents is a fundamental problem in both computer science
and economics  a particularly natural and well-studied set-
ting is the fair allocation of indivisible goods to agents with
additive valuations  under additive valuations  an agent i has
a value vij for each good j and her value for a bundle of goods
s is equal to the sum of the values over each good j ∈ s  i e  
vi s  = �
j∈s vij  an indivisible good cannot be split and
shared by more than one agent so achieving  fairness  with
indivisible goods is often a difficult task  even determining
the appropriate definition of fairness can be non-trivial 
one standard notion of fairness is proportionality  an allo-
cation of a set of goods m to n agents is proportional if each
agent i receives a set of goods si for which she has value
vi si  ≥
1
nvi m   in words  proportionality requires that
every agent obtains at least a 1/n fraction of her total value 
unfortunately  when items are indivisible achieving propor-
tionality may not be possible  for instance  when allocating
a single indivisible good there is no way to provide any posi-
tive value to anyone other than the one agent that receives the
good  in fact  this example shows that one cannot even guar-
antee any multiplicative approximation of proportionality  on
the other hand  this instance does not rule out the existence of
allocations satisfying additive relaxations of proportionality 
three notable additive relaxations of proportionality are
prop1  propx  and propm  each of these notions requires
that agent i must receive value no less than 1
nvi m  − di for
some appropriately defined di ≥ 0  the least demanding of
these notions is prop1  wherein di is the largest value that
agent i has for any item allocated to another agent  conitzer et
al   2017   on the other extreme  for propx di is the small-
est value that agent i has for any item allocated to another
agent  moulin  2019   prop1 is known to be easy to sat-
isfy and provides weak guarantees  while propx is overly
demanding and known to not always exist  in the case of
propm  di corresponds to the maximin value that agent i has
among items allocated to other agents  baklanov et al   2020  
propm sits somewhere between prop1 and propx  and it
is the focus of this work 
baklanov et al   2020  demonstrated that there always ex-
ists a propm allocation for problem instances with up to five
agents  they also demonstrate that many other alternative re-
laxations of proportionality  e g   letting di be the value of
the minimax value item  the median value item  and the aver-
age value item  fail to exist even for instances of three agents 
propm then seems to be a rather unique notion of approxi-
mate proportionality in that it strikes a balance between pro-
viding non-trivial guarantees and seemingly being plausible
to exist in general cases  however  the techniques used to
prove this existence result required extensive case analysis 
suggesting that they would not be useful toward an analogous
proof for instances with many agents  two natural questions
then arise from  baklanov et al   2020   are propm alloca-
tions always guaranteed to exist for any number of agents  if
so  can they be efficiently computed  in this work  we answer
both these questions in the affirmative 
2
related work
as discussed above  it is impossible to guarantee any multi-
plicative approximation of proportionality in the indivisible
items setting  the first additive approximation   proportion-
ality up to the most valued item   prop1   was originally
proposed by conitzer et al   2017  where the authors demon-
strated that there always exists a pareto optimal allocation that
is also prop1  on the other hand  moulin  2019  showed that
if we instead consider  proportionality up to the least valued
item   propx  we can no longer guarantee existence  more-
over  aziz et al   2020  demonstrated that propx allocations
may not exist even for instances with only three agents 
another standard notion of fairness is  envy-freeness 
proceedings of the thirtieth    ijcai-21 
24
 wherein an agent is said to be envy-free if she has weakly
higher value for the set of goods she receives than the set
of goods any other agent receives 
the instance with the
single indivisible items  discussed above  verifies that envy-
freeness may not be achievable either  so prior work has
focused on notions of approximate envy-freeness  namely
 envy-freeness up to the most valued item   ef1   budish 
2011  and  envy-freeness up to the least valued item   efx 
 caragiannis et al   2019   similar to prop1  ef1 alloca-
tions are known to exist for any number of agents  lipton et
al   2004   on the other hand  the existence or non-existence
of efx allocations has not been proven in general  and it is
one of the main open problems in fair division 
plaut and roughgarden  2018  demonstrated that efx al-
locations always exist for two agents  even with combinato-
rial valuations  and chaudhury et al   2020a  established the
existence of efx allocations for instances with three agents
with additive valuations  extending the results in  chaud-
hury et al   2020a  to more than three agents remains a chal-
lenging problem as the proof relies on complex case analy-
sis  much like the proof of existence of propm allocations
for up to five agents in  baklanov et al   2020   central to
many of the proofs of existence for ef1 and efx is a varia-
tion of a procedure of lipton et al   2004  known as  envy-
cycle elimination   see  e g    plaut and roughgarden  2018 
chaudhury et al   2020b  oh et al   2019  amanatidis et al  
2020   wherein a graph representing a given allocation is con-
structed and an alternative allocation is produced by propa-
gating changes along the edges of the graph  our algorithm
for generating propm allocations has a very similar flavor 
beginning from a partial allocation and using a graph analy-
sis to imply a set of changes sufficient to arrive at a propm
allocation 
even if some fairness notion is shown to be achievable  it is
still crucial to study the computational tractability of finding a
solution that satisfies it  aziz et al   2020  provided a strongly
polynomial-time algorithm producing a prop1 and pareto
efficient allocation even in the presence of chores  i e   some
goods can have negative value   for ef1 allocations  cara-
giannis et al   2019  showed that maximizing the nash social
welfare  the geometric mean of the values of the agents  pro-
duces an allocation that is ef1 and pareto efficient  on the
other hand  lee  2017  demonstrated that computing this is
intractable  however  the work of barman et al   2018  pro-
vided an alternative pseudo-polynomial time algorithm that
computes an ef1 and pareto optimal allocation  for efx  the
picture is much less clear  the algorithmic result in  plaut
and roughgarden  2018  relies on computing the allocation
optimizing the leximin objective which may take exponen-
tial time and the result for three agents in  chaudhury et al  
2020a  leads only to a pseudo-polynomial time algorithm 
for propm  the existing results in  baklanov et al   2020  are
constructive but may require exponential time in the number
of items  even for just five agents  on the other hand  in this
work we demonstrate that propm allocations for any num-
ber of agents can  indeed  be computed in time polynomial in
the number of agents and items – a major improvement over
 baklanov et al   2020  
3
our results
prior to this work  we knew that an allocation satisfying
propm always exists for instances involving up to five
agents  in this paper  we significantly extend this result by
providing an algorithm that computes a propm allocation for
any number of goods and agents  moreover  our algorithm
operates in time polynomial in both the number of agents
and items  unlike the algorithm proposed in  baklanov et al  
2020   which was not polynomial even for a fixed number of
agents  in light of these results  propm stands out as a rare
example of a quite non-trivial fairness notion for which we
get universal existence and polynomial-time computability 
our algorithm employs a useful observation from  bak-
lanov et al   2020   see observation 3 in subsection 6 2 in
this paper  which characterizes the conditions under which
an instance can be split into agent- and item-disjoint sub-
problems which can  effectively  be solved completely sep-
arately  yielding a full solution for the initial instance  to
produce such sub-problems  we consider a novel graph rep-
resentation of our instance and search for paths through the
graph  these paths imply a series of gradual modifications
leading to the final decomposition of each problem instance
into sub-problems  we consider this algorithm to be of both
practical and theoretical interest 
4
preliminaries
we study the problem of allocating a set m of m indivisible
items  or goods  to a set of n agents n =  1  2          n   each
agent i has a value vij ≥ 0 for each good j and her value
for receiving some subset of goods s ⊆ m is additive  i e  
vi s  = �
j∈s vij  for ease of presentation  we normalize
the valuations so that vi m  = 1 for all i ∈ n  we also
assume that vij ≤ 1/n for all i ∈ n  j ∈ m  because any
item j with vij > 1/n could be assigned to i and reduce the
problem to finding a propm allocation of m\ j  to n\ i  1
we let mi s  = minj∈s vij  denote the value of the least
valuable good for agent i in bundle of goods s 
an allocation x =  x1  x2          xn  is a partition of the
goods into bundles such that xi is the bundle allocated to
agent i  we use di x  = maxi′̸=i mi xi′   to denote the
value of the maximin good of agent i in x  and we say that an
agent i is propm-satisfied by x if vi xi    di x  ≥ 1/n 
an allocation x is propm if it propm-satisfies every agent 
the goal of our algorithm is to use these bundles to decom-
pose the problem into smaller sub-problems  and compute a
propm allocation using a divide   conquer approach  a
sub-problem  a  n ′  is a pair consisting of a set of bundles
a =  a1  a2          ak  and a subset of agents n ′ ⊆ n 
in other words  a sub-problem  matches  a group of agents
with a group of bundles  and our goal is going to be to do
so in a way that computing a propm allocation for each
sub-problem yields a propm allocation for the original prob-
lem 
the value of an agent i for a set of bundles a is
vi a  = �
aj∈a vi aj   we call a sub-problem  a  n ′ 
proportional if vi a /|n ′| ≥ 1/n for all i ∈ n ′ 
1this fact is proven as lemma 2 in  baklanov et al   2020  
proceedings of the thirtieth    ijcai-21 
25
 given a set of bundles a and a set of agents n ′  a
decomposition is a division of these agents and bundles into
 bundle and agent  disjoint sub-problems  for example con-
sider a set of five agents n ′ =  1  2  3  4  5  and a set of five
bundles a =  a1  a2  a3  a4  a5   one possible decom-
position of  a  n ′  would be into the disjoint sub-problems
  a1  a2  a3    1  2  3   and   a4  a5    4  5   
we say
that a decomposition for  a  n ′  is proportional if all of its
included sub-problems are proportional  as we show later
on  as long as a decomposition is proportional  we can fo-
cus on solving each of its sub-problems recursively without
worrying about the allocation beyond that sub-problem 
consider 
again 
the example above of five agents
 1  2  3  4  5  and five bundles  a1       a5   for these five
agents assume agents 1  2  and 3 have the same valuation
function and assume agents 4 and 5 have the same valuation
functions  let the valuation functions for agents 1  2  and 3
be v a1  = 1
4 and v a2  = v a3  = v a4  = v a5  =
3
16
and let the valuation function for agents 4 and 5 be v a1  =
v a2  = v a3  = 1
6  v a4  =
3
20  and v a5  =
7
20  since
valuation functions are additive  we then have that vi a1 ∪
a2∪a3 /3 ≥ 1/5 for i ∈  1  2  3  and vi a4∪a5 /2 ≥ 1/5
for i ∈  4  5   thus  the decomposition of  a  n ′  described
above d =    a1  a2  a3    1  2  3      a4  a5    4  5   
is a proportional decomposition  we will see that this means
that we can solve the two sub-problems of allocating items in
a1 ∪a2 ∪a3 to agents 1  2  and 3 such that they are propm-
satisfied with respect to a1 ∪ a2 ∪ a3 and allocating items
in a4 ∪ a5 to agents 4  5 such that they are propm-satisfied
with respect to a4 ∪ a5 to produce an allocation where every
agent is propm-satisfied in the original problem 
5
propm algorithm
our algorithm begins by choosing some arbitrary agent i ∈ n
to serve as the  divider   we henceforth use i to refer to the
divider agent and n −i = n \  i  to refer to the set of all
other agents   the divider agent partitions the items into n
bundles  and then the algorithm proceeds to evaluate the other
agents  preferences over these bundles to decide which one
the divider should receive  once the divider s bundle has been
determined  the initial problem is decomposed into smaller
sub-problems that are solved recursively 
5 1
stage 1  the divider partitions the goods
in order to partition the goods  the divider  agent i  first
sorts them in non-decreasing order of value  from i s per-
spective  and indexes them accordingly  then  the first bun-
dle s1 corresponds to the longest prefix of goods in this or-
dering such that vi s1  ≤ 1/n  observe that  by construc-
tion  vi s1    vij > 1/n for all j ∈ m \ s1  moreover 
there is at least  n − 1 /n total value remaining for i out-
side s1 
we construct s2 by taking the longest prefix of
goods in m \ s1 such that i has value less than or equal to
1/ n−1 ·vi m \s1  for receiving all of them  similarly  we
let sk be the longest prefix of goods in m \  ∪k−1
j=1sj  such
that the divider s value for these items remains less than or
equal to 1/ n − k   1  · vi m \  ∪k−1
j=1sj   
5 2
stage 2  decomposing into sub-problems
using disjoint bundles s1  s2          sn from the divider s par-
tition  we now decompose the problem into sub-problems 
eventually solving them recursively  specifically  we care-
fully choose one of these n bundles  say st  and allocate it to
the divider  we then recursively allocate the items of bundles
s1          st−1 to some group nl of t−1 agents  and the items
of bundles st 1          sn to some group nr of n − t agents 
as the pseudocode of algorithm 1 shows  the decompo-
sition process works in a sequence of  up to  n iterations 
indexed by t ∈  1  2          n   at the beginning of every it-
eration t  the algorithm has already identified a proportional
decomposition d involving t − 1 agents and the bundles
s1  s2          st−1  at the end of step t  either the proportional
decomposition d has been updated to also include the bundle
st and a total of t agents  possibly different than the t−1 ones
that were participating in it at the beginning of the round   or
the bundle st has been assigned to the divider agent  and the
remaining problem has been decomposed into a list of pro-
portional sub-problems  throughout the execution of the al-
gorithm  nr is used to denote the set of agents that are not
participating in the proportional decomposition d 
the first thing that the algorithm does in each iteration t is
to evaluate c  the number of agents from nr whose average
value for the first t bundles is more than 1/n  if c is equal
to 0  this means that all the agents in nr essentially  prefer 
sharing the last n − t bundles instead of the first t bundles 
if this is the case  then the algorithm allocates bundle st to
the divider agent  it then recursively solves the proportional
decomposition d  whose sub-problems involve t − 1 agents
and the first t−1 bundles  and also recursively solves the sub-
problem involving the remaining n − t agents  i e   those in
nr  and the items from the last n − t bundles  st 1 to sn 
on the other hand  if the value of c is positive  this sug-
gests that there are agents in nr that  prefer  to share the
first t bundles rather than the last n − t bundles  intuitively 
this suggests that the first t bundles are  over-demanded   so
our algorithm calls updatedecomposition  a crucial sub-
routine  to update decomposition d  as we discuss in subsec-
tion 5 3  a single execution of this subroutine can have one of
two possible outcomes  i  either the value of c decreases by
1  or ii  the number of agents in the decomposition  denoted
|d agents| for notational simplicity  increases by 1  the al-
gorithm keeps calling this subroutine until either the decom-
position grows to include bundle st and t agents  or c drops
to 0  in the former case  it continues to the next iteration  i e  
t ← t   1   otherwise  it assigns st to the divider and recur-
sively solves the remaining sub-problems  figure 1 shows an
example of the algorithm running on a sample instance 
5 3
the updatedecomposition subroutine
the updatedecomposition subroutine plays a central
role in our propm algorithm  and it achieves the desired up-
date of the existing proportional decomposition d at iteration
t by propagating changes on a carefully constructed graph 
note that whenever we call this subroutine  the value of c is
positive  so there exists at least one agent k ∈ nr  i e   not
participating in d  for whom vk s1 ∪ · · · ∪ st /t > 1/n 
proceedings of the thirtieth    ijcai-21 
26
 algorithm 1  propm algorithm
1 let s1  s2          sn be the bundles the divider produces
2 let d be an  initially empty  decomposition
3 nr ← n −i
4 for t = 1 to n do
5
c ← | k ∈ nr   vk s1∪···∪st 
t
> 1
n |
6
while c > 0 and |d agents| < t do
7
d ← updatedecomposition
8
nr ← subset of n −i not participating in d
9
c ← | k ∈ nr   vk s1∪···∪st 
t
> 1
n |
10
if |d agents| < t then
11
allocate st to the divider agent  agent i 
12
recursively solve all sub-problems of d
13
recursively solve  st 1 ∪ · · · ∪ sn  nr 
14
return the combined allocation
given the decomposition of disjoint sub-problems d  we
construct a directed  sub-problem graph  g =  v  e   where
each vertex in v corresponds to a sub-problem in d and
and an edge  u  w  between two vertices u  w ∈ v exists
if and only if the corresponding sub-problems   au  nu  and
 aw  nw  satisfy the following condition  there exists some
agent k ∈ nu who satisfies vk aw 
|nw|
≥
1
n  in other words 
such an edge exists if and only if removing some agent from
nw and replacing her with agent k would maintain the pro-
portionality of the  aw  nw  sub-problem 
the sub-problems corresponding to the vertices of g in-
volve bundles s1          st−1 and some set of t − 1 agents so
the number of vertices in g is at most t−1  we add to g two
more vertices  the first vertex  wα  corresponds to the agent
k ∈ nr mentioned above  this vertex has outgoing edges to
all the sub-problems  a  n ′  of d for which vk a 
|n ′| ≥ 1
n  the
second vertex  wβ  corresponds to the bundle st that we wish
to introduce to this decomposition  this vertex has incoming
edges from any vertex whose sub-problem includes an agent
i′ with value vi′ st  ≥ 1/n  in this graph  let r be the set of
vertices that are reachable from wα via directed paths 
case 1  if this set r includes the vertex wβ  corresponding
to the bundle st  i e   if there is a path from wα to wβ  then
the subroutine reallocates agents along the sub-problems of
this path  specifically  for each edge  u  w  on this path  we
remove from the sub-problem of u the agent that is responsi-
ble for the existence of this edge  we choose one arbitrarily if
there are multiple  and we place that agent in the sub-problem
of w  as a result  d would then include bundle st as well as
agent k  thus increasing |d agents| and  as we argue in sec-
tion 6  this modification maintains the proportionality of the
decomposition 
case 2  if the set r does not include the vertex wβ  but it
includes some agent i′ with vi′ s1∪···∪st 
t
≤ 1
n  then we per-
form an analogous shift of the agents across the sub-problems
along the path from k to i′  but remove agent i′ from the de-
composition and add her to the set nr  this  again  does not
compromise the proportionality of the decomposition  but it
ensures that the updated value of c will drop by 1 since agent
k was removed from nr and replaced with agent i′ who does
not contribute toward an increase of the value of c 
case 3  finally  if neither of the cases above holds  the sub-
routine takes all the agents and all the bundles corresponding
to vertices in r and merges them into a single sub-problem 
together with agent k and bundle st  this  again  increases
|d agents| and as we show using a separate argument in sec-
tion 6  it maintains the proportionality of the decomposition 
6
correctness of the algorithm
to verify the correctness of the algorithm  we first show
that it always terminates and returns an allocation  in fact 
we demonstrate in section 7 that the algorithm completes in
polynomial time   as we verify in subsection 6 1  a single
call to the updatedecomposition subroutine returns an
updated decomposition that has either one additional agent
 and bundle  or has reduced the value of c by 1  since the
value of c at the beginning of each iteration can never be more
than n − 1  this ensures that the while loop will always ter-
minate within a finite number of iterations  if for some it-
eration t ≤ n − 1 the value of |d agents| drops below t 
then the algorithm recurses on smaller problems and returns
the induced allocation 
if  on the other hand  |d agents|
does not drop below t for any iteration t ≤ n − 1  then
when t = n we have an empty set nr  necessarily leading
to d including every agent except for the divider  meaning
|d agents| = n − 1 < t   also  note that the size of the sub-
problems solved recursively always strictly decreases  we
demonstrate in subsection 6 2 that this process yields a pro-
portional allocation for all agents 
6 1
correctness of updatedecomposition
we now formally prove that after every execution of the
updatedecomposition subroutine  either |d agents| in-
creases by 1  or the value of c drops by 1  in both cases  the
resulting decomposition remains proportional  throughout the
execution of the algorithm 
first  note that the set r of vertices that are reachable from
agent k is bound to be non-empty  this is due to the fact
that vk s1 ∪ · · · ∪ st /t > 1/n  i e   the agent s average
bundle value is more than 1/n and  by pigeonhole princi-
ple  there must exist some sub-problem  a  n ′  such that
vk a /|a| ≥ 1/n  since the set r is not empty  the descrip-
tion of the subroutine in the previous section clearly shows
that it always achieves either an increase of |d agents| or a
drop of the value of c  therefore  the rest of this subsection
focuses on proving that all of these updates on the decompo-
sition maintain its proportionality 
lemma 1  given a proportional decomposition  the de-
scribed re-allocation of agents across the directed edges of
a path in the decomposition s sub-problem graph leads to a
new decomposition that remains proportional 
proof  note that  by definition of the sub-problem graph  any
agent that caused the existence of an edge  u  w  must have
a value of at least |nw|/n for the bundles of the sub-problem
corresponding to vertex w  as a result that agent will still
satisfy proportionality if moved from u to w  this is true for
proceedings of the thirtieth    ijcai-21 
27
 4
nr
t = 1
2
3
5
6
s1
�
��
�
s2
� �� �
s3
�
��
�
s4
����
s5
����
s6
�
��
�
4
6
nr
t = 2
2
3
5
s1
�
��
�
s2
� �� �
s3
�
��
�
s4
����
s5
����
s6
�
��
�
4
5
2
nr
t = 3
3
6
s1
�
��
�
s2
� �� �
s3
�
��
�
s4
����
s5
����
s6
�
��
�
t = 4
4
5
2
3
6
1
s1
�
��
�
s2
� �� �
s3
�
��
�
s4
����
s5
����
s6
�
��
�
figure 1  the state of our algorithm after the completion of iterations t ∈  1  2  3  4  on a sample instance with six agents and agent 1 as
the divider  the circles correspond to items  which are grouped together into bundles  s1          s6  by the divider  the numbered boxes
beneath the items correspond to agents 2 through 6  and each of the larger rounded rectangles  containing bundles and agents  correspond to
sub-problems  in each iteration of the algorithm  captured by this figure  the dashed vertical line separates the bundles of the decomposition
d  on the left  from the remaining bundles  after each iteration t  either the decomposition is updated to include bundle st  as we see for
t ∈  1  2  3    or bundle st is allocated to the divider agent  as wee see for t = 4   finalizing the set of sub-problems to be solved recursively 
all the edges on this graph  including the ones connecting the
two added vertices wα and wβ   ensuring the proportionality
is maintained 
the more demanding case is to verify that proportionality
is also maintained by the third type of update that this subrou-
tine performs  i e   the creation of a sub-problem involving the
agents and goods in r as well as agent k and bundle st 
lemma 2  if a′ is the collection of all the bundles corre-
sponding to sub-problems not reachable from wα  excluding
st  then for every agent q from a sub-problem in r we have
vq a′ /|a′| < 1/n  the same is true for the agent k that
corresponds to vertex wα  i e   vk a′ /|a′| < 1/n 
proof  assume that this is not the case  i e   that either some
agent q corresponding to a sub-problem in r  or agent k  has
an average bundle value at least 1/n for the bundles in a′ 
by the pigeonhole principle  this implies that there must exist
some sub-problem not reachable from r such that this agent s
average value for the bundles in that sub-problem is at least
1/n  but  based on the definition of the sub-problem graph 
this would imply the existence of an edge from that agent s
vertex to this sub-problem s vertex  contradicting the fact that
the latter is not reachable from the former 
whenever the subroutine resorts to the third type of decom-
position update  case 3   this means that there is no agent i′
in a sub-problem in r such that vi′ s1∪···∪st 
t
≤ 1
n  case 2  
thus  agent k and all agents q from sub-problems in r have
value for the items in s1∪· · ·∪st greater than t/n  lemma 2
implies that their total value for the bundles in a′ is less than
|a′|/n  therefore  these agents  value for the items contained
in sub-problems in r is at least  t − |a′| /n 
also  note that the overall number of agents in the sub-
problems of g  excluding k  is t−1  and the number of agents
in the sub-problems not reachable from r are |a′|  so the total
number of agents in the sub-problems of r is t − |a′| − 1 
therefore  if we define a new sub-problem using the agents
from r  combined with agent k corresponding to vertex wα 
and the bundles from r  combined with st  then this sub-
problem will be proportional  because every agent s value for
the bundles in it will be at least  t − |a′| /n and the number
of agents in it is t − |a′| 
6 2
all agents are propm-satisfied
to verify that the induced allocation is always propm  we
first restate a useful observation from  baklanov et al   2020  
this observation provides us with a sufficient condition un-
der which  locally  satisfying propm in each sub-problem
yields a  globally  propm allocation  given an allocation
of a subset of items to a subset of agents  we say that this
partial allocation is propm if the agents involved would be
propm-satisfied if no other agents or items were present 
observation 3  let n1  n2 be two disjoint sets of agents 
let m1 and m2 = m \ m1 be a partition of the items into
two sets  and let x be an allocation of the items in m1 to
agents in n1 and items in m2 to agents in n2  then  if some
agent i ∈ n1 is propm-satisfied with respect to the par-
tial allocation of the items in m1 to the agents in n1  and
vi m1 
|n1|
≥
1
|n1 n2|  then i is propm-satisfied by x regard-
less of how the items in m2 are allocated to agents in n2 
we now prove a result regarding the partition implied by
the divider agent s preferences  which is analogous to a theo-
rem that is shown by  baklanov et al   2020  for a different 
much more complicated  partition of the items 
theorem 4  if the divider agent receives any bundle sℓ and
no item from s1 ∪ s2 ∪ · · · ∪ sℓ−1 is allocated to the same
agent as an item from sℓ 1 ∪ sℓ 2 ∪ · · · ∪ sn  then agent i
will be propm-satisfied 
proof  for all k ∈  n   we have vi sk  ≤
1
 n 1−k vi m \
 s1 ∪s2 ∪· · ·∪sk−1   by definition of sk  applying this up-
per bound on vi sk  for k = 1  because vi m  = 1 we have
that vi m\s1  ≥ 1− 1
n = n−1
n   by applying the upper bound
on vi sk  for k = 2 and our lower bound on vi m \ s1  we
get vi m \ s1 ∪s2   ≥ n−1
n −
1
n−1 · n−1
n
≥ n−2
n   iteratively
proceedings of the thirtieth    ijcai-21 
28
 repeating this process  we obtain that for all k ∈  n  we know
that vi m \  s1 ∪ s2 ∪ · · · ∪ sk   ≥
n−k
n   also by defi-
nition  we have that vi sℓ    minj∈m\ s1∪s2∪···∪sℓ  vij  ≥
1
 n 1−ℓ  ·vi m \ s1∪s2∪· · ·∪sℓ−1   ≥
1
n 1−ℓ · n− ℓ−1 
n
=
1
n  but finally  as long as the items from s1 ∪ s2 ∪ · · · ∪ sℓ−1
are not included in any of the bundles containing the items
in m \  s1 ∪ s2 ∪ · · · ∪ sℓ  in the complete allocation x 
we have that di x  ≥ minj∈m\ s1∪s2∪···∪sℓ  vij  so i is
propm-satisfied when allocated set sℓ 
lemma 5  the divider agent is always propm-satisfied  all
non-divider agents are always propm-satisfied as well 
proof  note that the divider agent always receives a bun-
dle st in some iteration t 
all the items from bundles
s1          st−1 are allocated to the agents that were in the de-
composition d at that time  while all the items from bundles
st 1          sn are allocated to the agents that were in nr at
the time  and hence not in d   then  given theorem 4  we
conclude that the divider agent is always propm-satisfied 
now observe that no agent other than the divider agent is
directly allocated a bundle by our algorithm  instead  the al-
location to the other agents is decided recursively in some
recursive call of a smaller sub-problem  when they are as-
signed the role of the divider  the important thing to verify is
that propm-satisfying these agents in a recursive call  based
on a subset of the agents and a subset of the goods  does  in
fact  imply that they are propm-satisfied with respect to the
original problem instances as well 
in order to ensure this fact  we combine the statement
of observation 3 with the definition of proportional sub-
problems and decompositions  in particular  our definition of
proportionality for a sub-problem guarantees that the condi-
tions of observation 3 are met  since we ensure that propor-
tionality is maintained after every execution of the updat-
edecomposition subroutine  we guarantee that the combi-
nation of propm allocations for the generated sub-problems
yields a propm allocation for the original problem 
7
running time
we now move to demonstrate that algorithm 1 completes in
time polynomial in the number of agents and items  lines
1 through 9 correspond to the  divide phase  and lines 10
through 14 correspond to the  conquer phase  
the running time of algorithm 1 can be expressed as
t m  n  = f m  n   
k
�
j=1
t mj  nj  
where f m  n  denotes the cost of the main call with m items
and n agents  and the sum captures the cost of the recursive
calls  the number of recursive calls is k  equal to the num-
ber of sub-problems from lines 12 and 13   while mj and nj
are the number of items and agents  respectively  of the j-th
sub-problem  since all the sub-problems consist of distinct
bundles and agents  we must have �k
j=1 mj ≤ m − 1 and
�k
j=1 nj ≤ n − 1  thus the width of any level of the recur-
sion tree is at most max m  n   furthermore  since the size
of each sub-problem strictly decreases through the recursion 
the recursion tree has at most depth min m  n   this means
the total number of vertices in the recursion tree is polynomial
in n and m  all that remains is to show f m  n  is polynomi-
ally bounded in m and n 
producing the divider s bundles takes polynomial time
since it requires only sorting the items in non-decreasing or-
der of value and a linear pass over the sorted items  in the
body of the for loop of algorithm 1  computing the initial
value of c takes time linear in the number of agents and items
by asking each agent their value for each item in s1∪· · ·∪st 
this initial value of c is at most n − 1  as demonstrated in
subsection 6 1  at each iteration of the while loop  beginning
at line 6  in algorithm 1  the updatedecomposition sub-
routine either increases the value of |d agents| from t − 1 to
t or decreases the value of c  thus  the number of iterations
of the while loop is at most n at any iteration of the for loop 
we now demonstrate that the body of the while loop takes
polynomial time  note that computing the new value of c
after then updatedecomposition subroutine takes linear
time  in the number of agents and items   to verify that up-
datedecomposition also takes polynomial time  observe
that the sub-problem graph induced by d in iteration t of the
for loop contains at most t − 1 vertices  which would occur
when all t−1 agents in d and bundles are assigned to distinct
sub-problems   we then add two additional vertices wα and
wβ so there are at most t   1 = o n  vertices overall at any
iteration of the for loop  note that checking if an edge ex-
ists between two vertices in the graph takes time linear in the
number of agents and goods in the two sub-problems and each
sub-problem has at most n agents and m items  thus  we can
construct the graph in time o n· n m    finally  computing
the set r of reachable vertices from wα can be accomplished
by a simple breadth-first-search which is known to take time
linear in the number of the vertices and edges in the graph 
since updating the decomposition just requires propagating
changes along a path of length at most n  the entire updat-
edecomposition process takes polynomial time 
8
conclusion
in this paper  we solve the problem of computing propm al-
locations among agents with additive valuations  but we leave
open another interesting problem proposed in  baklanov et
al   2020   the question of the existence and computation of
an average-efx  a-efx  allocation  to determine if an agent
is a-efx satisfied by some allocation  we remove i s least fa-
vorite item from each other agent s allocated bundle  and then
ask that i s value for her own bundle is at least as high as her
average value for all the other agents  bundles  this notion
is stronger than propm and may provide an interesting step-
ping stone toward the  much harder  efx problem 
acknowledgements
the first author gratefully acknowledges support from the
hse university basic research program  the last two au-
thors were partially supported by nsf grants ccf-2008280
and ccf-2047907  we would also like to thank maxim tim-
okhin for helpful feedback toward improving our algorithm 
proceedings of the thirtieth    ijcai-21 
29
 references
 amanatidis et al   2020  georgios amanatidis  evangelos
markakis  and apostolos ntokos  multiple birds with one
stone  beating 1/2 for efx and gmms via envy cycle
elimination  proceedings of the aaai conference on arti-
ficial intelligence  34 02  1790–1797  apr  2020 
 aziz et al   2020  haris aziz  herv e moulin  and fedor
sandomirskiy  a polynomial-time algorithm for comput-
ing a pareto optimal and almost proportional allocation 
operations research letters  2020 
 baklanov et al   2020  artem baklanov  pranav garimidi 
vasilis gkatzelis  and daniel schoepflin  achieving pro-
portionality up to the maximin item with indivisible goods 
corr  abs/2009 09508  2020 
to appear at the thirty-
fifth aaai conference on artificial intelligence  aaai
2021  
 barman et al   2018  siddharth barman  sanath kumar kr-
ishnamurthy  and rohit vaish  finding fair and efficient
allocations  in proceedings of the 2018 acm conference
on economics and computation  ithaca  ny  usa  june
18-22  2018  pages 557–574  2018 
 budish  2011  eric budish 
the combinatorial assign-
ment problem 
approximate competitive equilibrium
from equal incomes 
journal of political economy 
119 6  1061–1103  2011 
 caragiannis et al   2019  ioannis
caragiannis 
david
kurokawa  herv e moulin  ariel d  procaccia  nisarg
shah  and junxing wang  the unreasonable fairness of
maximum nash welfare 
acm trans  economics and
comput   7 3  12 1–12 32  2019 
 chaudhury et al   2020a  bhaskar ray chaudhury  jugal
garg  and kurt mehlhorn  efx exists for three agents  in
proceedings of the 21st acm conference on economics
and computation  ec  20  page 1–19  new york  ny 
usa  2020  association for computing machinery 
 chaudhury et al   2020b  bhaskar
ray
chaudhury 
telikepalli
kavitha 
kurt
mehlhorn 
and
alkmini
sgouritsa 
a little charity guarantees almost envy-
freeness 
in shuchi chawla  editor  proceedings of the
2020 acm-siam symposium on discrete algorithms 
soda 2020  salt lake city  ut  usa  january 5-8  2020 
pages 2658–2672  siam  2020 
 conitzer et al   2017  vincent conitzer  rupert freeman 
and nisarg shah  fair public decision making  in con-
stantinos daskalakis  moshe babaioff  and herv e moulin 
editors  proceedings of the 2017 acm conference on eco-
nomics and computation  ec  17  cambridge  ma  usa 
june 26-30  2017  pages 629–646  acm  2017 
 lee  2017  euiwoong lee  apx-hardness of maximizing
nash social welfare with indivisible items  inf  process 
lett   122 17–20  2017 
 lipton et al   2004  richard j  lipton  evangelos markakis 
elchanan mossel  and amin saberi 
on approximately
fair allocations of indivisible goods  in proceedings 5th
acm conference on electronic commerce  ec-2004  
new york  ny  usa  may 17-20  2004  pages 125–131 
2004 
 moulin  2019  herv e moulin  fair division in the internet
age  annual review of economics  11 407–441  2019 
 oh et al   2019  hoon oh  ariel d procaccia  and warut
suksompong 
fairly allocating many goods with few
queries  in proceedings of the aaai conference on ar-
tificial intelligence  volume 33  pages 2141–2148  2019 
 plaut and roughgarden  2018  benjamin plaut and tim
roughgarden  almost envy-freeness with general valua-
tions  in proceedings of the twenty-ninth annual acm-
siam symposium on discrete algorithms  soda 2018 
new orleans  la  usa  january 7-10  2018  pages 2584–
2603  2018 
proceedings of the thirtieth    ijcai-21 
30
 "
None,2021,0004,Learning Within an Instance for Designing High-Revenue Combinatorial Auctions,"Maria-Florina Balcan, Siddharth Prasad, Tuomas Sandholm",abstract comes here,https://www.ijcai.org/proceedings/2021/0005.pdf,data/fulltext/pdf/2021/0004.pdf,../vikus-viewer/data/fulltext/pdf/2021/0004.pdf,"learning within an instance for designing high-revenue combinatorial auctions
maria-florina balcan1   siddharth prasad1 and tuomas sandholm1 2 3 4
1school of computer science  carnegie mellon university
2optimized markets  inc 
3strategic machine  inc 
4strategy robot  inc 
 ninamf  sprasad2  sandholm @cs cmu edu
abstract
we develop a new framework for designing truth-
ful 
high-revenue  combinatorial  auctions for
limited supply 
our mechanism learns within
an instance 
it generalizes and improves over
previously-studied random-sampling mechanisms 
it first samples a participatory group of bidders 
then samples several learning groups of bidders
from the remaining pool of bidders  learns a high-
revenue auction from the learning groups  and fi-
nally runs that auction on the participatory group 
previous work on random-sampling mechanisms
focused primarily on unlimited supply 
limited
supply poses additional significant technical chal-
lenges  since allocations of items to bidders must be
feasible  we prove guarantees on the performance
of our mechanism based on a market-shrinkage
term and a new complexity measure we coin par-
tition discrepancy  partition discrepancy simulta-
neously measures the intrinsic complexity of the
mechanism class and the uniformity of the set of
bidders 
we then introduce new auction classes
that can be parameterized in a way that does not
depend on the number of bidders participating  and
prove strong guarantees for these classes  we show
how our mechanism can be implemented efficiently
by leveraging practically-efficient routines for solv-
ing winner determination  finally  we show how to
use structural revenue maximization to decide what
auction class to use with our framework when there
is a constraint on the number of learning groups 
1
introduction
in a  limited-supply  combinatorial auction  a seller has m
indivisible items to allocate among a set s of n bidders  com-
binatorial auctions have various real-world applications  two
examples include auctions for allocating licenses for bands of
the electromagnetic spectrum and sourcing auctions for sup-
ply chain management  the design of truthful  high-revenue
combinatorial auctions is a central problem in mechanism de-
sign 
a comprehensive account of combinatorial auctions
may be found in cramton et al   2006  
a common strategy for designing truthful  high-revenue
auctions when there is an unlimited supply of each good
has been to use a random-sampling mechanism  a random-
sampling mechanism splits the bidders into two groups  and
applies the optimal auction for each group to the other group
 thereby achieving truthfulness  since the auction run on any
bidder s group is independent of her reported valuation   in
unlimited-supply settings  random-sampling mechanisms sat-
isfy strong guarantees  goldberg et al   2001  balcan et al  
2005  alaei et al   2009  
however  until now  there has been no unified  general-
purpose method of adapting the random-sampling approach
to analyze the limited-supply setting  limited supply poses
additional significant technical challenges  since allocations
of items to bidders must be feasible  for example  random-
sampling with any mechanism class that allows bidders to
purchase according to their demand functions would violate
supply constraints 
most adaptations of random-sampling
to limited supply deal with feasibility issues in complicated
ways  for example  by constructing intricate revenue bench-
marks to limit the number of buyers who can make a pur-
chase  balcan et al   2007   or by placing combinatorial con-
straints on the environment  devanur and hartline  2009 
devanur et al   2015  
in this paper we circumvent these issues by applying auc-
tion formats that generalize the classical vickrey-clarke-
groves  vcg  auction  vickrey  1961  clarke  1971  groves 
1973  to sell all m items to a random group of participatory
bidders 
these auctions prescribe feasible allocations and
payments  and are incentive compatible   several parame-
terized generalizations of the vcg auction have been studied
with the aim of increasing revenue by introducing weights
to favor certain bidders or allocations 
examples include
affine-maximizer auctions  amas   roberts  1979   virtual-
valuations combinatorial auctions  vvcas   likhodedov
and sandholm  2004  likhodedov and sandholm  2005 
sandholm and likhodedov  2015   λ-auctions  jehiel et al  
2007   mixed-bundling auctions with reserve prices  tang
and sandholm  2012   and mixed-bundling auctions  jehiel et
al   2007   however  little is known when it comes to formal
approximation guarantees for these auction classes 
a direct adaptation of vanilla random sampling can do
poorly when the auction class is rich  suppose we randomly
partition the set of bidders into two groups s1 and s2  and ap-
proceedings of the thirtieth    ijcai-21 
31
 ply the optimal mechanism for s1 to s2  consider learning
a second-price auction with a reserve in the case of selling
a single item  suppose there is one bidder who values the
item at 10 and the remaining buyers  values are in  0  9   the
high bidder is in s1 with probability 1/2  so with probabil-
ity 1/2  the optimal reserve price for s1 is 10  and the rev-
enue obtained from s2 is 0  more generally  since we study
large parameterized auction classes  the optimal auction for
s1 potentially overfits to a small number of bidders  another
adaption along the lines of vanilla random sampling to pre-
vent overfitting would be to partition the set s of bidders into
n groups  use the first n − 1 groups to learn a high-revenue
auction  and then apply that auction to the nth group  the is-
sue with this approach is that generalization guarantees would
require n large  thus the final mechanism only sells items to
a tiny fraction of bidders  incurring a large revenue loss 
our main learning-within-an-instance  lwi  mechanism
alleviates these issues by randomly drawing a set of participa-
tory bidders spar  and then sampling several proportionally-
sized learning groups from slrn  = s \ spar to learn an auc-
tion that is close-to-optimal in expectation for a random learn-
ing group  our approach is a form of automated mechanism
design  conitzer and sandholm  2002  sandholm  2003  
1 1
setup and the main mechanism
in our model  the seller has m indivisible items to allocate
among a set s of n bidders/buyers  each buyer is described
by her valuation function vi   2 1     m  → r≥0 over bundles
of the m items   we implicitly assume that each buyer s value
for getting the empty bundle is zero   we do not assume that
b ⊆ b′ implies v b  ≤ v b′   a common assumption called
free disposal   for an allocation α  vi α  denotes the value
buyer i assigns to the bundle she receives according to α  we
assume that buyers valuations are independent of what other
buyers  receive   for an allocation α  w α  = �n
i=1 vi α 
denotes the welfare of α  and w−i α  = �
j̸=i vj α  de-
notes the welfare of α when bidder i is absent  for a set of
bidders s  w s  = maxα w α  denotes the welfare of an
efficient allocation  that is  an allocation that maximizes wel-
fare  the vcg auction uses the efficient allocation α∗  and
bidder i pays maxα w−i α  − w−i α∗   the auctions we
study in this paper are parameterized generalizations of the
vcg auction that modify the welfare function by applying
boosts to specific allocations with the aim of increasing rev-
enue  for an auction m and a set of bidders s′ ⊆ s  we
denote by revm s′  the sum of the payments made by bid-
ders in s′ when the seller runs m among bidders in s′  we
write s′ ∼p s to denote a subset s′ being sampled from s by
including each bidder in s′ independently with probability p 
we now present the main mechanism of this paper 
learning-within-an-instance mechanism  lwi  parame-
ters  p  q  n
1  draw a group of participatory buyers spar ∼p s 
2  draw learning groups of buyers s1          sn ∼q s \ spar 
3  find the mechanism �
m ∈ m that maximizes empirical
revenue 1
n
�n
t=1 revm st  over the learning groups 
4  apply mechanism �
m to spar 
when m is a class of incentive-compatible mechanisms 
lwi is incentive-compatible since �
m does not depend on the
valuations of the bidders in spar 
1 2
summary of the contributions of this paper
in section 2 we provide the main guarantees satisfied by our
lwi framework  the guarantees are derived using learning-
theoretic techniques  informally  they provide  high proba-
bility  lower bounds on the performance of lwi of the form
rev�
m spar  ≥ w s  lm − εm n  δ   − τm  where lm
measures the revenue loss incurred by allocating items only
to participatory bidders  εm is a standard learning-theoretic
error term that depends on the intrinsic complexity of m  and
τm is an additional error term we coin partition discrepancy 
partition discrepancy is also a measure of the intrinsic com-
plexity of m  but is simultaneously a measure of the level of
uniformity in the set s of bidders  we provide examples and a
general bound to illustrate properties of partition discrepancy 
in section 3 we introduce a new class of auctions called
bundling-boosted auctions  these auctions are parameterized
in a way that does not depend on the number of bidders who
participate in the auction  unlike most previous generaliza-
tions of the vcg auction   we prove bounds on the intrin-
sic complexity of bundling-boosted auctions  and a few other
natural subclasses of auctions  that have no dependence on
the number of bidders  we show that under certain condi-
tions lwi on the class of bundling-boosted auctions yields an
 o p  − ε -approximation with high probability 
in section 4 we show how our learning-within-an-instance
mechanism can be implemented in a sample and compu-
tationally efficient manner for bundling-vcg auctions and
sparse bundling-boosted auctions by leveraging practically
efficient routines for solving winner determination 
in section 5 we show how to use structural revenue maxi-
mization to decide what auction class to use with lwi when
there is a constraint on the number of learning groups 
1 3
additional related research
there have been various alternate approaches to revenue
maximization for limited supply  balcan  blum  and man-
sour  2008  obtain a o 2
√log m log log m -approximation for
bidders with subadditive valuations  which was improved
to a o log2 m -approximation by chakraborty  huang  and
khanna  2013   both these works studied item-pricing mech-
anisms  sandholm and likhodedov  2005  2015  obtain a
 2   2 log h/l  -approximation when bidders have additive
valuations  where l and h are lower and upper bounds on the
valuation of any bidder for any item  our results significantly
improve upon these existing results in various situations  for
example  for w s  sufficiently large  we prove that our lwi
mechanism run on the class of bundling-boosted auctions
yields an  o p  − ε -approximation  in addition  previous
approximations are on expected revenue  while we give the
much stronger guarantee of high-probability revenue approx-
imation  furthermore  our results do not require restrictions
on valuation functions  giving them very broad applicability 
a recent line of work studies learning revenue-maximizing
auctions for limited supply across instances  mohri and med-
ina  2014  morgenstern and roughgarden  2015  balcan et
proceedings of the thirtieth    ijcai-21 
32
 al   2018   these works laid down the framework for under-
standing learning-theoretic quantities related to auctions in
order to prove generalization guarantees  our paper studies
the significantly tougher and unsolved problem of learning
from a single instance for limited supply  we extend the tech-
niques of balcan et al   2005   that can be viewed as learning
within an instance for unlimited supply  and show that learn-
ing theory combined with the power of parameterized auc-
tions provides a way to meaningfully learn within an instance
in the more challenging setting of limited supply 
2
main guarantees of our framework
in this section we present the main guarantees satisfied by
lwi in terms of structural properties of the auction class and
the set of bidders  our guarantees are in terms of partition dis-
crepancy  delineability  and the following quantity that con-
trols the revenue loss incurred by selling only to bidders in
spar  for s′ ⊆ s  let optm s′  = supm∈m revm s′ 
and let lm s′  = optm s′ /w s  
for a given participatory set of bidders spar  partition dis-
crepancy measures the worst-case deviation in an auction
class between the revenue on spar versus the expected rev-
enue on a set of bidders sampled from s\spar  for 0 < q < 1
and spar ⊂ s  partition discrepancy is defined as
τm q  spar  = sup
m∈m
���revm spar  −
e
s0∼qs\spar revm s0  
��� 
partition discrepancy is a measure of both the intrinsic com-
plexity of the class m and the amount of uniformity in the set
s of bidders  we now present general guarantees for lwi in
terms of partition discrepancy  the full derivations are in the
appendix   the guarantees follow from uniform convergence
results  and depend on the expected rademacher complexity
rm n  s \ spar  of m with respect to s \ spar and the
pseudodimension pdim m  of m  we provide definitions
and some standard results from learning theory that we use in
our proofs in the appendix  �
m denotes the empirical-revenue-
maximizing mechanism used by lwi 
theorem 1  let spar denote the participatory set of bidders
chosen by a run of lwi  then  with probability ≥ 1 − 2δ
over the draw of s1          sn ∼q s \ spar   a  rev �
m spar  ≥
w s 
�
lm spar  − 4rm n  s \ spar  −
�
2 ln 1/δ /n
�
−
2τm q  spar  and  b  rev �
m spar 
≥
w s 
�
lm spar  −
240
�
pdim m /n −
�
2 ln 1/δ /n
�
− 2τm q  spar  
proof sketch  uniform convergence results relate the empir-
ical revenue of �
m on the learning groups to the optimal ex-
pected revenue on a random learning group  partition dis-
crepancy ties both these quantities to revenue on spar 
if m has finite pseudodimension  this is not necessarily the
case if we only have a bound on rademacher complexity   we
can give an equivalent sample-complexity version of the guar-
antee  let n ε  δ  pdim m   = 4802 pdim m  ln
� 1
δ
�
/ε2 
corollary 1  let spar denote the participatory set of bid-
ders chosen by a run of lwi with parameters p  q  n  where
n ≥ n ε  δ  pdim m    then  with probability ≥ 1 − 2δ
over the draw of s1          sn ∼q s \ spar  rev�
m spar  ≥
w s  lm spar  − ε  − 2τm q  spar  
to understand the pseudodimension of various mechanism
classes  balcan et al   2018  introduced the notion of deline-
ability  a class of mechanisms m is  d  h -delineable if  1 
every m ∈ m can be parameterized by a vector θ ∈ rd  and
 2  for every set s of bidder valuations  there are at most h
hyperplanes partitioning rd such that revs θ   = revθ s  is
linear in θ over each connected component of rd determined
by the hyperplanes  the way we have stated delineability re-
quires h to be independent of the number of bidders in s 
we include an analysis of the case where h is allowed to be
a function of n in the appendix  the following example il-
lustrates delineability in a simple case  balcan et al   2018 
provide more examples and a more detailed discussion 
example 1  second-price auctions with a reserve price   the
class of second-price auctions with reserve prices for selling
a single item is  1  2 -delineable  indeed  if v1 and v2 are
highest and second-highest values for the item  respectively 
then for r < v2 the revenue of a second-price auction with
reserve r is v2  for v2 ≤ r ≤ v1 it is r  and for r > v1 it is 0 
rademacher complexity  pseudodimension  and delin-
eability are connected through the following relations 
rm n  slrn  ≤ 60w s 
�
pdim m /n  dudley  1987 
and if m is  d  h -delineable  pdim m  ≤ 9d ln 4dh   bal-
can et al   2018  
we present our main guarantee in terms of delineability 
theorem
2 
suppose
m
is
 d  h -delineable 
let
spar denote the participatory set of bidders chosen by
a run of lwi with parameters p  q  n  where n
≥
n ε  δ  9d ln 4dh    then  with probability ≥ 1 − 2δ over
the draw of s1          sn
∼q
s \ spar  rev�
m spar  ≥
w s  lm spar  − ε  − 2τm q  spar  
we provide analogous guarantees for mechanism classes
that satisfy a version of delineability that is dependent on the
number of bidders in the appendix 
2 1
partition discrepancy
in this section we develop a further understanding of partition
discrepancy  we first provide two examples illustrating struc-
tural properties of partition discrepancy  we then provide a
general-purpose high-probability bound on partition discrep-
ancy based on pseudodimension of the mechanism class 
the first example relates the failure of vanilla random sam-
pling to large partition discrepancy using the scenario given
in the introduction  we show how lwi alleviates that issue 
example 2  lwi versus random sampling   consider the ex-
ample from the introduction where a single item is for sale
and m is the class of second-price auctions with reserve 
there is one bidder with value 10  and all remaining bid-
ders  values are in  0  9   suppose lwi is run with parameters
p = 1/2  q = 1  which corresponds to vanilla random sam-
pling   then  for any participatory set spar  τm 1  spar  =
10 = w s   achieved by setting a reserve price of 10  if
instead lwi was run with parameters p = q < 1  the high
bidder is in s \ spar with probability 1 − p  and in this case
proceedings of the thirtieth    ijcai-21 
33
 τm q  spar  = 10q if  for example  p = q = 1/20  this is a
small additive loss in the overall revenue guarantee 
the next example involves replica economies  where the
set of bidders is composed of several copies of a ground set
of bidders  replica economies have been studied extensively
in economics  and recently from an algorithmic viewpoint  in
the context of convergence to equilibria  debreu and scarf 
1963  aumann  1964  barman and echenique  2020  
example 3  replica economies   suppose s0 =  v1  v2  v3  
and s consists of n0 replicas of s0  let m be a population-
size-independent auction class  we show in the appendix that
if n0 is sufficiently large  τm 1  spar  = 0 with high proba-
bility over the draw of spar ∼1/2 s 
we now present a general bound on partition discrepancy
in terms of the learning-theoretic complexity of m when lwi
is run with parameters p = 1/3 and q = 1/2  for each bidder
i  let ˜vi = max|s′|≥n/3−5√n supm∈m |revm s′ ∪  i   −
revm s′ | and let ˜v =  ˜v1          ˜vn  ∈ rn  these terms
measure how sensitive the mechanism class is to the addition
of a single bidder to an already large set of bidders  in the
following results on partition discrepancy  we condition on
the  probability ≥ 1 − e−25  event that |spar| ≥ n/3 − 5√n 
theorem
3 
with
probability
≥
1
−
δ
over
the
draw
of
spar
∼1/3
s 
τm 1/2  spar 
≤
||˜v||2
�
2n pdim m  ln 4e2 pdim m w  s 
δ
 
proof sketch  we bound τm for a single mechanism m us-
ing concentration bounds  we then apply a union bound over
a learning-theoretic cover of m  classical learning-theory
results bound the cover size in terms of pdim m  
combined with corollary 1  we have 
theorem 4  run lwi with parameters n  p = 1/3  q =
1/2  where n ≥ n ε  δ  pdim m   
then  with proba-
bility ≥ 1 − 3δ  rev�
m spar  ≥ w s  lm spar  − ε  −
2||˜v||2
�
2n pdim m  ln 4e2 pdim m w  s 
δ
 
when w s  is sufficiently large  we can condense the
bound on partition discrepancy to contribute at most an ε loss 
corollary 2  run lwi with parameters n  p
=
1/3 
q
=
1/2 
where
n
≥
n ε  δ  pdim m   
if
w s 2
−
8n||˜v||2
2 pdim m 
ε2
ln w s  
≥
8n||˜v||2
2 pdim m 
ε2
ln
� 4e2 pdim m 
δ
�
 
rev�
m spar 
≥
w s  lm spar  − 2ε  with probability ≥ 1 − 3δ 
remark  we emphasize that small partition discrepancy  for
example  stipulating that τm is a fixed constant  should be
viewed as a uniformity condition on the set of bidders  the-
orem 3 provides just one way of understanding partition dis-
crepancy by relating it to learning-theoretic quantities 
3
population-size-independent auctions
in this section we instantiate our main guarantee for spe-
cific mechanism classes m to obtain more concrete revenue
approximations  the following is a na¨ıve lower bound on
lm spar  for auction classes that can run a second-price
auction on the grand bundle  1          m  with a reserve price 
proposition 1  let v1 ≥ · · · ≥ vn denote the valuations of
each bidder in s on the grand bundle  for any 0 < α ≤ 1
such that αn is an integer  any mechanism class m contain-
ing the second-price auction on the grand bundle with reserve
price r for every r satisfies lm spar  ≥
vαn
w  s  with proba-
bility ≥ 1 − e−αnp over the draw of spar ∼p s 
however  any bidder s value for the grand bundle can be an
arbitrarily bad approximation to w s   in the remainder of
the paper we introduce some new auction classes and prove
more fine-tuned approximations for those classes 
we now study a handful of population-size-independent
auction classes  that is  auction classes that can be parame-
terized in a way that does not depend on the number of bid-
ders  traditional variants to the vcg auction including λ-
auctions and amas specify boosts based on particular alloca-
tions and are thus not independent of the population size  and
in particular cannot be used with lwi in a natural way since
s1          sn  spar can all vary in size   in contrast to these 
our auctions specify boosts based on bundles and bundlings 
a bundling is a partition of items  1          m  into bun-
dles  we say that an allocation respects a bundling if no two
items in the same bundle are allocated to different buyers 
for an allocation β  let blg β  denote the finest bundling re-
spected by β  that is  the bundling with the fewest number of
bundles that β respects  for example  if β allocates items
1 and 3 to bidder 1  and the remaining items to bidder 2 
blg β  =   1  3    2  4          m    let φ denote the collec-
tion of all bundlings  |φ| <  0 792m/ ln m   1  m  berend
and tassa  2010   we now introduce two new auction classes
that can be viewed as population-size-independent analogues
of λ-auctions and vvcas  respectively 
the class of bundling-boosted auctions is the class auctions
parameterized by real |φ|-dimensional vectors ω ∈ r|φ| that
specify additive boosts ω φ  for each bundling φ ∈ φ  the
overall allocation α∗ used by a bundling-boosted auction ω is
chosen to maximize w α    ω blg α    and bidder i pays
maxα w−i α    ω blg α    −  w−i α∗  − ω blg α∗    
equivalently  ω is the λ-auction with λ α  = ω blg α   
the class of bundle-boosted auctions is the class of auc-
tions parameterized by real 2m-dimensional vectors ω ∈
r2m that specify additive boosts ω b  for each bundle b ⊆
 1          m   the overall allocation α∗ is chosen to maximize
w α    �
b∈blg α  ω b   and bidder i pays maxα w−i α   
�
b∈blg α  ω b   −  w−i α∗    �
b∈blg α∗  ω b    equiva-
lently  the class of bundle-boosted auctions is the subclass of
vvcas where the parameters are constant across bidders 
the class of bundling-vcg auctions  kroer and sandholm 
2015  consists of all φ-vcg auctions  where a φ-vcg auc-
tion runs vcg while treating each bundle in φ as an indivisi-
ble item  the class of bundling-vcg auctions is a subclass of
the class of bundle-boosted auctions  the φ-vcg auction can
be represented by the bundle-boosted auction with ω b  = 0
if b can be represented as a union of bundles from φ  and
ω b  = −∞ otherwise  the class of bundle-boosted auc-
tions is a subclass of the class of bundling-boosted auctions 
a bundle-boosted auction is a bundling-boosted auction with
the restriction that ω φ  = �
b∈φ ω b  
since bundling-boosted and bundle-boosted auctions are
proceedings of the thirtieth    ijcai-21 
34
 bundle-boosted
auctions
bundling-vcg
auctions
bundling-boosted
auctions
⊂
⊂
bundle-size-
boosted auctions
⊂
mixed-bundling auctions
⊂
virtual-valuation
combinatorial auctions
⊂
λ-auctions
affine-maximizer
auctions
⊂
⊂
⊂
figure 1  containment relations between auction classes  new auc-
tion classes introduced in this paper are in boldface 
subclasses of λ-auctions  they are both delineable with
h n  =  n   1 2m 1 due to balcan et al   2018   see the ap-
pendix for a derivation of lwi guarantees when only weaker
delineability parameters that depend on the number of bidders
are known   the following is a much stronger delineability
result that has no dependence on the number of bidders 
theorem 5  the class of bundling-boosted auctions is
 |φ|  |φ|2   m|φ|3 -delineable and the class of bundle-
boosted auctions is  2m  |φ|2   m|φ|3 -delineable 
proof sketch  we prove that there are at at most m|φ| bidders
whose absence affects the allocations used by any bundling-
boosted auction  this allows us to count the relevant hyper-
planes delineating r|φ| in a way that is independent of n 
sandholm and likhodedov  2005  2015   implicitly  study
properties of the class of auctions parameterized by vectors
ω ∈ rm that specify additive boosts depending on the size of
the bundle  we call this class of auctions bundle-size-boosted
auctions 
bundle-size-boosted auctions are a subclass of
bundle-boosted auctions  the equivalent bundle-boosted auc-
tion satisfies ω b  = ω |b|   for the class of bundle-size-
boosted auctions  we can prove a stronger delineability result 
theorem 6  the class of bundle-size-boosted auctions is
 m  meo √m  -delineable 
figure 1 summarizes the containment relations between the
various auction classes 
3 1
guarantees for bundling-boosted auctions
the class of bundling-boosted auctions is a rich class of auc-
tions  if the efficient allocation when bidder i is absent also
maximizes welfare when all bidders are present among all
allocations respecting the same finest bundling  there is a
bundling-boosted auction that extracts revenue equal to the
welfare of the efficient allocation  more generally 
theorem 7  given a set of s bidders  let β denote
the efficient allocation and let β−i denote the efficient
allocation when bidder i is absent 
let ∆i s 
=
maxα blg α =blg β−i  w α  − w β−i  
there
exists
a
bundling-boosted auction with revenue w s  − �
i ∆i s  
proof sketch  let φ = blg β  and let φ−i = blg β−i   the
bundling-boosted auction with ω φ  = 0  ω φ−i  = w β −
w β−i   and ω φ′  = −∞ for all other bundlings φ′ ∈ φ \
 φ  φ−1          φ−n  extracts the claimed revenue 
we give a simple example of bidder valuations that satisfy
∆i s′  = 0 for every i and every s′ ⊆ s in the appendix 
concentration inequalities enable us to provide bounds
on lm spar  for the class of bundling-boosted auctions 
we have espar optm spar  
≥
espar w spar  −
�
i ∆i spar   ≥ pw s  − �
i ∆i spar   if we run lwi
with parameters p  q  n  we have  assuming for readabil-
ity that ∆i spar  = 0 for all i  lm spar  ≥  1 − η p
with probability ≥ 1 − e−2η2p2w  s 2/||¯v||2
2  where ¯v =
 maxb⊆ 1     m  vi b  i∈s ∈ rn  by mcdiarmid s inequality 
combined with theorem 2  we get our main guarantee for
the class of bundling-boosted auctions  for readability  we
state our guarantees assuming ∆i spar  = 0 for every i 
theorem 8  let m be the class of bundling-boosted auc-
tions  let n ≥ n ε  δ  pdim m   and run lwi with pa-
rameters n  p  q  as long as w s 2 ≥ ||¯v||2
2 ln 1/δ /2η2p2 
rev�
m spar  ≥ w s   1 − η p − ε  − 2τm q  spar  with
probability ≥ 1 − 3δ conditional on ∆i spar  = 0 for all i 
removing the assumption on ∆i spar  would replace the
 1 − η p loss term with  1 − η  p − �
i ∆i spar /w s   
4
efficient learning within an instance
we now explore two mechanism classes for which lwi can
be implemented efficiently by leveraging efficient routines for
solving winner determination  a generalization of the prob-
lem of computing efficient allocations   though computing
�
m = argmaxm∈m
1
n
�n
t=1 revm st  is np-hard since it
involves solving winner determination  which is well known
to be np-hard  winner determination can be solved efficiently
in practice  sandholm et al   2005  
for the class of bundling-vcg auctions  we show that the
branch-and-bound technique of kroer and sandholm  2015 
is compatible with lwi  we did not derive a revenue-
guarantee for this class of auctions  however  for the class
of sparse bundling-boosted auctions  which are bundling-
boosted auctions with a constant number of positive boosts 
we show that a revenue guarantee similar to  but more sample
efficient than  theorem 8 holds  we then show how lwi can
be efficiently implemented for this class 
4 1
bundling-vcg auctions
kroer and sandholm  2015  give a branch-and-bound al-
gorithm to compute the revenue-maximizing bundling-vcg
auction for a given set of bidders  while our setting is dif-
ferent than theirs  their integer-program techniques can be
directly used by lwi  let f denote a function used as an
upper bound in branch-and-bound to compute the optimal
bundling 
for learning groups s1          sn and x a node
in the search tree  corresponding to a partial bundling   let
ˆf x  =
1
n
�
t f x  st   recall that f is admissible if its
value at any node is an upper bound for the maximum revenue
obtainable in the subtree rooted at that node  and f is mono-
tonic if it decreases down each path in the search tree  these
properties ensure that branch-and-bound finds the revenue-
optimal bundling 
proceedings of the thirtieth    ijcai-21 
35
 proposition 2  if f is admissible for computing the optimal
bundling  ˆf is admissible for computing the empirically opti-
mal bundling  the same holds for monotonicity 
4 2
sparse bundling-boosted auctions
let φ0 ⊂ φ with |φ0| = b  and let m0 be the number
of bundles in the finest bundling in φ0  consider the sub-
class of bundling-boosted auctions for which ω φ  > 0 only
if φ ∈ φ0  and ω φ  = 0 otherwise   which we call φ0-
bundling-boosted auctions  the same argument used to prove
theorem 5 shows that the class of φ0-bundling-boosted auc-
tions is  b  b2  m0b3 -delineable  let w φ0 s  denote the
welfare of the welfare-maximizing allocation to bidders in s 
subject to the constraint that the finest bundling respected by
the allocation is in φ0  the same arguments used to obtain
theorem 7 yield a guarantee with respect to w φ0 s  
theorem 9  let m be the class of φ0-bundling-boosted auc-
tions  let n ≥ n ε  δ  pdim m   and run lwi with param-
eters n  p  q  as long as w φ0 s 2 ≥ ||¯v||2
2 ln 1/δ /2η2p2 
rev�
m spar  ≥ w φ0 s   1 − η p − ε  − 2τm q  spar  with
probability ≥ 1 − 3δ conditional on ∆i spar  = 0 for all i 
for b a fixed constant  the number of learning groups n
required by lwi is o b ln m0b    hiding the dependence
on ε and δ   in contrast  optimizing over the entire class of
bundling-boosted auctions as in theorem 8 would require n
to be exponential  in m   for this class of auctions  we de-
scribe an algorithm that implements lwi with run-time expo-
nential in b but polynomial in all other parameters  includ-
ing the run time of the winner determination routine used   a
similar algorithm was used in balcan et al   2020   though in
a different setting than ours 
theorem 10  let b
= |φ0|  and let m0 be the num-
ber of bundles in the finest bundling in φ0 
given
learning groups s1          sn  the empirical-revenue maxi-
mizing φ0-bundling-boosted auction can be computed in
 nm0b o b    2w m0  n nm0b time  where w m0  n  is
the time required to solve winner determination for n buyers
with valuations over m0 items 
proof sketch  we first show that there is a set h of at most
nb2   nm0b2 hyperplanes partitioning rb such that em-
pirical revenue is linear in ω within each region  writing
these hyperplanes down requires at most nb   nm0b calls
to our winner determination routine  the maximum empiri-
cal revenue in each region can be found by solving a linear
program with b variables and at most |h| constraints 
4 3
structural revenue maximization
suppose the mechanism designer can only sample a limited
number n of learning groups  due to a run-time constrant 
for example   we introduced several new auction classes 
but which one should the mechanism designer use in con-
junction with lwi  structural revenue maximization  srm 
helps answer this question  srm suggests maximizing em-
pirical revenue minus a regularization term that penalizes
more complex mechanisms to ensure that the chosen auc-
tion is indeed likely to generalize well  rather than overfit-
ting to the learning groups  our generalization guarantee in
theorem 1 provides the appropriate regularizer εm n  δ  =
240
�
pdim m /n  
�
2 ln 1/δ /n  say the mechanism
designer is deciding between auctions in m1 and auctions in
m2  let �
m1  �
m2 be the empirical-revenue-maximizing auc-
tions from m1 and m2  respectively  for one run of lwi  the
mechanism designer should use mechanism �
mk  k ∈  1  2  
that maximizes 1
n
�
t rev�
mk st  − εmk n  δ  since empir-
ical revenue minus εm n  δ  is a more accurate lower bound
on expected revenue than empirical revenue alone  an srm
approach combined with lwi is incentive compatible since
the final mechanism only depends on the learning groups of
bidders  our use of srm is similar to srm across instances 
which was discussed in balcan et al   2018   srm for auc-
tion design was first proposed by balcan et al   2005   also
for learning within an instance  but for unlimited supply  
5
conclusions and future research
we developed a new framework for designing truthful  high-
revenue combinatorial auctions for limited supply  our mech-
anism learns within an instance  it generalizes and improves
over previously-studied random-sampling mechanisms 
we proved guarantees on the performance of lwi based
on a market-shrinkage term and a new complexity measure
we coined partition discrepancy  which simultaneously mea-
sured intrinsic complexity of the auction class and unifor-
mity in the set of bidders  we explored examples and proved
a general bound on partition discrepancy 
we then intro-
duced new population-size-independent auction classes  and
proved strong generalization bounds for these classes  we
showed how lwi can be implemented efficiently by lever-
aging practically-efficient routines for solving winner deter-
mination  and showed how structural revenue maximization
helps choose the right auction class to prevent overfitting 
many interesting new directions arise from this work 
first  developing a fuller picture of partition discrepancy
would be of independent interest both in mechanism design
and learning theory more broadly 
next  population-size-
independent auctions are more versatile than other auction
formats since they may be designed and specified without
knowledge of the number of bidders participating  a fur-
ther study of such auctions could yield insights into other
revenue-maximization settings  for example  when the dis-
tribution over bidders is known  when the number of bidders
is unknown  finally  lwi-like frameworks could be applica-
ble to more general mechanism design settings that involve
optimization subject to incentive-compatibility constraints 
acknowledgements
this material is based on work supported by the nsf under
grants iis-1618714  iis-1718457  iis-1901403  and ccf-
1733556  ccf-1535967  ccf-1910321  and ses-1919453 
the aro under award w911nf2010081  darpa under co-
operative agreement hr00112020003  an aws machine
learning research award  an amazon research award  a
bloomberg research grant  and a microsoft research fac-
ulty fellowship 
proceedings of the thirtieth    ijcai-21 
36
 references
 alaei et al   2009  saeed alaei  azarakhsh malekian  and
aravind srinivasan  on random sampling auctions for dig-
ital goods  in ec  2009 
 aumann  1964  robert j aumann  markets with a contin-
uum of traders  econometrica  1964 
 balcan et al   2005  maria-florina balcan  avrim blum  ja-
son d hartline  and yishay mansour  mechanism design
via machine learning  in focs  2005 
 balcan et al   2007  maria-florina balcan  nikhil devanur 
jason d hartline  and kunal talwar  random sampling
auctions for limited supply 
2007 
technical report 
carnegie mellon university 
 balcan et al   2008  maria-florina balcan  avrim blum 
and yishay mansour  item pricing for revenue maximiza-
tion  in ec  2008 
 balcan et al   2018  maria-florina balcan  tuomas sand-
holm  and ellen vitercik  a general theory of sample com-
plexity for multi-item profit maximization  in ec  2018 
 balcan et al   2020  maria-florina
balcan 
siddharth
prasad  and tuomas sandholm  efficient algorithms for
learning revenue-maximizing two-part tariffs  in ijcai 
2020 
 barman and echenique  2020  siddharth barman and fed-
erico echenique 
the edgeworth conjecture with small
coalitions and approximate equilibria in large economies 
in ec  2020 
 berend and tassa  2010  daniel berend and tamir tassa 
improved bounds on bell numbers and on moments of
sums of random variables  probability and mathematical
statistics  2010 
 chakraborty et al   2013  tanmoy
chakraborty 
zhiyi
huang  and sanjeev khanna  dynamic and nonuniform
pricing strategies for revenue maximization 
siam
journal on computing  2013 
 clarke  1971  ed h  clarke 
multipart pricing of public
goods  public choice  1971 
 conitzer and sandholm  2002  vincent conitzer and tuo-
mas sandholm  complexity of mechanism design  in uai 
2002 
 cramton et al   2006  peter cramton  yoav shoham  and
richard steinberg  combinatorial auctions  mit press 
2006 
 debreu and scarf  1963  gerard debreu and herbert scarf 
a limit theorem on the core of an economy  international
economic review  1963 
 devanur and hartline  2009  nikhil r devanur and jason d
hartline 
limited and online supply and the bayesian
foundations of prior-free mechanism design  in ec  2009 
 devanur et al   2015  nikhil r devanur  jason d hartline 
and qiqi yan  envy freedom and prior-free mechanism
design  journal of economic theory  2015 
 dudley  1987  richard m dudley 
universal donsker
classes and metric entropy 
the annals of probability 
1987 
 goldberg et al   2001  andrew v goldberg  jason d hart-
line  and andrew wright  competitive auctions and digital
goods  in soda  2001 
 groves  1973  theodore groves 
incentives in teams 
econometrica  1973 
 jehiel et al   2007  philippe jehiel  moritz meyer-ter-vehn 
and benny moldovanu  mixed bundling auctions  journal
of economic theory  2007 
 kroer and sandholm  2015  christian kroer and tuomas
sandholm  computational bundling for auctions  in aa-
mas  2015 
 likhodedov and sandholm  2004  anton likhodedov and
tuomas sandholm  methods for boosting revenue in com-
binatorial auctions  in aaai  2004 
 likhodedov and sandholm  2005  anton likhodedov and
tuomas sandholm  approximating revenue-maximizing
combinatorial auctions  in aaai  2005 
 mohri and medina  2014  mehryar
mohri
and
andres
mu˜noz medina  learning theory and algorithms for rev-
enue optimization in second price auctions with reserve 
in icml  2014 
 morgenstern and roughgarden  2015  jamie
h
morgen-
stern and tim roughgarden 
on the pseudo-dimension
of nearly optimal auctions  in nips  2015 
 roberts  1979  kevin roberts  the characterization of im-
plementable social choice rules  in j-j laffont  editor  ag-
gregation and revelation of preferences  1979 
 sandholm and likhodedov  2015  tuomas sandholm and
anton likhodedov 
automated design of revenue-
maximizing combinatorial auctions  operations research 
2015 
 sandholm et al   2005  tuomas sandholm  subhash suri 
andrew gilpin  and david levine  cabob  a fast op-
timal algorithm for winner determination in combinatorial
auctions  management science  2005 
 sandholm  2003  tuomas sandholm 
automated mecha-
nism design  a new application area for search algorithms 
in cp  2003 
 tang and sandholm  2012  pingzhong tang and tuomas
sandholm  mixed-bundling auctions with reserve prices 
in aamas  2012 
 vickrey  1961  william vickrey  counterspeculation  auc-
tions  and competitive sealed tenders  journal of finance 
1961 
proceedings of the thirtieth    ijcai-21 
37
 "
None,2021,0005,Combining Fairness and Optimality when Selecting and Allocating Projects,"Khaled Belahcène, Vincent Mousseau, Anaëlle Wilczynski",abstract comes here,https://www.ijcai.org/proceedings/2021/0006.pdf,data/fulltext/pdf/2021/0005.pdf,../vikus-viewer/data/fulltext/pdf/2021/0005.pdf,"combining fairness and optimality when selecting and allocating projects
khaled belahc ene1   vincent mousseau2 and ana¨elle wilczynski2
1universit e de technologie de compi egne  cnrs  heudiasyc
2mics  centralesup elec  universit e paris-saclay
khaled belahcene@hds utc fr   vincent mousseau  anaelle wilczynski @centralesupelec fr
abstract
we consider the problem of the conjoint selec-
tion and allocation of projects to a population of
agents  e g  students are assigned papers and shall
present them to their peers  the selection can be
constrained either by quotas over subcategories of
projects  or by the preferences of the agents them-
selves  we explore fairness and optimality issues
and refine the analysis of the rank-maximality and
popularity optimality concepts  we show that they
are compatible with reasonable fairness require-
ments related to rank-based envy-freeness and can
be adapted to select globally good projects accord-
ing to the preferences of the agents 
1
introduction
when allocating indivisible resources to a group of agents 
optimality and fairness are key considerations in order to sat-
isfy the agents with their assigned resources  bouveret et al  
2016   however  when not all resources are to be assigned 
the choice of the assigned resources may be particularly im-
portant  many real-world situations can illustrate this issue 
a first context concerns a university course where students
must be assigned to projects they have to work on  and present
to their peers at the end of the course  usually  an allocation
that takes into account the preferences of the students is desir-
able in order to motivate them to work  an optimal allocation
of projects to the students should maximize the global satis-
faction of the students  this allocation must also be fair oth-
erwise students could complain about the assignment  how-
ever  the choice of selected projects can also be fundamental
for pedagogical reasons  not all students should present simi-
lar projects since it is expected that even attendants will learn
from the presentations  therefore  some diversity constraints
according to the topics of the projects must be considered 
another example concerns the organization of a confer-
ence with invited speakers 
suppose each of the speak-
ers must be assigned a one hour time slot from monday to
wednesday  9 00-19 00   in such a context  speakers can ex-
press preferences over time slots  e g  preferably in the morn-
ing or early in the conference   the decisions to make involve
selecting time slots for presentations  and the allocation of a
time slot for each speaker  solving such selection/allocation
should account for the preferences of speakers both for the
conference timetable  and for the time of their presentation 
the two preceding examples involve agents and many re-
sources  more than the number of agents   referred to as
projects  to be assigned to agents by a central authority  the
assignment must be optimal and fair for the agents  and at the
same time the set of assigned projects should be selected re-
garding balance constraints with respect to groups of projects
 topics  days  or preferences of the agents  hence it can be
seen as a combination of multiwinner voting  elkind et al  
2017  faliszewski et al   2017   we want a good selection of
projects  and resource allocation problems  we want a fair
and optimal assignment of projects to agents  
in this paper  we focus on house allocation problems  hyl-
land and zeckhauser  1979  abdulkadiroˇglu and s¨onmez 
1998   where each agent must be assigned exactly one
project  optimality questions have been widely investigated 
especially with respect to pareto-optimality  abraham et al  
2004  and its refinements  such as rank-maximality  irving 
2003  irving et al   2006  and popularity  abraham et al  
2007  cseh  2017   concerning fairness  the most classical
criterion  envy-freeness  foley  1967  varian  1974   requires
that no agent prefers the project assigned to another agent
to her own assigned project  this criterion is too demand-
ing if the number of projects equals the number of agents 
hence  some relaxations of envy-freeness have been pro-
posed  beynier et al   2019   however  envy-freeness is more
interesting when there are more projects than agents  gan et
al   2019  
we focus in this article on a relaxation of envy-freeness 
called rank-envy-freeness  which requires that no agent
prefers the project assigned to another agent whereas she
ranked this project in a better position in her preference rank-
ing  this notion is present in the favoring higher ranks con-
cept introduced by ramezanian and feizi  2020   was im-
plicitly used by kojima and ¨unver  2014   and is equivalent
to no envy by rank in random assignment  harless  2018   we
propose a generalization of rank-envy-freeness and introduce
another concept  frustration-freeness  which relates both allo-
cation and selection issues  frustration-freeness imposes that
no agent prefers an unassigned project to her assigned project 
focusing on the personal satisfaction of an agent  it can be
viewed as a fairness concept  but also as an optimality concept
because it asks for no project waste  whereas optimality and
proceedings of the thirtieth    ijcai-21 
38
 fairness are often incompatible  bouveret and lang  2008  
we show that rank-envy-freeness and frustration-freeness are
necessary to characterize rank-maximality and popularity 
for choosing an adequate set of selected projects at the
same time as a good allocation of projects to agents  we inves-
tigate two ways  considering hard diversity constraints repre-
sented by lower and upper quotas over categories  or consid-
ering the preferences of the agents over the selected projects 
diversity constraints are relevant in multiwinner voting
when a committee with particular attributes is sought  brams 
1990  bredereck et al   2018   in resource allocation  it has
been investigated  e g   in public housing allocation  benab-
bou et al   2018   and in course allocation  cechl arov a and
fleiner  2017  where courses have capacities and open only if
a lower quota of participants is reached 
when preferences of the agents are taken into account for
selecting the projects to assign  a naive strategy is to first se-
lect the projects via a multiwinner voting rule and then al-
locate the projects  nevertheless  this approach may lead to
select projects that do not fit any agent personally  like in the
conference example  conversely  by only considering alloca-
tion purposes  one could impose conference days where only
a few attendants can be present  our model can be seen as a
particular case of house allocation with externalities where
agents care about their assignment and the set of selected
projects  but not about the identity of the owners   in the no-
tion of envy-freeness conditioned to the approval of the ma-
jority of agents  shams et al   2020   agents can also give their
opinion about the assignment of other agents  but there is no
concern of the set of selected projects  the goal of our arti-
cle is to find a reasonable way to combine both allocation and
selection goals  by focusing on fairness and optimality issues 
2
allocation of projects
we consider a set of agents n =  n   =  1          n  and a
set of projects p =  p1          pm  with m ≥ n  each agent
i has ordinal preferences over projects  represented by a lin-
ear order ≻i over p  a feasible allocation σ   n → p is
a matching  perfect w r t  the agents  where every agent is
assigned to exactly one project and no two agents share the
same project  i e   σ i  ̸= σ j  for every agents i ̸= j and
σ i  ∈ p denotes the project assigned to agent i in allocation
σ  typically  some projects may not be assigned  let pσ de-
note the set of assigned projects in allocation σ  i e   pσ  =
 p ∈ p   ∃i ∈ n such that σ i  = p   an instance of the
selection-allocation  sa  problem is i =  n  p   ≻i i∈n  1
2 1
finding an optimal and fair allocation
an allocation σ is pareto-optimal  po  if there is no feasible
allocation σ′ such that σ′ i  ⪰i σ i  for every agent i and
there exists an agent j such that σ′ j  ≻j σ j   in an or-
dinal setting  po can be refined with rank-maximality  rm  
the signature ρσ of allocation σ is the m-vector giving the
number of agents ρσ k  assigned to their kth most preferred
project in σ  for all k ∈  m   signature ρσ is lexicographically
strictly greater than signature ρσ′  denoted by ρσ >lex ρσ′  if
1the problem is similar to house allocation but we use a different
name to emphasize the combined goal of selection and allocation 
there exists an index i ∈  m  such that ρσ i′  = ρσ′ i′  for
all i′ < i and ρσ i  > ρσ′ i   an rm allocation can be
computed in polynomial time  irving et al   2006  
definition 1  rank-maximality  rm    an allocation σ is
rm if there is no feasible allocation σ′ such that ρσ′ >lex ρσ 
popularity is another optimality measure that refines po 
agent i prefers allocation σ to allocation σ′ if σ i  ≻i σ′ i  
an allocation σ is then more popular than another allocation
σ′ if the number of agents who prefer σ to σ′ is strictly greater
than the number of agents who prefer σ′ to σ 
definition 2  popularity  pop    an allocation σ is popular
if there is no feasible allocation σ′ more popular than σ 
a pop allocation may not exist but existence can be ef-
ficiently checked and  in the positive case  a pop allocation
can be computed in polynomial time  thanks to the following
characterization due to abraham et al   2007   an allocation
σ is pop iff  1  every first-ranked project is assigned in σ  and
 2  σ assigns to every agent either her first-ranked project or
the most preferred project that is not ranked first by an agent 
fairness issues can also be considered  we relax envy-
freeness with rank-envy-freeness  where an agent i is envious
towards an agent j only if agent i ranks the envied project in
a better position in her preference ranking than agent j  let
ri   p →  m  be the function giving the rank of a project in
≻i  i e   ri x  = | y ∈ p   y ⪰i x |  for project x ∈ p 
definition 3  rank-envy-freeness  r-ef    allocation σ is r-
ef if σ i  ≻i σ j  or rj σ j   ≤ ri σ j   for every i  j ∈ n 
a rank-maximal or popular allocation is also r-ef 
proposition 1  rm ⇒ r-ef and pop ⇒ r-ef 
proof  suppose that an rm allocation σ is not r-ef  there
exist agents i and j such that σ j  ≻i σ i  and ri σ j   <
rj σ j    hence  both ri σ j   < rj σ j   and ri σ j   <
ri σ i   hold  thus  by swapping the projects of i and j  we
get an allocation σ′ such that ρσ′ >lex ρσ  a contradiction 
suppose that a pop allocation σ is not r-ef  there ex-
ist agents i and j such that σ j  ≻i σ i  and ri σ j   <
rj σ j   
by rank-envy  neither agent i nor agent j is
assigned her first-ranked project in σ so  by abraham et
al   2007  s characterization  they are both assigned her most
preferred project that is not ranked first by an agent  since i
prefers σ j  to σ i   project σ j  must be ranked first by some
agent  contradicting the fact that agent j is assigned her most
preferred project that is not ranked first by any agent 
the reverse of both implications is not true  since r-ef does
not even imply po  moreover  although both rm and pop
imply r-ef  it is not true for their weaker requirement po 
example 1  for r-ef ̸⇒ po  simply consider an instance
with two agents and three projects with the following prefer-
ences  p1 ≻1 p2 ≻1 p3 and p1 ≻2 p3 ≻2 p2  allocation
assigning p2 to agent 1 and p3 to agent 2 is r-ef but not po 
for po ̸⇒ r-ef  consider an instance with three agents and
three projects  the preferences are given below 
1  
p1
≻
p3
≻
p2
2  
p2
≻
p1
≻
p3
3  
p2
≻
p1
≻
p3
proceedings of the thirtieth    ijcai-21 
39
 the encircled allocation is po but not r-ef  agent 1 is
envious towards agent 2 who owns her second ranked project
p1 which is the first-ranked project of agent 1 
for rank 0 ≤ k < m  we define a generalization of r-ef 
definition 4  rankk-envy-freeness  rk-ef    an allocation σ
is rankk-envy-free if for every agents i and j  σ i  ≻i σ j  or
rj σ j   ≤ min ri σ j    k  holds 
note that rk-ef ⇒ rk′-ef for every k′ > k  moreover 
rm−1-ef ⇔ r-ef and r0-ef ⇔ envy-freeness  ef   by the
fact that rm ⇒ r-ef  an rm−1-ef allocation always exists 
however  starting from k = m − 2  an rk-ef allocation may
not exist  as shown in the basic example with three agents and
three projects where every agent has the same preferences 
2 2
towards a good selection
we introduce a simple requirement imposing that no agent
prefers a project that has not even been assigned 
definition 5  frustration-freeness  ff    an allocation σ is
ff if σ i  ≻i p for every agent i and every project p ∈ p \pσ 
when m = n  all projects are selected so every allocation
is ff  frustration is defined according to selected projects  so
it does not say anything about global optimality  in particu-
lar  it is clear that an ff allocation may not be po  however 
conversely  in every sa instance  a po allocation  and thus
an rm or a pop allocation  is ff  otherwise by assigning the
preferred unassigned project to the agent who prefers it over
her current assigned project  we get an allocation that pareto-
dominates it  therefore  an ff allocation always exists 
the issues forbidding r-ef or ff to imply pareto-
optimality can be fixed by combining the two properties 
proposition 2  r-ef   ff ⇒ po 
proof  consider an allocation σ that is r-ef and ff  take an
allocation σ′ that pareto-dominates σ  for every agent i  ei-
ther σ′ i  = σ i   or σ′ i  ≻i σ i   so  by ff  we have pσ =
pσ′  consider an ameliorating cycle  i0  i1          ic−1  ⊆ n
from σ to σ′  i e   σ′ ij−1  = σ ij
mod c  for every j ∈  c  
since σ′ ij−1  = σ ij
mod c  ≻ij−1 σ ij−1   by r-ef we
must have rij
mod c σ ij
mod c   ≤ rij−1 σ ij
mod c   <
rij−1 σ ij−1    for every j ∈  c   a contradiction 
combining ff with r1-ef provides an alternative charac-
terization of pop  an agent i is r1-envious towards an agent j
only if the envied project is not ranked first by agent j 
theorem 1  for every sa instance  pop ⇔ r1-ef   ff 
3
hard constraints over the selected projects
in this section  we assume that the set of projects is parti-
tioned into q groups  i e   p = p1∪· · ·∪pq  and that a feasible
allocation must satisfy some quotas on the selected projects
within groups  let ℓj and uj denote the respective lower and
upper quotas for group pj for j ∈  q   trivially we assume that
ℓj ≤ uj ≤ |pj| for every j ∈  q   an allocation σ is feasible
if ℓj ≤ |pσ ∩ pj| ≤ uj for every j ∈  q   we suppose that
�
j∈ q  ℓj ≤ n ≤ �
j∈ q  uj  otherwise there is no feasible al-
location  an instance of this constrained selection-allocation
 csa  problem is  n  p   ≻i i∈n   pj j∈ q    ℓj  uj j∈ q   
an sa instance is a csa instance where ℓj = 0 and
uj = |pj| for every j ∈  q   an instance is said with no trivial
group upper quota if uj < |pj| for every j ∈  q   let ≻pj
i
be the preference ranking of agent i within group pj  prefer-
ences are group-oriented if every agent i s preferences can be
decomposed w r t  project groups  i e   there is a permutation
τi    q  →  q  such that for every projects p ∈ pj and p′ ∈ pj′ 
p ≻i p′ iff p ≻pj
i
p′ if j = j′ or τi j  < τi j′  otherwise 
contrary to the sa setting  even an rm and pop allocation
may not be ff in a csa instance  because of the constraints
on project groups  even if an ff allocation exists 
example 2  let us consider a csa instance with four agents
and five projects where p1 =  p1  p3  p4   p2 =  p2  p5  
and u1 = 2  the preferences are given below 
1  
p3
≻
p1
≻
p4
≻
p2
≻
p5
2  
p3
≻
p1
≻
p4
≻
p2
≻
p5
3  
p1
≻
p3
≻
p2
≻
p4
≻
p5
4  
p2
≻
p5
≻
p1
≻
p3
≻
p4
the framed allocation is rm with signature  3  0  0  0  1 
and pop  however  it is not ff since agent 1 is frustrated  she
prefers the unassigned project p4  nevertheless  the encircled
allocation  with signature  1  2  1  0  0   is both po and ff 
it follows that the characterization obtained in theorem 1
does not hold in a csa instance  by replacing ff by po  we
can nevertheless keep the validity of necessary conditions 
proposition 3  in every csa instance  pop ⇒ r1-ef   po 
proof  a pop allocation σ is trivially po  suppose that σ is
not r1-ef  there exist agents i and j such that σ j  ≻i σ i 
and rj σ j   > 1  thus  j does not rank σ j  first  if there
exists a project p ∈ pσ assigned to an agent k such that
p ≻j σ j  then  by assigning project σ j  to i  project p to
j and project σ i  to k  we reach an allocation more popular
than σ  i and j are better off and k may be worse off   a con-
tradiction  otherwise  there exists a project p ∈ p \ pσ such
that p ≻j σ j   if p cannot be assigned  it means that it be-
longs to a group pℓ whose upper quota uℓ is reached  by re-
moving from pσ an arbitrary project belonging to pℓ\ σ j  
that was assigned to an agent k  we can assign p to j  σ j 
to i and an arbitrary project respecting the constraints to k 
this new allocation is more popular than σ  i and j are bet-
ter off and k may be worse off   a contradiction  if there is
no assigned project belonging to pℓ different from σ j   then
uℓ = 1 and pσ ∩ pℓ =  σ j    hence  σ i  /∈ pℓ and reas-
signing project p to j instead of σ j  is feasible and construct
an allocation more popular than σ  a contradiction 
however  r1-ef   po ̸⇒ pop  as illustrated below 
example 3  let us consider a csa instance with three agents
and four projects where p1 =  p1  p4   p2 =  p2  p3  and
u1 = 1  the preferences are given below 
1  
p1
≻
p3
≻
p2
≻
p4
2  
p2
≻
p3
≻
p1
≻
p4
3  
p2
≻
p4
≻
p1
≻
p3
the encircled allocation is po and r1-ef but not popular 
the framed allocation is both rank-maximal and popular 
proceedings of the thirtieth    ijcai-21 
40
 in example 2  the intersection between the set of rm or
pop allocations and the set of ff allocations is empty  how-
ever  this does not hold for the weaker requirement po  if an
ff allocation exists  then an allocation that is both po and ff
exists  it suffices to start a top-trading cycle algorithm  shap-
ley and scarf  1974  from an ff allocation  in general  an
ff allocation may not exist  consider an instance with two
agents where their first-ranked projects are p1 and p2  respec-
tively  which belong to the same group with upper quota one 
moreover  deciding the existence of ff allocations is hard 
theorem 2  it is np-complete to decide whether there exists
an ff allocation in a csa instance  even either under group-
oriented preferences or with no trivial group upper quota 
in theorem 2 s reduction  preferences are group-oriented
or there is no trivial group upper quota  but not both simul-
taneously  indeed  under both restrictions  one can decide in
polynomial time about the existence of an ff allocation 
proposition 4  the existence of an ff allocation can be de-
cided in polynomial time in every csa instance with no trivial
group upper quota under group-oriented preferences  if ex-
istence is guaranteed  one can then construct an ff and rm
 or pop if exists  allocation in polynomial time 
sketch of proof 
let nj denote the set of agents who
prefer the most the projects in pj  one can show that  under
group-oriented preferences when uj < |pj| for every j ∈  q  
there exists an ff allocation iff ℓj ≤ |nj| ≤ uj for every
j ∈  q   under such conditions  each ff allocation or each
po allocation assigns to each agent in nj a project in pj 
thus  each po allocation is ff and is the concatenation of po
allocations in all sa sub-instances  nj  pj   ≻i i∈nj j∈ q  
recall that in each sa sub-instance  an rm allocation or pop
allocation  if exists  can be found in polynomial time 
4
selecting socially good projects
in this section  we aim to assign projects to the agents such
that the whole set of selected projects is  good  according
to the preferences of the agents  we evaluate the quality of
projects w r t  pairwise comparisons  let n p  p′  denote the
set of agents preferring project p to project p′  a project p is
said to dominate another project p′ if |n p  p′ | > n/2  the
set of projects that dominate project p is denoted by d p  
in a voting setting  when focusing on pairwise comparisons 
it is highly desirable to select a condorcet winner alternative
which dominates all the others  and to not select a condorcet
loser alternative which is dominated by all the others  we
adapt these requirements to the context of allocation 
definition 6  condorcet  winner / loser  criterion   cwc /
clc     allocation σ satisfies cwc if  when there exists a
condorcet winner project p then project p is assigned in σ 
allocation σ satisfies clc if  when m > n and there exists a
condorcet loser project p then project p is not assigned in σ 
there is already a conflict between selection and allocation
desiderata since the two condorcet axioms for selection can
be incompatible with ff  and thus po  rm and pop  
proposition 5  cwc or clc is incompatible with ff 
proof  let us consider an instance with n > 2 agents where
the preferences are given below 
1  
pcl
≻
pcw
≻
    
2  
p2
≻
pcw
≻
    
≻
pcl
     
n  
pn
≻
pcw
≻
    
≻
pcl
ff imposes to select all n first-ranked projects  and thus
condorcet loser pcl but not condorcet winner pcw  
preferences ≻ over single projects can be extended to sets
of projects by using a preference extension ≻ext  a pref-
erence extension ≻ext satisfies responsiveness  roth  1985 
barber a et al   2004  if ∀x ∈ x ⊂ p and ∀y ∈ p \ x 
 x\ x  ∪ y  ≻ext x holds iff y ≻ x holds  the responsive
set extension ≻rs is the minimal partial order that satisfies
responsiveness  we also consider extension ≻rs−  a weaker
version of ≻rs where transitivity is dropped  although the
latter notion may appear unnatural for modelling preferences 
in the context of an sa instance  it means that if two sets of
selected projects are too different then only the quality of the
allocation matters  when referring to a given preference ex-
tension ≻ext  we assume that each agent i uses ≻ext
i
 
we derive a variant of popularity for taking into account the
preferences of the agents over selected projects  let n1 σ′  σ 
denote the number of agents who get a better assignment in
σ′ than in σ  and n≻ext
2
 σ′  σ  the number of agents who get
the same assignment but prefer set pσ′ to pσ w r t  ≻ext 
let np op
≻ext σ′  σ  denote the number of agents who prefer al-
location σ′ to σ in the sense that they prefer to get a better
assigned project and if they keep the same project  they con-
sider the selected projects  i e   np op
≻ext σ′  σ  = n1 σ′  σ   
n≻ext
2
 σ′  σ   allocation σ is more popular w r t  ≻ext than
allocation σ′ if np op
≻ext σ′  σ  > np op
≻ext σ  σ′   this notion
generalizes standard popularity to an sa instance with exter-
nalities where agents care about the other assigned projects 
definition 7  popularity w r t  ≻ext  pop≻ext    an allocation
σ is pop≻ext if there is no other feasible allocation σ′ that is
more popular w r t  preference extension ≻ext 
a pop≻ext allocation may not be pop and vice versa  as
shown in example 4  however  when n = m the two notions
coincide  showing that a pop≻ext allocation may not exist 
an allocation σ satisfies dominion selection  ds  if
�
p∈pσ d p  ⊆ pσ  we show that  for any responsive ≻ext 
pop≻ext satisfies both dominion selection and r1-ef restricted
to the set of selected projects  called rpσ
1 -ef  where there is no
pair of agents i and j such that i prefers the project allocated
to j but this project is not ranked first by j within pσ 
proposition 6  if ≻ext is responsive  pop≻ext ⇒ ds rpσ
1 -ef 
proof  consider a pop≻ext allocation σ  suppose that σ does
not satisfy ds  then  there exists a project p ∈ pσ dominated
by p′ ∈ p \ pσ  consider the allocation σ′ constructed from
σ where agent i who was assigned p in σ is assigned p′  by
definition of dominance  at least ⌈ n 1
2 ⌉ agents prefer σ′ to
σ  a contradiction  suppose now that σ is not rpσ
1 -ef  there
exist agents i and j and project p ∈ pσ such that σ j  ≻i σ i 
proceedings of the thirtieth    ijcai-21 
41
 and p ≻j σ j   consider the allocation σ′ constructed from σ
where agent i is assigned σ j   agent j is assigned p and agent
k who was possessing p is assigned σ i   since pσ = pσ′  we
only need to consider the satisfaction of agents i  j and k  and
two of them  i and j  are better off in σ′  a contradiction 
from the satisfaction of ds  when m > n  a pop≻ext al-
location cannot select a condorcet loser p  for a responsive
≻ext  since p is dominated by at least n other projects  more-
over  a project that dominates at least m − n other projects
must be selected since at least one of its dominated projects
is selected  hence  the condorcet winner is selected 
corollary 1  if ≻ext is responsive  pop≻ext ⇒ cwc   clc 
contrary to standard popularity  as expected from proposi-
tion 5  if ≻ext is responsive  then pop≻ext fails ff  however 
from proposition 6  it satisfies a mild relaxation of ff  impos-
ing to an allocation σ that if there exists a project p ∈ p \ pσ
and an agent i such that p ≻i σ i   then p cannot dominate
any project in pσ  nevertheless  even pop≻rs may fail r-ef 
example 4  let us consider an sa instance with five agents
and six projects where the preferences are given below 
1  
p1
≻
p5
≻
p3
≻
p4
≻
p2
≻
p6
2  
p5
≻
p1
≻
p3
≻
p4
≻
p2
≻
p6
3  
p2
≻
p3
≻
p4
≻
p5
≻
p6
≻
p1
4  
p3
≻
p2
≻
p4
≻
p5
≻
p6
≻
p1
5  
p4
≻
p2
≻
p3
≻
p5
≻
p6
≻
p1
the underlined and encircled allocations are pop≻rs but
the latter is not r-ef  the only pop allocation is framed 
in case of r-ef failure  r-ef swaps can be performed 
agents i and j can swap their projects if i is rank-envious
towards j  we show that r-ef swaps preserve pop≻ext 
proposition 7  for every ≻ext  if a pop≻ext allocation σ ex-
ists  then an allocation that is both pop≻ext and r-ef can be
reached in polynomial time via r-ef swaps starting from σ 
proof  consider a pop≻ext allocation σ that is not r-ef  there
exist two agents i and j such that i is rank-envious towards
j  let σ′ denote the allocation resulting from an r-ef swap
between i and j in σ  we have pσ = pσ′  so n≻ext
2
 σ′  σ  =
n≻ext
2
 σ  σ′  = 0 
by rank-envy  σ′ i  ≻i σ i  
thus 
σ j  ≻j σ i   otherwise i and j would be rpσ
1 -envious in
σ  hence  σ′ is as popular w r t  ≻ext as σ  by rpσ
1 -ef and
ds  if an allocation is more popular w r t  ≻ext than σ′  then
it is also true for σ  a contradiction  hence  σ′ is also pop≻ext 
a pop≻ext allocation σ is pop when p = pσ and the num-
ber of pop allocations is polynomial  mcdermid and irving 
2011   since r-ef swaps transform a pop≻ext allocation σ
to another pop≻ext allocation σ′ where pσ′ = pσ but with
a strictly greater signature w r t  >lex  the dynamics of r-ef
swaps starting from σ converges in polynomial time 
however  although pop≻rs is attractive and despite the fact
that a popular allocation can be computed in polynomial time 
even the verification of a pop≻rs allocation is hard 
theorem 3  checking popularity w r t  ≻rs is co-np-hard 
the complexity proof mostly relies on set comparisons in-
duced by ≻rs  however  an allocation is not pop≻rs if there
exists an unselected project p that is preferred to a selected
project p′ by a  blocking  subset of agents and the remaining
subset of agents can be reassigned such that there are more 
or as many  better off agents than worse off agents  hence 
we conjecture that checking pop≻rs− is also hard 
to circumvent the problem of a blocking subset of agents 
we derive another variant of popularity that takes into account
the preferences of all agents over selected projects  for pref-
erence extension ≻ext  we denote by n≻ext
3
 σ′  σ  the number
of agents who prefer pσ′ to pσ  and define n2p op
≻ext  σ′  σ   =
n1 σ′  σ    n≻ext
3
 σ′  σ  
allocation σ′ is more 2popular
w r t  ≻ext than allocation σ if n2p op
≻ext  σ′  σ  > n2p op
≻ext  σ  σ′  
definition 8  2pop≻ext   allocation σ is  strictly  2popular
w r t  ≻ext if there is no other allocation that is more 2popular
 at least as 2popular  w r t  ≻ext 
2pop≻ext allocations always select a condorcet winner and
strictly 2pop≻ext allocations never select a condorcet loser 
proposition 8  if ≻ext is responsive  2pop≻ext ⇒ cwc and
strict 2pop≻ext ⇒ clc 
moreover  by the same proof idea as proposition 7  for ev-
ery ≻ext  if a 2pop≻ext exists then r-ef swaps can reach in
polynomial time an allocation that is both 2pop≻ext and r-ef 
by slightly adapting the proof of theorem 3  even the ver-
ification of 2pop≻rs is co-np-hard  we consequently focus
on the weaker version of ≻rs where transitivity is dropped 
note that 2pop≻rs− can be characterized based on rpσ
1 -ef  a
refinement of ff and dominance conditions w r t  unassigned
projects  these conditions can be verified in polynomial time 
theorem 4  2pop≻rs− can be verified in polynomial time 
the question of computation for 2pop≻rs− remains open 
5
empirical evaluation of allocations
in this section  we empirically evaluate the quality of different
procedures for assigning projects to agents  both according to
selection and allocation considerations  we generate 100 sa
instances with n = 5 agents and m = 15 projects  correlated
preferences are studied via the single-peaked preference do-
main  a preference ranking ≻i is single-peaked if there exists
a linear order > over p such that for all projects x  y  z with
x > y > z or z > y > x  x ≻i y implies y ≻i z  we
consider three types of preference generation  impartial cul-
ture  ic  where each preference ranking is uniformly drawn
from the set of all possible preference rankings  single-peaked
uniform peak  sp-up  where each single-peaked preference
ranking is generated by first uniformly selecting the peak
project then uniformly choosing the next ranked project ei-
ther on the left of the peak in axis > or on the right and so
on  conitzer  2009   and single-peaked uniform  sp-u  where
each preference ranking is uniformly drawn from the set of all
possible single-peaked rankings  walsh  2015   under sp-u
and sp-up  preferences are correlated w r t  a common axis >
along projects  under sp-up  a preference ranking with  as a
first-ranked project  an extreme point of the axis has the same
proceedings of the thirtieth    ijcai-21 
42
 ic
sp-up
sp-u
3
4
5
6
preferences
average of rank satisfaction
selection
pop
2poprs
2poprs r-ef
rm
bloc
k-borda
k-maximin
k-copeland
mwr pop
mwr rm
r-ef ff dyn 
ic
sp-up
sp-u
1
2
3
4
preferences
allocation
figure 1  average over 100 runs of the rank satisfaction for differ-
ent types of allocations when evaluating the selection  left  or the
allocation  right  for n = 5 and m = 15
probability to occur as one with a middle point of the axis 
hence  the generated preferences are more diverse under sp-
up than under sp-u  where the occurrence of a project at a
certain preference rank depends on a binomial coefficient 
for evaluating the quality of the set of selected projects
 selection goal   we compute the satisfaction of an agent by
considering the average rank in her preference ranking over
all selected projects  the global rank satisfaction is then com-
puted by averaging all individual average rank satisfactions 
for evaluating the quality of the allocation  allocation goal  
we consider the average over all agents of the rank given to
their allocated project  our results are given in figure 1 
all possible allocations are generated and the measures are
given in average for different types of allocations 
• optimal allocations  pop allocations or rm allocations 
• selection-based optimal  sel-opt  allocations  a multiwin-
ner voting rule  mwr  is used for selecting n projects  and
then a pop or an rm allocation is computed on an sa instance
where projects are restricted to this set  we use the following
excellence-based mwrs  bloc  k-borda  k-maximin  and k-
copeland  see faliszewski et al   2017  for definitions  
• selection   allocation  sa -based allocations  2pop≻rs−
allocations  2poprs   2pop≻rs− allocations that are r-ef 
and allocations  r-ef ff dyn   which are the result of the
dynamics of r-ef swaps and ff-agreement moves  an agent i
can get a more preferred unassigned project p if the majority
of agents prefers p to i s project  from a random allocation 
as expected  optimal allocations behave significantly bet-
ter under an allocation goal than sel-opt allocations and
reversely under a selection goal 
our variant of pop 
2pop≻rs−   is not satisfactory under ic where the average
rank satisfactions are always superior than those of pop or
rm  however  it performs a bit better with a selection goal
when preferences are correlated  indeed  under single-peaked
distributions  the satisfaction of condorcet criteria should
help to choose a better set of selected projects  surprisingly 
the stable allocation arising from the dynamics associated
with r-ef swaps and ff-agreement moves appears to be very
good for combining both goals of selection and allocation  it
has an intermediate behavior with an average rank satisfac-
tion closer to those of sel-opt allocations than optimal alloca-
tions with a selection goal  and closer to optimal allocations
than sel-opt allocations with an allocation goal  in average 
ten steps are sufficient to reach a stable allocation so we are
far from the exponential theoretical bound for r-ef swaps 
so far  we have evaluated the quality of an allocation  al-
location goal  via the optimality measure of average rank sat-
isfaction  for fairness  we compute the average minimum
k such that an allocation is rk-ef  our experiments show
that optimal allocations and sa-based allocations are very
fair  however  sel-opt allocations are very unfair in compari-
son  showing the need of combining allocation and selection
goals  in general  a slight tendency confirms the intuition un-
der which correlated preferences favor consensus in selection
whereas diverse preferences favor consensus in allocation 
6
conclusion
we investigated a variant of resource allocation where both
selection and allocation are important  we focused on pop-
ularity  pop  and rank-maximality  rm  optimality concepts
and showed that they are compatible with two notions of fair-
ness that we have introduced or refined  namely frustration-
freeness  ff  and rank-envy-freeness  r-ef   in an ordinal
context  r-ef appears as a very natural and flexible fairness
requirement that could easily be used as an argument for ex-
plaining a decision  the selection goal has been combined
with the allocation goal in two ways  via hard constraints rep-
resented by quotas on project groups or via the preferences of
the agents themselves  under hard constraints  rm and pop
lose their link with ff and this latter basic requirement even
becomes difficult to satisfy  however  we identified natural
restrictions under which the compatibility remains  when the
selection goal is conditioned by the preferences of the agents 
we derive variants of pop that can be connected with r-ef and
that are condorcet-consistent  however the most natural ex-
tension of pop in such a context suffers from a computational
burden  in practice  variants of pop slightly improve pop to-
wards the selection goal  nevertheless  the most interesting
notion empirically is the outcome of the dynamics associated
with r-ef swaps and ff-agreement moves which turns out to
satisfy the goal of combining both selection and allocation 
many interesting directions can be explored  technically 
some algorithmic questions remain open for our variants of
pop  moreover  we have focused on pairwise comparisons-
based refinements of pop but one could think about other
types of refinements  to further understand how selection and
allocation can be combined  an extensive study deserves to be
initiated on the dynamics associated with r-ef swaps and ff
moves  concerning optimality  one could also consider mini-
mizing the rank of the least happy agent and examine it under
the lens of r-ef  intuitively  r-ef seems to be very sensitive
to strategic manipulation  this point deserves to be formally
investigated  finally  the extension to more than one project
per agent or more than one agent per project is natural 
acknowledgements
this work has been partially supported by the cnrs  via the
project ins2i - 2021 - desire 
proceedings of the thirtieth    ijcai-21 
43
 references
 abdulkadiroˇglu and s¨onmez  1998  atila
abdulkadiroˇglu
and tayfun s¨onmez  random serial dictatorship and the
core from random endowments in house allocation prob-
lems  econometrica  66 3  689–701  1998 
 abraham et al   2004  david
j 
abraham 
katar ına
cechl arov a  david f  manlove  and kurt mehlhorn 
pareto optimality in house allocation problems 
in
proceedings of the 15th international symposium on
algorithms and computation  isaac-04   pages 3–15 
2004 
 abraham et al   2007  david j  abraham  robert w  irving 
telikepalli kavitha  and kurt mehlhorn  popular match-
ings 
siam journal on computing  37 4  1030–1045 
2007 
 barber a et al   2004  salvador barber a  walter bossert  and
prasanta k  pattanaik  ranking sets of objects  in hand-
book of utility theory  pages 893–977  springer  2004 
 benabbou et al   2018  nawal
benabbou 
mithun
chakraborty 
xuan-vinh ho 
jakub sliwinski 
and
yair zick 
diversity constraints in public housing
allocation  in proceedings of the 17th international con-
ference on autonomous agents and multiagent systems
 aamas-18   pages 973–981  2018 
 beynier et al   2019  aur elie beynier  yann chevaleyre 
laurent gourv es  ararat harutyunyan  julien lesca  nico-
las maudet  and ana¨elle wilczynski  local envy-freeness
in house allocation problems 
autonomous agents and
multi-agent systems  33 5  591–627  2019 
 bouveret and lang  2008  sylvain bouveret and j erˆome
lang  efficiency and envy-freeness in fair division of in-
divisible goods  logical representation and complexity 
journal of artificial intelligence research  32 525–564 
2008 
 bouveret et al   2016  sylvain bouveret  yann chevaleyre 
and nicolas maudet  fair allocation of indivisible goods 
in handbook of computational social choice  pages 284–
310  cambridge university press  2016 
 brams  1990  steven j  brams  constrained approval vot-
ing  a voting system to elect a governing board  inter-
faces  20 5  67–80  1990 
 bredereck et al   2018  robert
bredereck 
piotr
fal-
iszewski  ayumi igarashi  martin lackner  and piotr
skowron 
multiwinner elections with diversity con-
straints  in proceedings of the 32nd aaai conference on
artificial intelligence  aaai-18   pages 933–940  2018 
 cechl arov a and fleiner  2017  katar ına
cechl arov a
and
tam as fleiner 
pareto optimal matchings with lower
quotas  mathematical social sciences  88 3–10  2017 
 conitzer  2009  vincent conitzer 
eliciting single-peaked
preferences using comparison queries  journal of artificial
intelligence research  35 161–191  2009 
 cseh  2017   agnes cseh  popular matchings  in trends in
computational social choice  pages 105–122  ai access 
2017 
 elkind et al   2017  edith elkind  piotr faliszewski  piotr
skowron  and arkadii slinko  properties of multiwinner
voting rules  social choice and welfare  48 3  599–632 
2017 
 faliszewski et al   2017  piotr faliszewski  piotr skowron 
arkadii slinko  and nimrod talmon 
multiwinner vot-
ing  a new challenge for social choice theory  in trends
in computational social choice  pages 27–47  ai access 
2017 
 foley  1967  duncan k  foley  resource allocation and the
public sector  yale economic essays  7 1  45–98  1967 
 gan et al   2019  jiarui gan 
warut suksompong 
and
alexandros a  voudouris  envy-freeness in house allo-
cation problems  mathematical social sciences  101 104–
106  2019 
 harless  2018  patrick harless  immediate acceptance and
weak priorities  an adaptation that preserves efficiency
and respects rank  working paper  2018 
 hylland and zeckhauser  1979  aanund
hylland
and
richard zeckhauser 
the efficient allocation of indi-
viduals to positions 
journal of political economy 
87 2  293–314  1979 
 irving et al   2006  robert w  irving  telikepalli kavitha 
kurt mehlhorn  dimitrios michail  and katarzyna e 
paluch  rank-maximal matchings  acm transactions on
algorithms  talg   2 4  602–610  2006 
 irving  2003  robert w  irving  greedy matchings  techni-
cal report tr-2003-136  university of glasgow  2003 
 kojima and ¨unver  2014  fuhito
kojima
and
m
utku
¨unver  the  boston  school-choice mechanism  an ax-
iomatic approach 
economic theory  55 3  515–544 
2014 
 mcdermid and irving  2011  eric
mcdermid
and
robert w  irving 
popular matchings 
structure and
algorithms 
journal of combinatorial optimization 
22 3  339–358  2011 
 ramezanian and feizi  2020  rasoul
ramezanian
and
mehdi feizi  stepwise ordinal efficiency for the random
assignment problem  journal of mathematical economics 
2020 
 roth  1985  alvin e  roth  the college admissions prob-
lem is not equivalent to the marriage problem  journal of
economic theory  36 2  277–288  1985 
 shams et al   2020  parham shams  aur elie beynier  syl-
vain bouveret  and nicolas maudet  fair in the eyes of
others  in proceedings of the 24th european conference
on artificial intelligence  ecai-20   pages 203–210  2020 
 shapley and scarf  1974  lloyd shapley and herbert scarf 
on cores and indivisibility  journal of mathematical eco-
nomics  1 1  23–37  1974 
 varian  1974  hal r  varian  equity  envy  and efficiency 
journal of economic theory  9 1  63–91  1974 
 walsh  2015  toby walsh  generating single peaked votes 
arxiv preprint arxiv 1503 02766  2015 
proceedings of the thirtieth    ijcai-21 
44
 "
